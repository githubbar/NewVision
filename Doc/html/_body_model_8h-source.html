<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>New Vision: F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/BodyModel.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/BodyModel.h</h1><a href="_body_model_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#if !defined( BODYMODEL_H )</span>
<a name="l00002"></a><a class="code" href="_body_model_8h.html#5a5df069447dc3cb8f1636d1b5f4a893">00002</a> <span class="preprocessor"></span><span class="preprocessor">#define BODYMODEL_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#pragma once</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#include &lt;afx.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "cv.h"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="_model_8h.html">Model.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "<a class="code" href="_smart_ptr_array_8h.html">SmartPtrArray.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="_l_a_b_histogram2_d_8h.html">LABHistogram2D.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="_globals_8h.html">Globals.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="_body_8h.html">Body.h</a>"</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">class </span><a class="code" href="class_body_path.html">BodyPath</a>;
<a name="l00015"></a>00015 <span class="keyword">class </span><a class="code" href="class_swarm_activity_model.html">SwarmActivityModel</a>;
<a name="l00016"></a>00016 <span class="keyword">class </span><a class="code" href="class_object3_d.html">Object3D</a>;
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33">00018</a> <span class="keyword">enum</span> <a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33">Z_MODE</a> {<a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33a67ccf1c3a08f63c8f09c17b2b1795a9">BODIES_ONLY</a>=0, <a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b3394a38a66d363575a5e199ad5b312751f">OBSTACLES_ONLY</a>=1, <a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33952cbe05cb7cd58d013504ff4c78006b">BODIES_MINUS_OBSTACLES</a>=2, <a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33b1d5eac4b1dca480c8056eaea7663b7a">ALL</a>=3};
<a name="l00019"></a><a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c72">00019</a> <span class="keyword">enum</span> <a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c72">F_MODE</a> {<a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c7295fe306ece9aa6f6d585c137d257d5ff">F_BODIES_ONLY</a>=0, <a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c723095c6fa66ce7d68d7362bce9a34be11">F_OBSTACLES_ONLY</a>=1, <a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c72ea977ef42deb0eae234da8f8e4294bf2">F_ALL</a>=3};
<a name="l00020"></a><a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da61746">00020</a> <span class="keyword">enum</span> <a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da61746">MUTATION</a> {<a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da61746485551336ce681a6b0276c72ed551ff9">M_DIFFUSE</a>=1, <a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da61746bab1d9d2c1a77a18fc6ae9032fd18057">M_MOVE</a>=2, <a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da6174681f24c8006fdabf9415d8cdfd7d6382e">M_EXCHANGE</a>=3, <a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da617466585b74ed62814f2a7f5819fa840cf38">M_DELETE</a>=4, <a class="code" href="_body_model_8h.html#697a4c7cf0c66a754b5b56271da61746b015ea35463f41c032259cf8b3b0c941">M_NEW</a>=5};
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="class_body_map.html">00022</a> <span class="keyword">class </span><a class="code" href="class_body_map.html">BodyMap</a> : <span class="keyword">public</span> CMap&lt;int, int, Body*, Body* &gt; {
<a name="l00023"></a>00023 <span class="keyword">public</span>: 
<a name="l00024"></a><a class="code" href="class_body_map.html#1130e8abbfcb9535d1c6770a8a3921e5">00024</a>         <a class="code" href="class_body_map.html#1130e8abbfcb9535d1c6770a8a3921e5">BodyMap</a>( ) {
<a name="l00025"></a>00025         }
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="class_body_map.html#5af8f718b43885d375fe57651f95478c">00027</a>         <a class="code" href="class_body_map.html#1130e8abbfcb9535d1c6770a8a3921e5">BodyMap</a>( <span class="keyword">const</span> <a class="code" href="class_body_map.html">BodyMap</a> &amp;that ) {
<a name="l00028"></a>00028                 POSITION pos = that.GetStartPosition();
<a name="l00029"></a>00029                 <span class="keywordflow">while</span> (pos) {
<a name="l00030"></a>00030                         <span class="keywordtype">int</span> i; <a class="code" href="class_body.html">Body</a> *b;
<a name="l00031"></a>00031                         that.GetNextAssoc(pos, i, b);
<a name="l00032"></a>00032                         this-&gt;<a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(i, <span class="keyword">new</span> <a class="code" href="class_body.html">Body</a>(*b));
<a name="l00033"></a>00033                 }
<a name="l00034"></a>00034         }
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="class_body_map.html#bc9a60803c6a519f20726e852192fd47">00036</a>         <a class="code" href="class_body_map.html">BodyMap</a>&amp; <a class="code" href="class_body_map.html#bc9a60803c6a519f20726e852192fd47">operator=</a>( <span class="keyword">const</span> <a class="code" href="class_body_map.html">BodyMap</a> &amp;that )  { 
<a name="l00037"></a>00037                 <a class="code" href="class_body_map.html#569432be624023562a6d52797505617c">RemoveAll</a>();
<a name="l00038"></a>00038                 POSITION pos = that.GetStartPosition();
<a name="l00039"></a>00039                 <span class="keywordflow">while</span> (pos) {
<a name="l00040"></a>00040                         <span class="keywordtype">int</span> i; <a class="code" href="class_body.html">Body</a> *b;
<a name="l00041"></a>00041                         that.GetNextAssoc(pos, i, b);
<a name="l00042"></a>00042                         this-&gt;<a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(i, <span class="keyword">new</span> <a class="code" href="class_body.html">Body</a>(*b));
<a name="l00043"></a>00043                 }
<a name="l00044"></a>00044                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00045"></a>00045         }
<a name="l00046"></a>00046         
<a name="l00047"></a><a class="code" href="class_body_map.html#996c5f5a46d2c362b83b3d96fc7bcf83">00047</a>         <a class="code" href="class_body.html">Body</a>* <a class="code" href="class_body_map.html#996c5f5a46d2c362b83b3d96fc7bcf83">GetRandomValue</a>() {
<a name="l00048"></a>00048                 <span class="keywordtype">int</span> i_random = cvRandInt(&amp;<a class="code" href="_globals_8cpp.html#ff39e3308132c1b3c9548c6bbdf21b55">rnd_seed</a>) % GetCount(); 
<a name="l00049"></a>00049                 POSITION pos = GetStartPosition();
<a name="l00050"></a>00050                 <span class="keywordtype">int</span> i=0;
<a name="l00051"></a>00051                 <span class="keywordflow">while</span> (pos) {
<a name="l00052"></a>00052                         <span class="keywordtype">int</span> id; <a class="code" href="class_body.html">Body</a> *b;
<a name="l00053"></a>00053                         GetNextAssoc(pos, <span class="keywordtype">id</span>, b);
<a name="l00054"></a>00054                         <span class="keywordflow">if</span> (i == i_random)
<a name="l00055"></a>00055                                 <span class="keywordflow">return</span> b;
<a name="l00056"></a>00056                         i++;
<a name="l00057"></a>00057                 }
<a name="l00058"></a>00058                 <span class="keywordflow">return</span> NULL;
<a name="l00059"></a>00059         }
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="class_body_map.html#8c5c543da90f44b85c5cf17d3d820aa1">00061</a>         (<a class="code" href="class_body.html">Body</a>*)&amp; <span class="keyword">operator</span>[](<span class="keywordtype">int</span> key) {
<a name="l00062"></a>00062                 <a class="code" href="class_body.html">Body</a> *b;
<a name="l00063"></a>00063                 <span class="keywordflow">if</span> (Lookup(key, b))
<a name="l00064"></a>00064                         <span class="keyword">delete</span> b;
<a name="l00065"></a>00065                 <span class="keywordflow">return</span> CMap&lt;int, int, Body*, Body*&gt;::operator[](key);
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">00068</a>         <span class="keywordtype">void</span> <a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(<span class="keywordtype">int</span> key, <a class="code" href="class_body.html">Body</a>* value) {
<a name="l00069"></a>00069                 <a class="code" href="class_body.html">Body</a> *b;
<a name="l00070"></a>00070                 <span class="keywordflow">if</span> (Lookup(key, b))
<a name="l00071"></a>00071                         <span class="keyword">delete</span> b;
<a name="l00072"></a>00072                 CMap&lt;int, int, Body*, Body*&gt;::SetAt(key, value);
<a name="l00073"></a>00073         }
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">00075</a>         <span class="keywordtype">void</span> <a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">RemoveKey</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>) {
<a name="l00076"></a>00076                 <a class="code" href="class_body.html">Body</a> *b;
<a name="l00077"></a>00077                 <span class="keywordflow">if</span> (Lookup(<span class="keywordtype">id</span>, b)) {
<a name="l00078"></a>00078                         <span class="keyword">delete</span> b;
<a name="l00079"></a>00079                         CMap&lt;int, int, Body*, Body*&gt;::RemoveKey(<span class="keywordtype">id</span>);
<a name="l00080"></a>00080                 }
<a name="l00081"></a>00081         }
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="class_body_map.html#569432be624023562a6d52797505617c">00083</a>         <span class="keywordtype">void</span> <a class="code" href="class_body_map.html#569432be624023562a6d52797505617c">RemoveAll</a>() {
<a name="l00084"></a>00084                 POSITION pos = GetStartPosition();
<a name="l00085"></a>00085                 <span class="keywordflow">while</span> (pos) {
<a name="l00086"></a>00086                         <span class="keywordtype">int</span> id; <a class="code" href="class_body.html">Body</a> *b;
<a name="l00087"></a>00087                         GetNextAssoc(pos, <span class="keywordtype">id</span>, b);
<a name="l00088"></a>00088                         <span class="keyword">delete</span> b;
<a name="l00089"></a>00089                 }
<a name="l00090"></a>00090                 CMap&lt;int, int, Body*, Body*&gt;::RemoveAll();
<a name="l00091"></a>00091         }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="class_body_map.html#92952bba376e196862b0fd0f42845f97">00093</a>         <span class="keywordtype">void</span> <a class="code" href="class_body_map.html#92952bba376e196862b0fd0f42845f97">ChangeID</a>(<span class="keywordtype">int</span> id_old, <span class="keywordtype">int</span> id_new) {
<a name="l00094"></a>00094                 <span class="keywordflow">if</span> (id_old == id_new)
<a name="l00095"></a>00095                         <span class="keywordflow">return</span>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097                 <a class="code" href="class_body.html">Body</a> *b_old, *b_new;
<a name="l00098"></a>00098                 <span class="keywordflow">if</span> (Lookup(id_old, b_old)) {
<a name="l00099"></a>00099                         <span class="keywordflow">if</span> (Lookup(id_new, b_new))
<a name="l00100"></a>00100                                 <a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">RemoveKey</a>(id_new);
<a name="l00101"></a>00101                         b_new = <span class="keyword">new</span> <a class="code" href="class_body.html">Body</a>(*b_old);
<a name="l00102"></a>00102                         b_new-&gt;<a class="code" href="class_object3_d.html#0cfc2671e2a01bb06144e3fa88a01b0e">id</a> = id_new;
<a name="l00103"></a>00103                         <a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(id_new, b_new);
<a name="l00104"></a>00104                         <a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">RemoveKey</a>(id_old);
<a name="l00105"></a>00105                 }
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107 
<a name="l00108"></a><a class="code" href="class_body_map.html#330bda520c9ba82f19e2c43595d3c945">00108</a>         <span class="keywordtype">bool</span> <a class="code" href="class_body_map.html#330bda520c9ba82f19e2c43595d3c945">SwapID</a>(<span class="keywordtype">int</span> id1, <span class="keywordtype">int</span> id2) {
<a name="l00109"></a>00109                 <span class="keywordflow">if</span> (id1 == id2)
<a name="l00110"></a>00110                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112                 <a class="code" href="class_body.html">Body</a> *b1, *b2;
<a name="l00113"></a>00113                 <span class="keywordflow">if</span> (!Lookup(id1, b1) || !Lookup(id2, b2))
<a name="l00114"></a>00114                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00115"></a>00115                 <a class="code" href="class_body.html">Body</a> *b1copy = <span class="keyword">new</span> <a class="code" href="class_body.html">Body</a>(*b1);
<a name="l00116"></a>00116                 <a class="code" href="class_body.html">Body</a> *b2copy = <span class="keyword">new</span> <a class="code" href="class_body.html">Body</a>(*b2);
<a name="l00117"></a>00117                 <a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">RemoveKey</a>(id1);
<a name="l00118"></a>00118                 <a class="code" href="class_body_map.html#3a06106c08f18a16c32114aa5319c360">RemoveKey</a>(id2);
<a name="l00119"></a>00119                 b1copy-&gt;<a class="code" href="class_object3_d.html#0cfc2671e2a01bb06144e3fa88a01b0e">id</a> = id2;
<a name="l00120"></a>00120                 b2copy-&gt;<a class="code" href="class_object3_d.html#0cfc2671e2a01bb06144e3fa88a01b0e">id</a> = id1;
<a name="l00121"></a>00121                 <a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(id1, b2copy);
<a name="l00122"></a>00122                 <a class="code" href="class_body_map.html#d86c89491dc201843090849d926a994e">SetAt</a>(id2, b1copy);
<a name="l00123"></a>00123                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125 };
<a name="l00126"></a>00126 <span class="comment">// ================================================================================================</span>
<a name="l00127"></a><a class="code" href="class_body_model.html">00127</a> <span class="keyword">class </span><a class="code" href="class_body_model.html">BodyModel</a> : <span class="keyword">public</span> <a class="code" href="class_model.html">Model</a>
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129         DECLARE_SERIAL(<a class="code" href="class_body_model.html">BodyModel</a>)
<a name="l00130"></a>00130 <span class="keyword">public</span>:
<a name="l00131"></a>00131         <span class="comment">// --------------- Persistant variables -----------------------</span>
<a name="l00132"></a><a class="code" href="class_body_model.html#ecc126949cfb7fa08024f2460e4f230a">00132</a>         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#ecc126949cfb7fa08024f2460e4f230a">m_initialized</a>;
<a name="l00133"></a><a class="code" href="class_body_model.html#708f4dfdbd4a4312c25ba50139e14519">00133</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#708f4dfdbd4a4312c25ba50139e14519">m_heightM</a>;
<a name="l00134"></a><a class="code" href="class_body_model.html#182bda8077930a11522a789c888831a6">00134</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#182bda8077930a11522a789c888831a6">m_heightS</a>;
<a name="l00135"></a><a class="code" href="class_body_model.html#0b769b31129cc1ba2913e7d98311b95b">00135</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#0b769b31129cc1ba2913e7d98311b95b">m_minHeight</a>;
<a name="l00136"></a><a class="code" href="class_body_model.html#bdc933dad73a4199283bea837b8c7199">00136</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#bdc933dad73a4199283bea837b8c7199">m_maxHeight</a>;
<a name="l00137"></a><a class="code" href="class_body_model.html#7bfd76f4f62d4fe17f22a47bbce1398b">00137</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#7bfd76f4f62d4fe17f22a47bbce1398b">m_widthM</a>;
<a name="l00138"></a><a class="code" href="class_body_model.html#3758bc4a76c8468147a59d34411149c5">00138</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#3758bc4a76c8468147a59d34411149c5">m_widthS</a>;
<a name="l00139"></a><a class="code" href="class_body_model.html#8e3fb02f98e78c27d32f0d2026c17b8d">00139</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#8e3fb02f98e78c27d32f0d2026c17b8d">m_minWidth</a>;
<a name="l00140"></a><a class="code" href="class_body_model.html#d5314dca93703c391e7f7a7f2ea30b2d">00140</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#d5314dca93703c391e7f7a7f2ea30b2d">m_maxWidth</a>;
<a name="l00141"></a><a class="code" href="class_body_model.html#b52c5ab7fb67602d4247c2baa68881e6">00141</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#b52c5ab7fb67602d4247c2baa68881e6">m_iterations</a>;
<a name="l00142"></a><a class="code" href="class_body_model.html#4b938f69d90a8b3f1feb4312d9a1f846">00142</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#4b938f69d90a8b3f1feb4312d9a1f846">m_iterationsPerBody</a>;
<a name="l00143"></a><a class="code" href="class_body_model.html#793d57f668169a7179d47670d41408ee">00143</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#793d57f668169a7179d47670d41408ee">m_invisibleFor</a>;<span class="comment">// number of frames not to have any underlying blobs to be considered for deletion</span>
<a name="l00144"></a><a class="code" href="class_body_model.html#c14df34175b3627c5784d6b7fe7013d2">00144</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#c14df34175b3627c5784d6b7fe7013d2">m_dormantFor</a>;  <span class="comment">// number of frames not to have any motion or color change to be considered for deletion</span>
<a name="l00145"></a><a class="code" href="class_body_model.html#3c77e25cac1952a52c4963d627ae4db2">00145</a>         <span class="keywordtype">int</span>     <a class="code" href="class_body_model.html#3c77e25cac1952a52c4963d627ae4db2">m_outsiderFor</a>; <span class="comment">// number of frames not to have any underlying blobs to be considered for deletion</span>
<a name="l00146"></a><a class="code" href="class_body_model.html#beeac7ca766acdb9d9f6e31d4abe0449">00146</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#beeac7ca766acdb9d9f6e31d4abe0449">m_distanceConfidence</a>;   <span class="comment">// accuracy (cm) while performing distance related operations</span>
<a name="l00147"></a><a class="code" href="class_body_model.html#1b57754bd0e3fc580c20f22b1c3ad4df">00147</a>         <span class="keywordtype">int</span>             <a class="code" href="class_body_model.html#1b57754bd0e3fc580c20f22b1c3ad4df">m_saturationTime</a>;               <span class="comment">// time (in frames) to start trusting sizes and locations</span>
<a name="l00148"></a><a class="code" href="class_body_model.html#602efae18e0badd19ee360826443c03f">00148</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#602efae18e0badd19ee360826443c03f">m_maxHistChange</a>;                <span class="comment">// maximum percetage change in color histogram to be deemed as dormant</span>
<a name="l00149"></a><a class="code" href="class_body_model.html#7b81da0f14e342b8ca75bf665d6859a7">00149</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#7b81da0f14e342b8ca75bf665d6859a7">m_maxPosChange</a>;                 <span class="comment">// maximum change in position (cm) to be deemed as dormant</span>
<a name="l00150"></a><a class="code" href="class_body_model.html#c3049adcfd98c1dba3cb71043ddc9374">00150</a>         <span class="keywordtype">int</span>             <a class="code" href="class_body_model.html#c3049adcfd98c1dba3cb71043ddc9374">m_maxDeletedAge</a>;                <span class="comment">// maximum age of deleted bodies to recover (also the time to keep in body_deleted array)</span>
<a name="l00151"></a><a class="code" href="class_body_model.html#4adb12a8687e0913fa2fde8821abe475">00151</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#4adb12a8687e0913fa2fde8821abe475">m_maxDeletedDist</a>;               <span class="comment">// maximum distance of deleted bodies from new candidates to recover</span>
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         <span class="comment">// tracking parameters</span>
<a name="l00154"></a><a class="code" href="class_body_model.html#5b6d92dd0ca75c739b9aef9b1f37d3fd">00154</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#5b6d92dd0ca75c739b9aef9b1f37d3fd">m_randomness</a>;
<a name="l00155"></a><a class="code" href="class_body_model.html#e21563e6c78d686f72ad50d47ecac2f4">00155</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#e21563e6c78d686f72ad50d47ecac2f4">m_maxDoorDistance</a>; <span class="comment">// maximum distance from the door to perform add/delete mutations</span>
<a name="l00156"></a><a class="code" href="class_body_model.html#4579ffa38bb9d8b281e1ec6498b73d98">00156</a>         <span class="keywordtype">int</span>             <a class="code" href="class_body_model.html#4579ffa38bb9d8b281e1ec6498b73d98">last_id</a>;
<a name="l00157"></a><a class="code" href="class_body_model.html#5086df6869818edce369d35bd9dae49d">00157</a>         <span class="keywordtype">int</span>             <a class="code" href="class_body_model.html#5086df6869818edce369d35bd9dae49d">last_group_id</a>;
<a name="l00158"></a>00158         
<a name="l00159"></a><a class="code" href="class_body_model.html#0e5edd4f262774e6b0885f5dd2534099">00159</a>         <a class="code" href="class_body_map.html">BodyMap</a> <a class="code" href="class_body_model.html#0e5edd4f262774e6b0885f5dd2534099">body</a>;
<a name="l00160"></a><a class="code" href="class_body_model.html#e447fae9bacc236ad12a76435218136b">00160</a>         <a class="code" href="class_body_map.html">BodyMap</a> <a class="code" href="class_body_model.html#e447fae9bacc236ad12a76435218136b">body_deleted</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         <span class="comment">// prior probability penalties</span>
<a name="l00163"></a><a class="code" href="class_body_model.html#3d66c30734e4c6e7b6656d3635fad52a">00163</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#3d66c30734e4c6e7b6656d3635fad52a">p_BodyOverlap</a>; <span class="comment">// penalty for overlapping with other bodies</span>
<a name="l00164"></a><a class="code" href="class_body_model.html#b7d139a1e0f2c67bf38501fe4bf53171">00164</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#b7d139a1e0f2c67bf38501fe4bf53171">m_BodyMinDist</a>; <span class="comment">// minimal distance to other body to consider an overlap</span>
<a name="l00165"></a><a class="code" href="class_body_model.html#dffcb98b1ff90d1d5e609b63fafe046c">00165</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#dffcb98b1ff90d1d5e609b63fafe046c">p_ObstacleOverlap</a>; <span class="comment">// penalty for overlapping with obstacles </span>
<a name="l00166"></a><a class="code" href="class_body_model.html#5928246a8cde6dd1fddbe6c35c8b24af">00166</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#5928246a8cde6dd1fddbe6c35c8b24af">p_number</a>; <span class="comment">// probability of no objects present in the scene</span>
<a name="l00167"></a><a class="code" href="class_body_model.html#560094b71705de275f0803e1f8b71a50">00167</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#560094b71705de275f0803e1f8b71a50">p_distance</a>; <span class="comment">// penalty for the distance from the Kalman predicted position </span>
<a name="l00168"></a><a class="code" href="class_body_model.html#c4546ff51030a9f5b040a0d08d2fe357">00168</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#c4546ff51030a9f5b040a0d08d2fe357">p_height</a>;
<a name="l00169"></a><a class="code" href="class_body_model.html#81d23d3d55b71509caf62d94f8539ce9">00169</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#81d23d3d55b71509caf62d94f8539ce9">p_width</a>;
<a name="l00170"></a><a class="code" href="class_body_model.html#50dfb7a6e295ecf74bec3d88ba4b8a7a">00170</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#50dfb7a6e295ecf74bec3d88ba4b8a7a">p_new</a>; <span class="comment">// probability of creating a new body (should descrese further from doors)</span>
<a name="l00171"></a><a class="code" href="class_body_model.html#8198d62a96e248fa01abec0e47cd0545">00171</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#8198d62a96e248fa01abec0e47cd0545">p_delete</a>; <span class="comment">// probability of deleting an old body (should descrese further from doors)</span>
<a name="l00172"></a><a class="code" href="class_body_model.html#75e445381562ce45be78473dfdf3ce8d">00172</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#d7286e3a801b18b98a5ff12a5d3e5e5e">p_color</a>, <a class="code" href="class_body_model.html#1adbe03611490c33bc1083ccbe4709c4">p_background</a>, <a class="code" href="class_body_model.html#75e445381562ce45be78473dfdf3ce8d">p_foreground</a>; <span class="comment">// color consistency, object attraction and BG exclustion relative weights</span>
<a name="l00173"></a><a class="code" href="class_body_model.html#26dafd4994f4fc5a008cb6c16a385732">00173</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#26dafd4994f4fc5a008cb6c16a385732">p_abnormalW</a>; <span class="comment">// penalty for deviation from the mean width</span>
<a name="l00174"></a><a class="code" href="class_body_model.html#51a970d5308b5e546e81b725439122ca">00174</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#51a970d5308b5e546e81b725439122ca">p_abnormalH</a>; <span class="comment">// penalty for deviation from the mean height</span>
<a name="l00175"></a>00175 
<a name="l00176"></a>00176         <span class="comment">// jump-diffusion probabilities</span>
<a name="l00177"></a><a class="code" href="class_body_model.html#fac301d307240bcbf92c8653bad59109">00177</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#fac301d307240bcbf92c8653bad59109">p_add</a>;
<a name="l00178"></a><a class="code" href="class_body_model.html#63666a42daea962c0f772bf7933c3f49">00178</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#63666a42daea962c0f772bf7933c3f49">p_remove</a>;
<a name="l00179"></a><a class="code" href="class_body_model.html#35ea736a497b58aa5a8b0a1cb4f8adef">00179</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#35ea736a497b58aa5a8b0a1cb4f8adef">p_exchange</a>;
<a name="l00180"></a><a class="code" href="class_body_model.html#1f7f8f972815db896f5be322d44671b8">00180</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#1f7f8f972815db896f5be322d44671b8">p_update</a>;
<a name="l00181"></a><a class="code" href="class_body_model.html#e362ff5848585ad2982d48f276edda5c">00181</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#e362ff5848585ad2982d48f276edda5c">p_diffuse</a>;
<a name="l00182"></a>00182         
<a name="l00183"></a>00183         <span class="comment">// Kalman parameters</span>
<a name="l00184"></a><a class="code" href="class_body_model.html#6f1a1489933f5f83a3768471d8b29296">00184</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#6f1a1489933f5f83a3768471d8b29296">m_posModelNoise</a>;
<a name="l00185"></a><a class="code" href="class_body_model.html#9812846ef293f2f599d5da0c7a6cbb18">00185</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#9812846ef293f2f599d5da0c7a6cbb18">m_posMeasurementNoise</a>;
<a name="l00186"></a><a class="code" href="class_body_model.html#ec592b958f56479ca1440da6a1834b70">00186</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#ec592b958f56479ca1440da6a1834b70">m_orientModelNoise</a>;
<a name="l00187"></a><a class="code" href="class_body_model.html#a9827196d9ae5ad12c9bdfb86dcfb1a9">00187</a>         <span class="keywordtype">double</span>  <a class="code" href="class_body_model.html#a9827196d9ae5ad12c9bdfb86dcfb1a9">m_orientMeasurementNoise</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         <a class="code" href="class_body_model.html#365e2b61d38a3400c5451d56f46e295d">BodyModel</a>(<span class="keywordtype">void</span>);
<a name="l00190"></a>00190         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#e453fb41d283a42b3ac80853faaad7bd">Initialize</a>();
<a name="l00191"></a>00191         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#9bbe1fd6fa5e112ff8d67d78e3d93cb7">DeInitialize</a>();
<a name="l00192"></a><a class="code" href="class_body_model.html#112aab046eb231e522d4059c4e136090">00192</a>         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#112aab046eb231e522d4059c4e136090">IsInitialized</a>() { <span class="keywordflow">return</span> <a class="code" href="class_body_model.html#ecc126949cfb7fa08024f2460e4f230a">m_initialized</a>; };
<a name="l00193"></a>00193         <span class="keyword">virtual</span> <a class="code" href="class_body_model.html#484dc1d61230cfbdca6221e3c43e74dd">~BodyModel</a>(<span class="keywordtype">void</span>);
<a name="l00194"></a>00194         
<a name="l00195"></a>00195         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#9eb9ed9a8b31e95a64f0d904bf8e5148">UpdateHistograms</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; <a class="code" href="class_body_model.html#0e5edd4f262774e6b0885f5dd2534099">body</a>);
<a name="l00196"></a>00196 
<a name="l00205"></a>00205         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#13b8a742cc6cf2a967c3114df879200a">UpdateZBuffer</a>(IplImage* z, <a class="code" href="class_body_map.html">BodyMap</a>&amp; <a class="code" href="class_body_model.html#0e5edd4f262774e6b0885f5dd2534099">body</a>, <a class="code" href="class_smart_ptr_array.html">SmartPtrArray&lt;Object3D&gt;</a>&amp; obstacle, <a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33">Z_MODE</a> mode=<a class="code" href="_body_model_8h.html#c60adcb1b450332fc494693b0cd63b33b1d5eac4b1dca480c8056eaea7663b7a">ALL</a>);
<a name="l00206"></a>00206         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#c0afae5e07645bfbb8d11d6418805f8f">UpdateFBuffer</a>(IplImage* f, <a class="code" href="class_body_map.html">BodyMap</a>* <a class="code" href="class_body_model.html#0e5edd4f262774e6b0885f5dd2534099">body</a>, <a class="code" href="class_smart_ptr_array.html">SmartPtrArray&lt;Object3D&gt;</a>&amp; obstacle, <a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c72">F_MODE</a> mode=<a class="code" href="_body_model_8h.html#4acfa4ed0e32f981e5415209be331c72ea977ef42deb0eae234da8f8e4294bf2">F_ALL</a>);
<a name="l00207"></a>00207         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#610077e7329d52e2f9797ef47420804f">Predict</a>();
<a name="l00208"></a>00208         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#1e03990d781d60c26f70c6c85859d342">Iterate</a>();
<a name="l00209"></a>00209         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#642cce8c22d19f02f400a2bdac787676">RasterizeFrame</a>(IplImage* frame, CvScalar color=cvScalar(1));
<a name="l00210"></a>00210         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#62daa0d539cf45d2e9bfa053d6cfa163">RasterizeFloor</a>(IplImage* frame, CvScalar color=cvScalar(1));
<a name="l00211"></a>00211         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#b3bdbe7106294cb6502e70ff8ef23ce1">RasterizeNonDormant</a>(IplImage* frame, CvScalar color=cvScalar(1));
<a name="l00212"></a>00212         
<a name="l00213"></a>00213         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#84287ac8bb40279ccdaef8473ce39588">DrawFrame</a>(IplImage* frame, CvScalar color);
<a name="l00214"></a>00214         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#84287ac8bb40279ccdaef8473ce39588">DrawFrame</a>(CDC* pDC , <span class="keywordtype">int</span> ox, <span class="keywordtype">int</span> oy, CPen* pen);
<a name="l00215"></a>00215         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#d3f889aad3c9794dda4cf6da994cee88">DrawColorizingConfidence</a>(IplImage* frame, CvScalar colorYes, CvScalar colorNo);
<a name="l00216"></a>00216         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#6ef509dcfac1dea8420b036441f5c9b8">DrawFloor</a>(IplImage* frame, CvScalar color);
<a name="l00217"></a>00217         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#3900b6656065c20f124d8f865a855d9d">DrawHeight</a>(IplImage* frame, CvScalar color);
<a name="l00218"></a>00218         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#fa2592853d05ca42bebaf3e65dd3baf0">DrawGroups</a>(IplImage* frame, CvScalar color);
<a name="l00219"></a>00219         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#55ce537a62f2abef0e9a824544ece6b0">DrawWeightMasks</a>(IplImage* frame);
<a name="l00220"></a>00220         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#d9214593f4a9a411d39b93f4044c5be2">DrawZBuffer</a>(IplImage* frame);
<a name="l00221"></a>00221         <span class="keywordtype">void</span>                    <a class="code" href="class_body_model.html#ed703f88106d83ad472b27e2bc7ae42f">DrawHistograms</a>(IplImage* frame);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="keywordtype">double</span>                  <a class="code" href="class_body_model.html#af292d8bcfb3edb1e05157350e0c1eef">Prior</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arrCurr, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arrPrev);
<a name="l00224"></a>00224         <span class="keywordtype">double</span>                  <a class="code" href="class_body_model.html#294b6f331d68d1fe2a447d532c25af74">Likelyhood</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="comment">// --------------------------------------------------------------------------</span>
<a name="l00227"></a>00227         <a class="code" href="class_body.html">Body</a>* <a class="code" href="class_body_model.html#cb36adf19afd9ec40789ad9b3d968e3b">FindBodyMatch</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, CvPoint3D32f bot, <span class="keywordtype">int</span> R=5);
<a name="l00228"></a>00228         <a class="code" href="class_body.html">Body</a>* <a class="code" href="class_body_model.html#cb36adf19afd9ec40789ad9b3d968e3b">FindBodyMatch</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, CvPoint2D32f bot, <span class="keywordtype">int</span> R=5);
<a name="l00229"></a>00229         <a class="code" href="class_body.html">Body</a>* <a class="code" href="class_body_model.html#b6826649ece8c24d551f358dd2287160">FindBodyMatchByAgeAndDistance</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, <a class="code" href="class_body.html">Body</a>* b, <span class="keywordtype">int</span> d_age=10, <span class="keywordtype">double</span> R=5);
<a name="l00230"></a>00230         <a class="code" href="class_body.html">Body</a>* <a class="code" href="class_body_model.html#515eae7cbaf6f67e80f60852f36f9c07">FindBodyMatchTop</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, CvPoint2D32f top, <span class="keywordtype">int</span> R=5);
<a name="l00231"></a>00231         <span class="keywordtype">int</span> <a class="code" href="class_body_model.html#6761321fa099655f41c97de9a47fe77c">FindBodyIDTop</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, CvPoint2D32f top, <span class="keywordtype">int</span> R=5);
<a name="l00232"></a>00232         <span class="keywordtype">int</span> <a class="code" href="class_body_model.html#a947b76d6015feaf7d38e855aac70e80">FindBodyIDTag</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr, CvPoint2D32f p);
<a name="l00233"></a>00233         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#a20ea9a9d9a24d4abacd274b62546dee">UpdateRecentlyDeleted</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_after, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_before, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_deleted, <span class="keywordtype">int</span> frame);
<a name="l00234"></a>00234         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#47cdf41878c9e27d30df051a57b6db2e">ReplaceNewWithRecentlyDeleted</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_after, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_before, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arr_deleted, <span class="keywordtype">int</span> delta_age, <span class="keywordtype">double</span> delta_distance);
<a name="l00235"></a>00235         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#f3f667f85641428749555986a9213ef4">ReorderIDs</a>(<span class="keywordtype">int</span> last_id_before, <a class="code" href="class_body_map.html">BodyMap</a>&amp; arr);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <span class="comment">// Body model mutations</span>
<a name="l00239"></a>00239         <span class="keywordtype">int</span> <a class="code" href="class_body_model.html#e4823328452c1b9683df20bb232ef465">GetRandomMutationNumber</a>();
<a name="l00240"></a>00240         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#f0a7ac0a93d2b4571ebadc6928f36981">MutateNew</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; proposed);
<a name="l00241"></a>00241         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#b4f7d8dc50331bd4fd652313ade39b40">MutateDiffuse</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; proposed);
<a name="l00242"></a>00242         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#d5be61ca71cecbadf6563c1399a8777b">MutateMove</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; proposed);
<a name="l00243"></a>00243         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#4f1849b164d2fc3a8b8517f7d7fd6ca4">MutateExchange</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; proposed);
<a name="l00244"></a>00244         <span class="keywordtype">bool</span> <a class="code" href="class_body_model.html#a4b3c17929794104c5056fa43de2e07e">MutateDelete</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; proposed);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#4f47d0935100df09ed66628b0c4e54d1">RemoveEmpty</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; accepted);
<a name="l00247"></a>00247         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#52be0310149d582144ace86ac35de3d3">RemoveOutsiders</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; accepted);
<a name="l00248"></a>00248         <span class="keywordtype">void</span> <a class="code" href="class_body_model.html#f83f42ac4d77c556c301eeddfd4a13a2">NewForEachBlob</a>(<a class="code" href="class_body_map.html">BodyMap</a>&amp; accepted);
<a name="l00249"></a>00249 };
<a name="l00250"></a>00250 <span class="preprocessor">#endif // !defined( BODYMODEL_H )</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Apr 24 22:32:50 2007 for New Vision by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
