<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NewVision: TreePropSheet::CTreePropSheet class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>TreePropSheet::CTreePropSheet Class Reference</h1>Inheritance diagram for TreePropSheet::CTreePropSheet:<p><center><img src="classTreePropSheet_1_1CTreePropSheet__inherit__graph.png" border="0" usemap="#TreePropSheet_1_1CTreePropSheet__inherit__map" alt="Inheritance graph"></center>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for TreePropSheet::CTreePropSheet:<p><center><img src="classTreePropSheet_1_1CTreePropSheet__coll__graph.png" border="0" usemap="#TreePropSheet_1_1CTreePropSheet__coll__map" alt="Collaboration graph"></center>
<map name="TreePropSheet_1_1CTreePropSheet__coll__map">
<area href="classTreePropSheet_1_1CPropPageFrame.html" shape="rect" coords="239,279,452,300" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classTreePropSheet_1_1CTreePropSheet-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
A property sheet, which can use a tree control instead of a tab control, to give the user access to the different pages.<p>
You can use it exactly the same way, as a CPropertySheet object. Simply create CPropertyPage objects and add them via AddPage() to the sheet. If you would like to use the tree view mode (default), you can specify the path of the pages in the tree, by their name: The names of the pages can contain double colons ("::"), which will specify the path of that page in the tree control. I.e. if you have three pages with the following names: 1. _T("Appearance::Toolbars") 2. _T("Appearance::Menus") 3. _T("Directories") the tree would look as follow: <div class="fragment"><pre>
Appearance
|
+-Toolbars
|
+-Menus

Directories
</pre></div>If you would like to use a double colon, which should not be interpreted as a path seperator, prefix it with a backslash ("\\::").<p>
To disable tree view mode and use the standard tabbed mode, call the <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a9">SetTreeViewMode()</a> method. This also allows you, to enable page captions and tree images for tree view mode. If you would like to have images in the tree, but not all of your pages specify images or there are tree view items, which are not attached to a page (only parent items for real page items), you have to set default images using the <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#z0_0">SetTreeDefaultImages()</a> method -- otherwise their may appear display errors.<p>
If the user selects a tree view item, which does not belong to a page, because it is just a parent item for real page items, no page will be displayed, instead a message will be displayed, that can be set via <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a11">SetEmptyPageText()</a>.<p>
<dl compact><dt><b>Author:</b></dt><dd>Sven Wiegand </dd></dl>

<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a9">SetTreeViewMode</a> (BOOL bTreeViewMode=TRUE, BOOL bPageCaption=FALSE, BOOL bTreeImages=FALSE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a10">SetTreeWidth</a> (int nWidth)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a11">SetEmptyPageText</a> (LPCTSTR lpszEmptyPageText)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>DWORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a12">SetEmptyPageTextFormat</a> (DWORD dwFormat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CTreeCtrl *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a13">GetPageTreeControl</a> ()</td></tr>

<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#z0_0">SetTreeDefaultImages</a> (CImageList *pImages)</td></tr>

<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#e0">DestroyPageIcon</a> (CPropertyPage *pPage)</td></tr>

<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#z1_0">SetPageIcon</a> (CPropertyPage *pPage, HICON hIcon)</td></tr>

<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>virtual CString&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b0">GenerateEmptyPageMessage</a> (LPCTSTR lpszEmptyPageMessage, LPCTSTR lpszCaption)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual CTreeCtrl *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b1">CreatePageTreeObject</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual <a class="el" href="classTreePropSheet_1_1CPropPageFrame.html">CPropPageFrame</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b2">CreatePageFrame</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b3">MoveChildWindows</a> (int nDx, int nDy)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b4">RefillPageTree</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HTREEITEM&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b5">CreatePageTreeItem</a> (LPCTSTR lpszPath, HTREEITEM hParent=TVI_ROOT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CString&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b6">SplitPageTreePath</a> (CString &amp;strRest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b7">KillActiveCurrentPage</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HTREEITEM&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b8">GetPageTreeItem</a> (int nPage, HTREEITEM hRoot=TVI_ROOT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b9">SelectPageTreeItem</a> (int nPage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b10">SelectCurrentPageTreeItem</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b11">UpdateCaption</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b12">ActivatePreviousPage</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#b13">ActivateNextPage</a> ()</td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a name="a9" doxytag="TreePropSheet::CTreePropSheet::SetTreeViewMode"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SetTreeViewMode </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bTreeViewMode</em> = TRUE, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bPageCaption</em> = FALSE, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bTreeImages</em> = FALSE</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Call this method, if you would like to use a tree control to browse the pages, instead of the tab control.<p>
This method needs to becalled, before DoModal() or Create(). If the window has already been created, the method will fail.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>bTreeViewMode</em>&nbsp;</td><td>Pass TRUE to provide a tree view control instead of a tab control to browse the pages, pass FALSE to use the normal tab control. </td></tr>
    <tr><td valign=top><em>bPageCaption</em>&nbsp;</td><td>TRUE if a caption should be displayed for each page. The caption contains the page title and an icon if specified with the page. Ignored if bTreeViewMode is FALSE. </td></tr>
    <tr><td valign=top><em>bTreeImages</em>&nbsp;</td><td>TRUE if the page icons should be displayed in the page tree, FALSE if there should be no icons in the page tree. Ignored if bTreeViewMode is FALSE. If not all of your pages are containing icons, or if there will be empty pages (parent nodes without a related page, you need to call <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#z0_0">SetTreeDefaultImages()</a> to avoid display errors.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success or FALSE, if the window has already been created.</dd></dl>
    </td>
  </tr>
</table>
<a name="a10" doxytag="TreePropSheet::CTreePropSheet::SetTreeWidth"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SetTreeWidth </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>nWidth</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Specifies the width of the tree control, when the sheet is in tree view mode. The default value (if this method is not called) is 150 pixels.<p>
This method needs to be called, before DoModeal() or Create(). Otherwise it will fail.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>nWidth</em>&nbsp;</td><td>The width in pixels for the page tree.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise (if the window has already been created).</dd></dl>
    </td>
  </tr>
</table>
<a name="a11" doxytag="TreePropSheet::CTreePropSheet::SetEmptyPageText"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::SetEmptyPageText </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpszEmptyPageText</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Specifies the text to be drawn on empty pages (pages for tree view items, that are not related to a page, because they are only parents for other items). This is only needed in tree view mode.<p>
The specified text can contains a single "%s" placeholder which will be replaced with the title of the empty page.    </td>
  </tr>
</table>
<a name="a12" doxytag="TreePropSheet::CTreePropSheet::SetEmptyPageTextFormat"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> DWORD TreePropSheet::CTreePropSheet::SetEmptyPageTextFormat </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">DWORD&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwFormat</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allows you to specify, how the empty page message (see <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#a11">SetEmptyPageText()</a>) should be drawn.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dwFormat</em>&nbsp;</td><td>A combination of the DT_* flags available for the Win32-API function DrawText(), that should be used to draw the text. The default value is: <div class="fragment"><pre>        DT_CENTER|DT_VCENTER|DT_NOPREFIX|DT_SINGLELINE
</pre></div></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The previous format.</dd></dl>
    </td>
  </tr>
</table>
<a name="z0_0" doxytag="TreePropSheet::CTreePropSheet::SetTreeDefaultImages"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SetTreeDefaultImages </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CImageList *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pImages</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines the images, that should be used for pages without icons and for empty parent nodes. The list contains exactly to images: 1. An image that should be used for parent tree nodes, without a page asignd. 2. An image that should be used for pages, which are not specifying any icons. Standard image size is 16x16 Pixels, but if you call this method before creating the sheet, the size of image 0 in this list will be assumed as your preferred image size and all other icons must have the same size.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>pImages</em>&nbsp;</td><td>Pointer to an image list with exactly to images, that should be used as default images. The images are copied to an internal list, so that the given list can be deleted after this call. </td></tr>
    <tr><td valign=top><em>unBitmapID</em>&nbsp;</td><td>Resource identifier for the bitmap, that contains the default images. The resource should contain exactly to images. </td></tr>
    <tr><td valign=top><em>cx</em>&nbsp;</td><td>Width of a singe image in pixels. </td></tr>
    <tr><td valign=top><em>crMask</em>&nbsp;</td><td>Color that should be interpreted as transparent.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise.</dd></dl>
    </td>
  </tr>
</table>
<a name="a13" doxytag="TreePropSheet::CTreePropSheet::GetPageTreeControl"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CTreeCtrl * TreePropSheet::CTreePropSheet::GetPageTreeControl </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns a pointer to the tree control, when the sheet is in tree view mode, NULL otherwise.    </td>
  </tr>
</table>
<a name="z1_0" doxytag="TreePropSheet::CTreePropSheet::SetPageIcon"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SetPageIcon </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CPropertyPage *&nbsp;</td>
          <td class="mdname" nowrap> <em>pPage</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>HICON&nbsp;</td>
          <td class="mdname" nowrap> <em>hIcon</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This helper allows you to easily set the icon of a property page.<p>
This static method does nothing more, than extracting the specified image as an icon from the given image list and assign the icon-handle to the hIcon property of the pages PROPSHEETPAGE structure (m_psp) and modify the structures flags, so that the image will be recognized.<p>
You need to call this method for a page, before adding the page to a property sheet.<p>
If you are using the CImageList-version, you are responsible for destroying the extracted icon with DestroyIcon() or the static <a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#e0">DestroyPageIcon()</a> method.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classTreePropSheet_1_1CTreePropSheet.html#e0">DestroyPageIcon()</a></dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>pPage</em>&nbsp;</td><td>Property page to set the image for. </td></tr>
    <tr><td valign=top><em>hIcon</em>&nbsp;</td><td>Handle to icon that should be set for the page. </td></tr>
    <tr><td valign=top><em>unIconId</em>&nbsp;</td><td>Ressource identifier for the icon to set. </td></tr>
    <tr><td valign=top><em>Images</em>&nbsp;</td><td>Reference of the image list to extract the icon from. </td></tr>
    <tr><td valign=top><em>nImage</em>&nbsp;</td><td>Zero based index of the image in pImages, that should be used as an icon.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE if an error occured.</dd></dl>
    </td>
  </tr>
</table>
<a name="e0" doxytag="TreePropSheet::CTreePropSheet::DestroyPageIcon"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::DestroyPageIcon </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CPropertyPage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pPage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks, if the PSP_USEHICON flag is set in the PROPSHEETPAGE struct; If this is the case, the flag will be removed and the icon specified by the hIcon attribute of the PROPSHEETPAGE struct will be destroyed using DestroyIcon().<p>
<dl compact><dt><b>Note:</b></dt><dd>You only have to call DestroyIcon() for icons, that have been created using CreateIconIndirect() (i.e. used by CImageList::ExtractIcon()).</dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE if the PSP_USEHICON flag was not set or if the icon handle was NULL.</dd></dl>
    </td>
  </tr>
</table>
<a name="b0" doxytag="TreePropSheet::CTreePropSheet::GenerateEmptyPageMessage"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CString TreePropSheet::CTreePropSheet::GenerateEmptyPageMessage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszEmptyPageMessage</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszCaption</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Will be called to generate the message, that should be displayed on an empty page, when the sheet is in tree view mode<p>
This default implementation simply returns lpszEmptyPageMessage with the optional "%s" placeholder replaced by lpszCaption.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>lpszEmptyPageMessage</em>&nbsp;</td><td>The string, set by SetEmptyPageMessage(). This string may contain a "%s" placeholder. </td></tr>
    <tr><td valign=top><em>lpszCaption</em>&nbsp;</td><td>The title of the empty page.</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="b1" doxytag="TreePropSheet::CTreePropSheet::CreatePageTreeObject"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CTreeCtrl * TreePropSheet::CTreePropSheet::CreatePageTreeObject </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Will be called during creation process, to create the CTreeCtrl object (the object, not the window!).<p>
Allows you to inject your own CTreeCtrl-derived classes.<p>
This default implementation simply creates a CTreeCtrl with new and returns it.    </td>
  </tr>
</table>
<a name="b2" doxytag="TreePropSheet::CTreePropSheet::CreatePageFrame"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classTreePropSheet_1_1CPropPageFrame.html">CPropPageFrame</a> * TreePropSheet::CTreePropSheet::CreatePageFrame </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Will be called during creation process, to create the object, that is responsible for drawing the frame around the pages, drawing the empty page message and the caption.<p>
Allows you to inject your own CPropPageFrame-derived classes.<p>
This default implementation simply creates a CPropPageFrameTab with new and returns it.    </td>
  </tr>
</table>
<a name="b3" doxytag="TreePropSheet::CTreePropSheet::MoveChildWindows"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::MoveChildWindows </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>nDx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nDy</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Moves all childs by the specified amount of pixels.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>nDx</em>&nbsp;</td><td>Pixels to move the childs in horizontal direction (can be negative). </td></tr>
    <tr><td valign=top><em>nDy</em>&nbsp;</td><td>Pixels to move the childs in vertical direction (can be negative).</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="b4" doxytag="TreePropSheet::CTreePropSheet::RefillPageTree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::RefillPageTree </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Refills the tree that contains the entries for the several pages.    </td>
  </tr>
</table>
<a name="b5" doxytag="TreePropSheet::CTreePropSheet::CreatePageTreeItem"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HTREEITEM TreePropSheet::CTreePropSheet::CreatePageTreeItem </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszPath</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>HTREEITEM&nbsp;</td>
          <td class="mdname" nowrap> <em>hParent</em> = TVI_ROOT</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates the specified path in the page tree and returns the handle of the most child item created.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>lpszPath</em>&nbsp;</td><td>Path of the item to create (see description of this class). </td></tr>
    <tr><td valign=top><em>hParentItem</em>&nbsp;</td><td>Handle of the item under which the path should be created or TVI_ROOT to start from the root.</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="b6" doxytag="TreePropSheet::CTreePropSheet::SplitPageTreePath"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CString TreePropSheet::CTreePropSheet::SplitPageTreePath </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CString &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>strRest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Splits the given path into the topmost item and the rest. See description of this class for detailed path information.<p>
I.e. when given the string "Appearance::Toolbars::Customize", the method will return "Appearance" and after the call strRest will be "Toolbars::Customize".    </td>
  </tr>
</table>
<a name="b7" doxytag="TreePropSheet::CTreePropSheet::KillActiveCurrentPage"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::KillActiveCurrentPage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tries to deactivate the current page, and hides it if successfull, so that an empty page becomes visible.<p>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE if the current page has been deactivated successfully, FALSE if the currently active page prevents a page change.</dd></dl>
    </td>
  </tr>
</table>
<a name="b8" doxytag="TreePropSheet::CTreePropSheet::GetPageTreeItem"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HTREEITEM TreePropSheet::CTreePropSheet::GetPageTreeItem </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>nPage</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>HTREEITEM&nbsp;</td>
          <td class="mdname" nowrap> <em>hRoot</em> = TVI_ROOT</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the page tree item, that representates the specified page or NULL, if no such icon exists.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>nPage</em>&nbsp;</td><td>Zero based page index, for which the item to retrieve. </td></tr>
    <tr><td valign=top><em>hRoot</em>&nbsp;</td><td>Item to start the search at or TVI_ROOT to search the whole tree.</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="b9" doxytag="TreePropSheet::CTreePropSheet::SelectPageTreeItem"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SelectPageTreeItem </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>nPage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Selects and shows the item, representing the specified page.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>nPage</em>&nbsp;</td><td>Zero based page index.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE if no item does exist for the specified page.</dd></dl>
    </td>
  </tr>
</table>
<a name="b10" doxytag="TreePropSheet::CTreePropSheet::SelectCurrentPageTreeItem"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TreePropSheet::CTreePropSheet::SelectCurrentPageTreeItem </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Selects and shows the tree item for the currently active page.<p>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE if no item exists for the currently active page or if it was not possible to get information about the currently active page.</dd></dl>
    </td>
  </tr>
</table>
<a name="b11" doxytag="TreePropSheet::CTreePropSheet::UpdateCaption"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::UpdateCaption </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Updates the caption for the currently selected page (if the caption is enabled).    </td>
  </tr>
</table>
<a name="b12" doxytag="TreePropSheet::CTreePropSheet::ActivatePreviousPage"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::ActivatePreviousPage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Activates the previous page in the page order or the last one, if the current one is the first.<p>
This method does never fail.    </td>
  </tr>
</table>
<a name="b13" doxytag="TreePropSheet::CTreePropSheet::ActivateNextPage"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void TreePropSheet::CTreePropSheet::ActivateNextPage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Activates the next page in the page order or the first one, if the current one is the last.<p>
This method does never fail.    </td>
  </tr>
</table>
<hr><address style="align: right;"><small>
Generated on Mon May 15 16:43:44 2006 for NewVision by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
