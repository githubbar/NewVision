<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NewVision: HyperLink.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>HyperLink.h</h1><div class="fragment"><pre>00001 <span class="comment">// HyperLink.h : header file</span>
00002 <span class="comment">//</span>
00003 <span class="comment">//</span>
00004 <span class="comment">// HyperLink static control. Will open the default browser with the given URL</span>
00005 <span class="comment">// when the user clicks on the link.</span>
00006 <span class="comment">//</span>
00007 <span class="comment">// Copyright Chris Maunder, 1997, 1998</span>
00008 <span class="comment">// Feel free to use and distribute. May not be sold for profit. </span>
00009 
00010 <span class="preprocessor">#if !defined(HYPERLINK_H)</span>
00011 <span class="preprocessor"></span><span class="preprocessor">#define HYPERLINK_H</span>
00012 <span class="preprocessor"></span>
00013 <span class="preprocessor">#pragma once</span>
00014 <span class="preprocessor"></span>
00016 <span class="comment">// CHyperLink window</span>
00017 
00018 <span class="keyword">class </span>CHyperLink : <span class="keyword">public</span> CStatic
00019 {
00020 <span class="comment">// Construction/destruction</span>
00021 <span class="keyword">public</span>:
00022     CHyperLink();
00023     <span class="keyword">virtual</span> ~CHyperLink();
00024 
00025 <span class="comment">// Attributes</span>
00026 <span class="keyword">public</span>:
00027 
00028 <span class="comment">// Operations</span>
00029 <span class="keyword">public</span>:
00030 
00031     <span class="keywordtype">void</span> SetURL(CString strURL);
00032     CString GetURL() <span class="keyword">const</span>;
00033 
00034     <span class="keywordtype">void</span> SetColours(COLORREF crLinkColour, COLORREF crVisitedColour, 
00035                     COLORREF crHoverColour = -1);
00036     COLORREF GetLinkColour() <span class="keyword">const</span>;
00037     COLORREF GetVisitedColour() <span class="keyword">const</span>;
00038     COLORREF GetHoverColour() <span class="keyword">const</span>;
00039 
00040     <span class="keywordtype">void</span> SetVisited(BOOL bVisited = TRUE);
00041     BOOL GetVisited() <span class="keyword">const</span>;
00042 
00043     <span class="keywordtype">void</span> SetLinkCursor(HCURSOR hCursor);
00044     HCURSOR GetLinkCursor() <span class="keyword">const</span>;
00045 
00046     <span class="keywordtype">void</span> SetUnderline(BOOL bUnderline = TRUE);
00047     BOOL GetUnderline() <span class="keyword">const</span>;
00048 
00049     <span class="keywordtype">void</span> SetAutoSize(BOOL bAutoSize = TRUE);
00050     BOOL GetAutoSize() <span class="keyword">const</span>;
00051 
00052 <span class="comment">// Overrides</span>
00053     <span class="keyword">public</span>:
00054     <span class="keyword">virtual</span> BOOL PreTranslateMessage(MSG* pMsg);
00055     <span class="keyword">protected</span>:
00056     <span class="keyword">virtual</span> <span class="keywordtype">void</span> PreSubclassWindow();
00057 
00058 <span class="comment">// Implementation</span>
00059 <span class="keyword">protected</span>:
00060     HINSTANCE GotoURL(LPCTSTR url, <span class="keywordtype">int</span> showcmd);
00061     <span class="keywordtype">void</span> ReportError(<span class="keywordtype">int</span> nError);
00062     LONG GetRegKey(HKEY key, LPCTSTR subkey, LPTSTR retdata);
00063     <span class="keywordtype">void</span> PositionWindow();
00064     <span class="keywordtype">void</span> SetDefaultCursor();
00065 
00066 <span class="comment">// Protected attributes</span>
00067 <span class="keyword">protected</span>:
00068     COLORREF m_crLinkColour, m_crVisitedColour;     <span class="comment">// Hyperlink colours</span>
00069     COLORREF m_crHoverColour;                       <span class="comment">// Hover colour</span>
00070     BOOL     m_bOverControl;                        <span class="comment">// cursor over control?</span>
00071     BOOL     m_bVisited;                            <span class="comment">// Has it been visited?</span>
00072     BOOL     m_bUnderline;                          <span class="comment">// underline hyperlink?</span>
00073     BOOL     m_bAdjustToFit;                        <span class="comment">// Adjust window size to fit text?</span>
00074     CString  m_strURL;                              <span class="comment">// hyperlink URL</span>
00075     CFont    m_Font;                                <span class="comment">// Underline font if necessary</span>
00076     HCURSOR  m_hLinkCursor;                         <span class="comment">// Cursor for hyperlink</span>
00077     CToolTipCtrl m_ToolTip;                         <span class="comment">// The tooltip</span>
00078 
00079     <span class="comment">// Generated message map functions</span>
00080 <span class="keyword">protected</span>:
00081     <span class="comment">//{{AFX_MSG(CHyperLink)</span>
00082     afx_msg HBRUSH CtlColor(CDC* pDC, UINT nCtlColor);
00083     afx_msg BOOL OnSetCursor(CWnd* pWnd, UINT nHitTest, UINT message);
00084     afx_msg <span class="keywordtype">void</span> OnMouseMove(UINT nFlags, CPoint point);
00085     <span class="comment">//}}AFX_MSG</span>
00086     afx_msg <span class="keywordtype">void</span> OnClicked();
00087     DECLARE_MESSAGE_MAP()
00088 };
00089 
00090 
00091 <span class="preprocessor">#endif // !defined(HYPERLINK_H)</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Mon May 15 16:43:42 2006 for NewVision by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
