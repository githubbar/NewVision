<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NewVision: BodyPath.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>BodyPath.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#if !defined( BODYPATH_H )</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define BODYPATH_H</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#pragma once</span>
00004 <span class="preprocessor"></span>
00005 <span class="preprocessor">#include &lt;afxtempl.h&gt;</span>
00006 <span class="preprocessor">#include "cv.h"</span>
00007 
00008 <span class="keyword">class </span>Body;
00009 <span class="keyword">class </span>FloorModel;
00010 <span class="keyword">class </span>TrackerModel;
00011 
00012 <span class="preprocessor">#define DWELL_POINT_SCALE 0.8   </span>
00013 <span class="preprocessor"></span><span class="preprocessor">#define DWELL_POINT_MAX_R 15</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#define DWELL_POINT_COLOR CV_RGB(200, 170, 10)</span>
00015 <span class="preprocessor"></span>
00016 
00017 <span class="keyword">struct </span>Step {
00018     Step() {this-&gt;dwell = <span class="keyword">false</span>;};
00019     Step(CvPoint2D32f p, <span class="keywordtype">double</span> height, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> orientation) {
00020         this-&gt;p = p;
00021         this-&gt;height = height;
00022         this-&gt;width = width;
00023         this-&gt;orientation = orientation;
00024         this-&gt;dwell = <span class="keyword">false</span>;
00025     }
00026     <span class="keyword">virtual</span> <span class="keywordtype">void</span> Serialize(CArchive&amp; ar) {
00027         <span class="keywordflow">if</span> (ar.IsStoring()) ar &lt;&lt; p.x &lt;&lt; p.y &lt;&lt; height &lt;&lt; width &lt;&lt; orientation &lt;&lt; dwell;
00028         <span class="keywordflow">else</span> ar &gt;&gt; p.x &gt;&gt; p.y &gt;&gt; height &gt;&gt; width &gt;&gt; orientation &gt;&gt; dwell;
00029     }
00030 
00031     CvPoint2D32f p;
00032     <span class="keywordtype">double</span> height;
00033     <span class="keywordtype">double</span> width;
00034     <span class="keywordtype">double</span> orientation;
00035     <span class="keywordtype">bool</span> dwell;
00036     CvPoint p1, p2; <span class="comment">// temp</span>
00037 };
00038 <span class="comment">// --------------------------------------------------------------------------</span>
00039 <span class="keyword">class </span>BodyPath : <span class="keyword">public</span> CArray &lt; Step &gt; 
00040 {
00041     DECLARE_SERIAL(BodyPath)
00042 <span class="keyword">public</span>:
00043     <span class="keywordtype">int</span> id;          <span class="comment">// unique body id</span>
00044     <span class="keywordtype">int</span> groupid;     <span class="comment">// the group it belongs to</span>
00045     <span class="keywordtype">int</span> startFrame;  <span class="comment">// number of start frame</span>
00046     
00047     BodyPath(<span class="keywordtype">int</span> id, CvPoint2D32f p, <span class="keywordtype">int</span> startFrame, <span class="keywordtype">double</span> height, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> orientation);
00048     BodyPath(<span class="keywordtype">void</span>);
00049     BodyPath&amp; operator=(<span class="keyword">const</span> BodyPath&amp; that);
00050     
00051     <span class="keyword">virtual</span> ~BodyPath(<span class="keywordtype">void</span>);
00052     <span class="keywordtype">void</span> Add(CvPoint2D32f p, <span class="keywordtype">double</span> height, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> orientation);
00053     <span class="keywordtype">void</span> Draw(IplImage* frame, CvScalar color, FloorModel* fm, TrackerModel* tm, <span class="keywordtype">double</span> sigma);
00054     CvPoint2D32f Smooth(<span class="keywordtype">int</span> n, <span class="keywordtype">double</span> sigma);
00055     <span class="keywordtype">bool</span> ComputeDwellingState(<span class="keywordtype">int</span> nFrame, <span class="keywordtype">double</span> sigma, <span class="keywordtype">int</span> dwellFrames, <span class="keywordtype">double</span> dwellAreaRadius);
00056     <span class="keywordtype">bool</span> IsDwelling(<span class="keywordtype">int</span> nFrame);
00057     <span class="keywordtype">double</span> GetHeight();
00058     <span class="keywordtype">double</span> GetWidth();
00059     <span class="keywordtype">void</span> GetDwellLocations(CArray&lt;CvPoint2D32f&gt; &amp;dwellLocation, CArray&lt;int&gt; &amp;dwellFrame, CArray&lt;int&gt; &amp;dwellDuration);
00060     <span class="keywordtype">double</span> Compare(BodyPath* that);
00061     <span class="keyword">virtual</span> <span class="keywordtype">void</span> Serialize(CArchive&amp; ar);
00062 };
00063 <span class="comment">// --------------------------------------------------------------------------</span>
00064 <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> AFXAPI SerializeElements &lt;BodyPath*&gt; ( CArchive&amp; ar, BodyPath** p, INT_PTR nCount );
00065 <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> AFXAPI SerializeElements &lt;Step&gt; ( CArchive&amp; ar, Step* p, INT_PTR nCount );
00066 <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> AFXAPI SerializeElements &lt;CvPoint2D32f&gt; ( CArchive&amp; ar, CvPoint2D32f* p, INT_PTR nCount );
00067 <span class="preprocessor">#endif // !defined( BODYPATH_H )</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Tue Apr 4 17:07:04 2006 for NewVision by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
