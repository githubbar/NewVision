<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>New Vision: F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/GroupTagWindow.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/GroupTagWindow.h</h1><a href="_group_tag_window_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="_persistant_formats_8h.html">PersistantFormats.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="_new_vision_doc_8h.html">NewVisionDoc.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="_text_entry_dlg_8h.html">TextEntryDlg.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="_swarm_event_8h.html">SwarmEvent.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="_swarm_activity_8h.html">SwarmActivity.h</a>"</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">using namespace </span>System;
<a name="l00011"></a>00011 <span class="keyword">using namespace </span>System::ComponentModel;
<a name="l00012"></a>00012 <span class="keyword">using namespace </span>System::Collections;
<a name="l00013"></a>00013 <span class="keyword">using namespace </span>System::Windows::Forms;
<a name="l00014"></a>00014 <span class="keyword">using namespace </span>System::Data;
<a name="l00015"></a>00015 <span class="keyword">using namespace </span>System::Drawing;
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="keyword">namespace </span>NewVision {
<a name="l00019"></a>00019 
<a name="l00029"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html">00029</a>         <span class="keyword">public</span> ref <span class="keyword">class </span><a class="code" href="class_new_vision_1_1_group_tag_window.html">GroupTagWindow</a> : <span class="keyword">public</span> System::Windows::Forms::Form
<a name="l00030"></a>00030         {
<a name="l00031"></a>00031         <span class="keyword">public</span>:
<a name="l00032"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#cb32b2893670bce566cd1a25379ccdcd">00032</a>                 <a class="code" href="class_new_vision_1_1_group_tag_window.html#cb32b2893670bce566cd1a25379ccdcd">GroupTagWindow</a>(<a class="code" href="class_activity_data.html">ActivityData</a>* data, <span class="keywordtype">int</span> actorID) {
<a name="l00033"></a>00033                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#3887b020c636616d6eeab605d55687b4">m_actorID</a> = actorID;
<a name="l00034"></a>00034                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a> = data;
<a name="l00035"></a>00035                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#b2a3c48e53a119d3c752c98013d19b8e">InitializeComponent</a>();
<a name="l00036"></a>00036                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;UserDeletedRow += gcnew DataGridViewRowEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_new_vision_1_1_group_tag_window.html#067a9cc93b911603ab517d37780461ea">GroupTagWindow::OnGroupDeleted</a>);
<a name="l00037"></a>00037                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;SortCompare += gcnew DataGridViewSortCompareEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_new_vision_1_1_group_tag_window.html#be77feae8c03e44e2cca71786cb03b4f">GroupTagWindow::SortCompare</a>);
<a name="l00038"></a>00038                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#e72eec4bfcdeb588318c736d2d3d108e">ImportData</a>(data);
<a name="l00039"></a>00039                 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#e72eec4bfcdeb588318c736d2d3d108e">00041</a>                 <span class="keywordtype">void</span> <a class="code" href="class_new_vision_1_1_group_tag_window.html#e72eec4bfcdeb588318c736d2d3d108e">ImportData</a>(<a class="code" href="class_activity_data.html">ActivityData</a>* data) {
<a name="l00042"></a>00042                         POSITION pos = data-&gt;<a class="code" href="class_activity_data.html#65d6d32f7e8aa33a81cc89e6166a9a73">sActivity</a>.GetStartPosition();
<a name="l00043"></a>00043                         DataGridViewRowCollection ^rows = this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows;
<a name="l00044"></a>00044                         rows-&gt;Clear();
<a name="l00045"></a>00045                         <span class="keywordflow">while</span> (pos) {
<a name="l00046"></a>00046                                 <span class="keywordtype">int</span> id; <a class="code" href="class_swarm_activity.html">SwarmActivity</a> *ac;
<a name="l00047"></a>00047                                 <a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a>-&gt;<a class="code" href="class_activity_data.html#65d6d32f7e8aa33a81cc89e6166a9a73">sActivity</a>.GetNextAssoc(pos, <span class="keywordtype">id</span>, ac);
<a name="l00048"></a>00048                                 <span class="keywordflow">if</span> (ac-&gt;<a class="code" href="class_swarm_activity.html#52c55a529bacc7254451e0afcfae28a0">type</a> != <span class="stringliteral">"GROUPING"</span>)
<a name="l00049"></a>00049                                         <span class="keywordflow">continue</span>;
<a name="l00050"></a>00050                                 rows-&gt;Add();
<a name="l00051"></a>00051                                 DataGridViewRow ^row = rows[rows-&gt;Count-1];
<a name="l00052"></a>00052                                 row-&gt;Cells[<span class="stringliteral">"GroupID"</span>]-&gt;Value = String::Format(<span class="stringliteral">"{0}"</span>, <span class="keywordtype">id</span>);
<a name="l00053"></a>00053                                 POSITION posA = ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetStartPosition();
<a name="l00054"></a>00054                                 <span class="keywordtype">int</span> nColumn = 1;
<a name="l00055"></a>00055                                 <span class="keywordflow">while</span> (posA) {
<a name="l00056"></a>00056                                         <span class="keywordtype">int</span> aid; <span class="keywordtype">double</span> c;
<a name="l00057"></a>00057                                         ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetNextAssoc(posA, aid, c);
<a name="l00058"></a>00058                                         <span class="keywordflow">if</span> (this-&gt;dataGridView1-&gt;ColumnCount &lt; nColumn+1)
<a name="l00059"></a>00059                                                 this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Columns-&gt;Add(String::Format(<span class="stringliteral">"Actor{0}"</span>, nColumn), String::Format(<span class="stringliteral">"Actor {0}"</span>, nColumn));
<a name="l00060"></a>00060                                         row-&gt;Cells[nColumn++]-&gt;Value = String::Format(<span class="stringliteral">"{0}"</span>, aid);
<a name="l00061"></a>00061                                 }
<a name="l00062"></a>00062                         }
<a name="l00063"></a>00063                 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065         <span class="keyword">protected</span>:
<a name="l00069"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#b0a2f8edb05aae6d87148169247a854c">00069</a>                 <a class="code" href="class_new_vision_1_1_group_tag_window.html#b0a2f8edb05aae6d87148169247a854c">~GroupTagWindow</a>()
<a name="l00070"></a>00070                 {
<a name="l00071"></a>00071                         <span class="keywordflow">if</span> (<a class="code" href="class_new_vision_1_1_group_tag_window.html#add35e042e3f95e59b95128e901feae7">components</a>)
<a name="l00072"></a>00072                         {
<a name="l00073"></a>00073                                 <span class="keyword">delete</span> <a class="code" href="class_new_vision_1_1_group_tag_window.html#add35e042e3f95e59b95128e901feae7">components</a>;
<a name="l00074"></a>00074                         }
<a name="l00075"></a>00075                 }
<a name="l00076"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">00076</a>         <span class="keyword">private</span>: <a class="code" href="class_activity_data.html">ActivityData</a> *<a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a>;
<a name="l00077"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#3887b020c636616d6eeab605d55687b4">00077</a>         <span class="keyword">private</span>: <span class="keywordtype">int</span> <a class="code" href="class_new_vision_1_1_group_tag_window.html#3887b020c636616d6eeab605d55687b4">m_actorID</a>;
<a name="l00078"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">00078</a>         <span class="keyword">private</span>: System::Windows::Forms::DataGridView^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>;
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">00080</a>         <span class="keyword">private</span>: System::Windows::Forms::Button^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>;
<a name="l00081"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">00081</a>         <span class="keyword">private</span>: System::Windows::Forms::Button^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>;
<a name="l00082"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">00082</a>         <span class="keyword">private</span>: System::Windows::Forms::Button^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>;
<a name="l00083"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">00083</a>         <span class="keyword">private</span>: System::Windows::Forms::Button^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>;
<a name="l00084"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">00084</a>         <span class="keyword">private</span>: System::Windows::Forms::DataGridViewTextBoxColumn^  <a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a>;
<a name="l00085"></a>00085         <span class="keyword">protected</span>: 
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         <span class="keyword">private</span>:
<a name="l00091"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#add35e042e3f95e59b95128e901feae7">00091</a>                 System::ComponentModel::Container ^<a class="code" href="class_new_vision_1_1_group_tag_window.html#add35e042e3f95e59b95128e901feae7">components</a>;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="preprocessor">#pragma region Windows Form Designer generated code</span>
<a name="l00098"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#b2a3c48e53a119d3c752c98013d19b8e">00098</a> <span class="preprocessor">                void InitializeComponent(void)</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>                {
<a name="l00100"></a>00100                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a> = (gcnew System::Windows::Forms::DataGridView());
<a name="l00101"></a>00101                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a> = (gcnew System::Windows::Forms::DataGridViewTextBoxColumn());
<a name="l00102"></a>00102                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a> = (gcnew System::Windows::Forms::Button());
<a name="l00103"></a>00103                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a> = (gcnew System::Windows::Forms::Button());
<a name="l00104"></a>00104                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a> = (gcnew System::Windows::Forms::Button());
<a name="l00105"></a>00105                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a> = (gcnew System::Windows::Forms::Button());
<a name="l00106"></a>00106                         (cli::safe_cast&lt;System::ComponentModel::ISupportInitialize^  &gt;(this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>))-&gt;BeginInit();
<a name="l00107"></a>00107                         this-&gt;SuspendLayout();
<a name="l00108"></a>00108                         <span class="comment">// </span>
<a name="l00109"></a>00109                         <span class="comment">// dataGridView1</span>
<a name="l00110"></a>00110                         <span class="comment">// </span>
<a name="l00111"></a>00111                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;AllowUserToAddRows = <span class="keyword">false</span>;
<a name="l00112"></a>00112                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;AllowUserToResizeRows = <span class="keyword">false</span>;
<a name="l00113"></a>00113                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;ColumnHeadersHeightSizeMode = System::Windows::Forms::DataGridViewColumnHeadersHeightSizeMode::AutoSize;
<a name="l00114"></a>00114                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Columns-&gt;AddRange(gcnew cli::array&lt; System::Windows::Forms::DataGridViewColumn^  &gt;(1) {this-&gt;GroupID});
<a name="l00115"></a>00115                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Location = System::Drawing::Point(0, 0);
<a name="l00116"></a>00116                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Name = L<span class="stringliteral">"dataGridView1"</span>;
<a name="l00117"></a>00117                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Size = System::Drawing::Size(367, 176);
<a name="l00118"></a>00118                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;TabIndex = 0;
<a name="l00119"></a>00119                         <span class="comment">// </span>
<a name="l00120"></a>00120                         <span class="comment">// GroupID</span>
<a name="l00121"></a>00121                         <span class="comment">// </span>
<a name="l00122"></a>00122                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a>-&gt;HeaderText = L<span class="stringliteral">"Group ID"</span>;
<a name="l00123"></a>00123                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a>-&gt;Name = L<span class="stringliteral">"GroupID"</span>;
<a name="l00124"></a>00124                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a>-&gt;ReadOnly = <span class="keyword">true</span>;
<a name="l00125"></a>00125                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#a02e57075f0e424d3abb8977fc90e633">GroupID</a>-&gt;Width = 50;
<a name="l00126"></a>00126                         <span class="comment">// </span>
<a name="l00127"></a>00127                         <span class="comment">// buttonDeleteGroup</span>
<a name="l00128"></a>00128                         <span class="comment">// </span>
<a name="l00129"></a>00129                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;Location = System::Drawing::Point(373, 63);
<a name="l00130"></a>00130                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;Name = L<span class="stringliteral">"buttonDeleteGroup"</span>;
<a name="l00131"></a>00131                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;Size = System::Drawing::Size(97, 23);
<a name="l00132"></a>00132                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;TabIndex = 1;
<a name="l00133"></a>00133                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;Text = L<span class="stringliteral">"Delete Group"</span>;
<a name="l00134"></a>00134                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;UseVisualStyleBackColor = <span class="keyword">true</span>;
<a name="l00135"></a>00135                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#b60b1443ac02efd923aa25cfdbb917a4">buttonDeleteGroup</a>-&gt;Click += gcnew System::EventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_new_vision_1_1_group_tag_window.html#dd6534683d00978cd3c8b523b3f7f095">GroupTagWindow::buttonDeleteGroup_Click</a>);
<a name="l00136"></a>00136                         <span class="comment">// </span>
<a name="l00137"></a>00137                         <span class="comment">// buttonAddGroup</span>
<a name="l00138"></a>00138                         <span class="comment">// </span>
<a name="l00139"></a>00139                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;Location = System::Drawing::Point(373, 92);
<a name="l00140"></a>00140                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;Name = L<span class="stringliteral">"buttonAddGroup"</span>;
<a name="l00141"></a>00141                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;Size = System::Drawing::Size(97, 23);
<a name="l00142"></a>00142                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;TabIndex = 2;
<a name="l00143"></a>00143                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;Text = L<span class="stringliteral">"New Group"</span>;
<a name="l00144"></a>00144                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;UseVisualStyleBackColor = <span class="keyword">true</span>;
<a name="l00145"></a>00145                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d14dabb9e6a4eeae8dd93a2a1c8d2d8e">buttonAddGroup</a>-&gt;Click += gcnew System::EventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_new_vision_1_1_group_tag_window.html#cc19a7819f988348712b856b3a9f108e">GroupTagWindow::buttonAddGroup_Click</a>);
<a name="l00146"></a>00146                         <span class="comment">// </span>
<a name="l00147"></a>00147                         <span class="comment">// buttonAddToSelected</span>
<a name="l00148"></a>00148                         <span class="comment">// </span>
<a name="l00149"></a>00149                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;Location = System::Drawing::Point(373, 14);
<a name="l00150"></a>00150                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;Name = L<span class="stringliteral">"buttonAddToSelected"</span>;
<a name="l00151"></a>00151                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;Size = System::Drawing::Size(97, 43);
<a name="l00152"></a>00152                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;TabIndex = 3;
<a name="l00153"></a>00153                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;Text = L<span class="stringliteral">"Add To Selected Group"</span>;
<a name="l00154"></a>00154                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;UseVisualStyleBackColor = <span class="keyword">true</span>;
<a name="l00155"></a>00155                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#4668923908186e14b59652a52b20bfcc">buttonAddToSelected</a>-&gt;Click += gcnew System::EventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_new_vision_1_1_group_tag_window.html#f9e15225c8667a394fafece04082be13">GroupTagWindow::buttonAddToSelected_Click</a>);
<a name="l00156"></a>00156                         <span class="comment">// </span>
<a name="l00157"></a>00157                         <span class="comment">// buttonClose</span>
<a name="l00158"></a>00158                         <span class="comment">// </span>
<a name="l00159"></a>00159                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;DialogResult = System::Windows::Forms::DialogResult::OK;
<a name="l00160"></a>00160                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;Location = System::Drawing::Point(373, 121);
<a name="l00161"></a>00161                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;Name = L<span class="stringliteral">"buttonClose"</span>;
<a name="l00162"></a>00162                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;Size = System::Drawing::Size(97, 23);
<a name="l00163"></a>00163                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;TabIndex = 4;
<a name="l00164"></a>00164                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;Text = L<span class="stringliteral">"Close"</span>;
<a name="l00165"></a>00165                         this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#d235b1f2415db93d07247a5f31c40269">buttonClose</a>-&gt;UseVisualStyleBackColor = <span class="keyword">true</span>;
<a name="l00166"></a>00166                         <span class="comment">// </span>
<a name="l00167"></a>00167                         <span class="comment">// GroupTagWindow</span>
<a name="l00168"></a>00168                         <span class="comment">// </span>
<a name="l00169"></a>00169                         this-&gt;AutoScaleDimensions = System::Drawing::SizeF(6, 13);
<a name="l00170"></a>00170                         this-&gt;AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
<a name="l00171"></a>00171                         this-&gt;ClientSize = System::Drawing::Size(480, 176);
<a name="l00172"></a>00172                         this-&gt;Controls-&gt;Add(this-&gt;buttonClose);
<a name="l00173"></a>00173                         this-&gt;Controls-&gt;Add(this-&gt;buttonAddToSelected);
<a name="l00174"></a>00174                         this-&gt;Controls-&gt;Add(this-&gt;buttonAddGroup);
<a name="l00175"></a>00175                         this-&gt;Controls-&gt;Add(this-&gt;buttonDeleteGroup);
<a name="l00176"></a>00176                         this-&gt;Controls-&gt;Add(this-&gt;dataGridView1);
<a name="l00177"></a>00177                         this-&gt;Name = L<span class="stringliteral">"GroupTagWindow"</span>;
<a name="l00178"></a>00178                         this-&gt;Text = L<span class="stringliteral">"Shopper Groups"</span>;
<a name="l00179"></a>00179                         (cli::safe_cast&lt;System::ComponentModel::ISupportInitialize^  &gt;(this-&gt;<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>))-&gt;EndInit();
<a name="l00180"></a>00180                         this-&gt;ResumeLayout(<span class="keyword">false</span>);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182                 }
<a name="l00183"></a>00183 <span class="preprocessor">#pragma endregion</span>
<a name="l00184"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#067a9cc93b911603ab517d37780461ea">00184</a> <span class="preprocessor"></span>                <span class="keyword">private</span>: System::Void <a class="code" href="class_new_vision_1_1_group_tag_window.html#067a9cc93b911603ab517d37780461ea">OnGroupDeleted</a>(System::Object^ sender, DataGridViewRowEventArgs^  e) {
<a name="l00185"></a>00185                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a>-&gt;<a class="code" href="class_activity_data.html#65d6d32f7e8aa33a81cc89e6166a9a73">sActivity</a>.RemoveKey(Convert::ToInt32(e-&gt;Row-&gt;Cells[<span class="stringliteral">"GroupID"</span>]-&gt;Value));
<a name="l00186"></a>00186                 }
<a name="l00187"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#dd6534683d00978cd3c8b523b3f7f095">00187</a>                 <span class="keyword">private</span>: System::Void <a class="code" href="class_new_vision_1_1_group_tag_window.html#dd6534683d00978cd3c8b523b3f7f095">buttonDeleteGroup_Click</a>(System::Object^  sender, System::EventArgs^  e) {
<a name="l00188"></a>00188                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#067a9cc93b911603ab517d37780461ea">OnGroupDeleted</a>(sender, gcnew DataGridViewRowEventArgs(<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;CurrentRow));
<a name="l00189"></a>00189                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows-&gt;Remove(<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;CurrentRow);
<a name="l00190"></a>00190                 }
<a name="l00191"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#cc19a7819f988348712b856b3a9f108e">00191</a>                 <span class="keyword">private</span>: System::Void <a class="code" href="class_new_vision_1_1_group_tag_window.html#cc19a7819f988348712b856b3a9f108e">buttonAddGroup_Click</a>(System::Object^  sender, System::EventArgs^ e) {
<a name="l00192"></a>00192                         <a class="code" href="class_swarm_activity.html">SwarmActivity</a>* ac = <span class="keyword">new</span> <a class="code" href="class_swarm_activity.html">SwarmActivity</a>(); ac-&gt;<a class="code" href="class_swarm_activity.html#52c55a529bacc7254451e0afcfae28a0">type</a> = <span class="stringliteral">"GROUPING"</span>;
<a name="l00193"></a>00193                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a>-&gt;<a class="code" href="class_activity_data.html#65d6d32f7e8aa33a81cc89e6166a9a73">sActivity</a>.SetAt(ac-&gt;<a class="code" href="class_i_node.html#68dcef077c6360dcd995584d8cacc125">id</a>, ac);
<a name="l00194"></a>00194                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows-&gt;Add();
<a name="l00195"></a>00195                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows[<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows-&gt;Count-1]-&gt;Cells[<span class="stringliteral">"GroupID"</span>]-&gt;Value = String::Format(<span class="stringliteral">"{0}"</span>, ac-&gt;<a class="code" href="class_i_node.html#68dcef077c6360dcd995584d8cacc125">id</a>);
<a name="l00196"></a>00196                         <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;CurrentCell  = <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows[<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows-&gt;Count-1]-&gt;Cells[<span class="stringliteral">"GroupID"</span>];
<a name="l00197"></a>00197                 }
<a name="l00198"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#f9e15225c8667a394fafece04082be13">00198</a>                 <span class="keyword">private</span>: System::Void <a class="code" href="class_new_vision_1_1_group_tag_window.html#f9e15225c8667a394fafece04082be13">buttonAddToSelected_Click</a>(System::Object^  sender, System::EventArgs^  e) {
<a name="l00199"></a>00199                         <span class="keywordflow">if</span> (!<a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;Rows-&gt;Count)
<a name="l00200"></a>00200                                 <a class="code" href="class_new_vision_1_1_group_tag_window.html#cc19a7819f988348712b856b3a9f108e">buttonAddGroup_Click</a>(sender, e);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202                         <span class="keywordflow">if</span> (this-&gt;m_actorID != -1) {
<a name="l00203"></a>00203                                 DataGridViewRow ^row = <a class="code" href="class_new_vision_1_1_group_tag_window.html#69e55acb0cb797d0df3745a5de7b3b37">dataGridView1</a>-&gt;CurrentRow;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205                                 <span class="comment">// == update the data source</span>
<a name="l00206"></a>00206                                 <a class="code" href="class_swarm_activity.html">SwarmActivity</a>* ac;
<a name="l00207"></a>00207                                 <span class="keywordflow">if</span> (<a class="code" href="class_new_vision_1_1_group_tag_window.html#306412f2f3f5b3d4dd8f83d65425f8b3">m_data</a>-&gt;<a class="code" href="class_activity_data.html#65d6d32f7e8aa33a81cc89e6166a9a73">sActivity</a>.Lookup(Int32::Parse(row-&gt;Cells[<span class="stringliteral">"GroupID"</span>]-&gt;Value-&gt;ToString()), ac))
<a name="l00208"></a>00208                                         ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.SetAt(this-&gt;m_actorID, 1);
<a name="l00209"></a>00209 
<a name="l00210"></a>00210                                 <span class="comment">// == update the table</span>
<a name="l00211"></a>00211                                 <span class="keywordflow">if</span> (this-&gt;dataGridView1-&gt;ColumnCount &lt; ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetCount()+1)         <span class="comment">// if enough columns, add a new one</span>
<a name="l00212"></a>00212                                         this-&gt;dataGridView1-&gt;Columns-&gt;Add(String::Format(<span class="stringliteral">"Actor{0}"</span>, ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetCount()), String::Format(<span class="stringliteral">"Actor {0}"</span>, ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetCount()));
<a name="l00213"></a>00213                                 row-&gt;Cells[ac-&gt;<a class="code" href="class_swarm_activity.html#c32b160d5b7d46d4e2de454b49a78f72">actors</a>.GetCount()]-&gt;Value = String::Format(<span class="stringliteral">"{0}"</span>, this-&gt;m_actorID);
<a name="l00214"></a>00214                         
<a name="l00215"></a>00215                         }
<a name="l00216"></a>00216                 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="class_new_vision_1_1_group_tag_window.html#be77feae8c03e44e2cca71786cb03b4f">00218</a>                 <span class="keyword">private</span>: System::Void <a class="code" href="class_new_vision_1_1_group_tag_window.html#be77feae8c03e44e2cca71786cb03b4f">SortCompare</a>(Object^ sender, DataGridViewSortCompareEventArgs^ e) {
<a name="l00219"></a>00219                         e-&gt;SortResult = Convert::ToInt32(e-&gt;CellValue1).CompareTo(Convert::ToInt32(e-&gt;CellValue2));
<a name="l00220"></a>00220                         e-&gt;Handled = <span class="keyword">true</span>;
<a name="l00221"></a>00221                 }
<a name="l00222"></a>00222 };
<a name="l00223"></a>00223 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Apr 24 22:32:50 2007 for New Vision by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
