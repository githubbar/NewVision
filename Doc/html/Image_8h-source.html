<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NewVision: Image.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>Image.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#pragma once</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#include "Pixel.h"</span>
00003 <span class="preprocessor">#include "cxcore.h"</span>
00004 
00005 <span class="comment">// NOTE: by default OpenCV images are BGR, not RGB</span>
00006 <span class="keyword">namespace </span>OpenCVExtensions
00007 {
00008     <span class="comment">// redo it with templates , for now represents RGB, 3 channel unsigned char image</span>
00009     <span class="keyword">class </span>Image : <span class="keyword">public</span> CObject
00010     {
00011     <span class="keyword">public</span>:
00012         Image(<span class="keywordtype">void</span>);
00013         <span class="keyword">virtual</span> ~Image(<span class="keywordtype">void</span>);
00014         <span class="keyword">static</span> <span class="keywordtype">int</span> getSize(IplImage* im) {
00015             <span class="keywordflow">return</span> im-&gt;imageSize;
00016         };
00017         
00018         <span class="keyword">static</span> <span class="keywordtype">int</span> getSizeInPixels(IplImage* im) {
00019             <span class="keywordflow">return</span> im-&gt;width*im-&gt;height;
00020         };
00021 
00022 <span class="comment">/*</span>
00023 <span class="comment">        static void getPixel(IplImage* im, Pixel* p, int i) {</span>
00024 <span class="comment">            // BUG: widthStep != width .... alignment problem</span>
00025 <span class="comment">            p-&gt;R = im-&gt;imageData[i*3];</span>
00026 <span class="comment">            p-&gt;G = im-&gt;imageData[i*3+1];</span>
00027 <span class="comment">            p-&gt;B = im-&gt;imageData[i*3+2];</span>
00028 <span class="comment">        };</span>
00029 <span class="comment">*/</span>
00030 
00031         <span class="keyword">static</span> <span class="keywordtype">void</span> getPixel(IplImage* im, Pixel* p, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
00032             p-&gt;B = ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3];
00033             p-&gt;G = ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3+1];
00034             p-&gt;R = ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3+2];
00035         };
00036 <span class="comment">/*</span>
00037 <span class="comment">        static void setPixel(IplImage* im, Pixel* p, int i) {</span>
00038 <span class="comment">            // BUG: widthStep != width .... alignment problem</span>
00039 <span class="comment">            im-&gt;imageData[i*3]   = p-&gt;R;</span>
00040 <span class="comment">            im-&gt;imageData[i*3+1] = p-&gt;G;</span>
00041 <span class="comment">            im-&gt;imageData[i*3+2]  = p-&gt;B;</span>
00042 <span class="comment">        };</span>
00043 <span class="comment">*/</span>
00044 
00045         <span class="keyword">static</span> <span class="keywordtype">void</span> setPixel(IplImage* im, Pixel* p, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
00046             ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3] = p-&gt;B;
00047             ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3+1] = p-&gt;G;
00048             ((uchar*)(im-&gt;imageData + im-&gt;widthStep*y))[x*3+2] = p-&gt;R;
00049         };
00050         
00051         <span class="keyword">static</span> <span class="keywordtype">void</span> Highlight(IplImage* im, IplImage* mask, Pixel* high) {
00052             Pixel *p = <span class="keyword">new</span> Pixel();
00053             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;mask-&gt;width; x++)
00054             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;mask-&gt;height; y++)
00055             {
00056                 <span class="keywordflow">if</span> (((uchar*)(mask-&gt;imageData + mask-&gt;widthStep*y))[x] == 1) {
00057                     getPixel(im, p, x, y);
00058                     p-&gt;R = min(255, p-&gt;R + high-&gt;R);
00059                     p-&gt;G = min(255, p-&gt;G + high-&gt;G);
00060                     p-&gt;B = min(255, p-&gt;B + high-&gt;B);
00061                     setPixel(im, p, x, y);
00062                 }
00063             } 
00064             <span class="keyword">delete</span> p;
00065         }
00066     };
00067 
00068 }<span class="comment">// end namespace OpenCVExtensions</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Mon May 15 16:43:42 2006 for NewVision by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
