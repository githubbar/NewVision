<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>New Vision: F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/VisualFx.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>F:/My Documents/Visual Studio 2005/Projects/NewVision/NewVision/VisualFx.cpp</h1><a href="_visual_fx_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*#############################################################################</span>
<a name="l00002"></a>00002 <span class="comment"># VISUALFX.CPP</span>
<a name="l00003"></a>00003 <span class="comment">#</span>
<a name="l00004"></a>00004 <span class="comment"># SCA Software International S.A.</span>
<a name="l00005"></a>00005 <span class="comment"># http://www.scasoftware.com</span>
<a name="l00006"></a>00006 <span class="comment"># scaadmin@scasoftware.com</span>
<a name="l00007"></a>00007 <span class="comment">#</span>
<a name="l00008"></a>00008 <span class="comment"># Copyright (c) 1999 SCA Software International S.A.</span>
<a name="l00009"></a>00009 <span class="comment">#</span>
<a name="l00010"></a>00010 <span class="comment"># Date: 03.01.2000</span>
<a name="l00011"></a>00011 <span class="comment"># Author: Zoran M.Todorovic</span>
<a name="l00012"></a>00012 <span class="comment">#</span>
<a name="l00013"></a>00013 <span class="comment"># This software is provided "AS IS", without a warranty of any kind.</span>
<a name="l00014"></a>00014 <span class="comment"># You are free to use/modify this code but leave this header intact.</span>
<a name="l00015"></a>00015 <span class="comment">#</span>
<a name="l00016"></a>00016 <span class="comment"># Updates:</span>
<a name="l00017"></a>00017 <span class="comment">#</span>
<a name="l00018"></a>00018 <span class="comment"># 14.01.2000 -  Courtesy of Frederic Guillet (www.codeproject.com)</span>
<a name="l00019"></a>00019 <span class="comment">#               Added optional 16x16 icons to tabs</span>
<a name="l00020"></a>00020 <span class="comment">#</span>
<a name="l00021"></a>00021 <span class="comment">#############################################################################*/</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include "<a class="code" href="_std_afx_8h.html">stdafx.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;afxpriv.h&gt;</span>        <span class="comment">// Needed for WM_SIZEPARENT</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="_visual_fx_8h.html">VisualFx.h</a>"</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#undef THIS_FILE</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> THIS_FILE[] = __FILE__;
<a name="l00031"></a>00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#define new DEBUG_NEW</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="comment">//=============================================================================</span>
<a name="l00038"></a>00038 <span class="comment">// class TTabItem</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">//=============================================================================</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="comment">// Create a tab item </span>
<a name="l00043"></a><a class="code" href="class_t_tab_item.html#637d45409fbc92f74dda9e9379930152">00043</a> <a class="code" href="class_t_tab_item.html#637d45409fbc92f74dda9e9379930152">TTabItem::TTabItem</a>(CWnd *pParent, LPCTSTR szLabel, HICON hIcon)
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045   <a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> = NULL;
<a name="l00046"></a>00046   <a class="code" href="class_t_tab_item.html#eb0a5340c3c859355b8eedb9bbac1f7d">m_nMinX</a> = <a class="code" href="class_t_tab_item.html#5dac6bc4976b8cebde52482ebe8164d6">m_nMaxX</a> = 0;
<a name="l00047"></a>00047   <a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a> = TRUE;
<a name="l00048"></a>00048   <a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a> = TRUE;
<a name="l00049"></a>00049   <a class="code" href="class_t_tab_item.html#50069f6f9b7859e659c9017e2b5e0b5d">m_bWndEnabled</a> = TRUE;
<a name="l00050"></a>00050   <a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a> = hIcon;
<a name="l00051"></a>00051   RECT rect;
<a name="l00052"></a>00052   ::ZeroMemory(&amp;rect,<span class="keyword">sizeof</span>(RECT));
<a name="l00053"></a>00053   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a> = <span class="keyword">new</span> CStatic;
<a name="l00054"></a>00054   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00055"></a>00055   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;Create(szLabel, WS_CHILD|SS_CENTER|WS_VISIBLE,rect,pParent);
<a name="l00056"></a>00056 }
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="class_t_tab_item.html#a4518a29fd11d24f8bb343edc8de8e32">00058</a> <a class="code" href="class_t_tab_item.html#637d45409fbc92f74dda9e9379930152">TTabItem::TTabItem</a>(<span class="keyword">const</span> <a class="code" href="class_t_tab_item.html">TTabItem</a>&amp; obj)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   *<span class="keyword">this</span> = obj;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="class_t_tab_item.html#eb60a27fce3ab72051ad69c2627f8dfd">00063</a> <a class="code" href="class_t_tab_item.html">TTabItem</a>&amp; <a class="code" href="class_t_tab_item.html#eb60a27fce3ab72051ad69c2627f8dfd">TTabItem::operator=</a>(<span class="keyword">const</span> <a class="code" href="class_t_tab_item.html">TTabItem</a>&amp; obj)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> = obj.<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>;
<a name="l00066"></a>00066   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a> = obj.<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>;
<a name="l00067"></a>00067   <a class="code" href="class_t_tab_item.html#50069f6f9b7859e659c9017e2b5e0b5d">m_bWndEnabled</a> = obj.<a class="code" href="class_t_tab_item.html#50069f6f9b7859e659c9017e2b5e0b5d">m_bWndEnabled</a>;
<a name="l00068"></a>00068   <a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a> = obj.<a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a>;
<a name="l00069"></a>00069   <a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a> = obj.<a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a>;
<a name="l00070"></a>00070   <a class="code" href="class_t_tab_item.html#eb0a5340c3c859355b8eedb9bbac1f7d">m_nMinX</a> = obj.<a class="code" href="class_t_tab_item.html#eb0a5340c3c859355b8eedb9bbac1f7d">m_nMinX</a>;
<a name="l00071"></a>00071   <a class="code" href="class_t_tab_item.html#5dac6bc4976b8cebde52482ebe8164d6">m_nMaxX</a> = obj.<a class="code" href="class_t_tab_item.html#5dac6bc4976b8cebde52482ebe8164d6">m_nMaxX</a>;
<a name="l00072"></a>00072   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="class_t_tab_item.html#57d29fe3047d890d3a843bfee035a058">00075</a> <a class="code" href="class_t_tab_item.html#57d29fe3047d890d3a843bfee035a058">TTabItem::~TTabItem</a>()
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <span class="comment">// This is done in TVisualFramework::Destroy()</span>
<a name="l00078"></a>00078   <span class="comment">//if (m_pWnd-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)))</span>
<a name="l00079"></a>00079   <span class="comment">//  delete m_pWnd;</span>
<a name="l00080"></a>00080   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00081"></a>00081   <span class="keyword">delete</span> <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>;
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">// Set rectangle for tab caption</span>
<a name="l00085"></a><a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">00085</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">TTabItem::SetRect</a>(CRect&amp; rect)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00088"></a>00088   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;MoveWindow(&amp;rect);
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">// Set font for tab caption</span>
<a name="l00092"></a><a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">00092</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">TTabItem::SetFont</a>(CFont *pFont)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00095"></a>00095   ASSERT(pFont);
<a name="l00096"></a>00096   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;SetFont(pFont,FALSE);
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">// Set icon handle for this tab</span>
<a name="l00100"></a><a class="code" href="class_t_tab_item.html#7c3a7a5f6783b51872e90cfa5174b77e">00100</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#7c3a7a5f6783b51872e90cfa5174b77e">TTabItem::SetIcon</a>(HICON hIcon)
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102   <a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a> = hIcon;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">// Get tab caption text</span>
<a name="l00106"></a><a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">00106</a> CString <a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">TTabItem::GetText</a>(<span class="keywordtype">void</span>)
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00109"></a>00109   CString str;
<a name="l00110"></a>00110   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;GetWindowText(str);
<a name="l00111"></a>00111   <span class="keywordflow">return</span> str;
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="class_t_tab_item.html#c1c44a83facaee2ee4d02ac716a722aa">00114</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_item.html#c1c44a83facaee2ee4d02ac716a722aa">TTabItem::GetLength</a>(<span class="keywordtype">void</span>)
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116   <span class="keywordflow">return</span> <a class="code" href="class_t_tab_item.html#5dac6bc4976b8cebde52482ebe8164d6">m_nMaxX</a> - <a class="code" href="class_t_tab_item.html#eb0a5340c3c859355b8eedb9bbac1f7d">m_nMinX</a>;
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="comment">// Set tab caption text</span>
<a name="l00120"></a><a class="code" href="class_t_tab_item.html#9f9e801481d686e83dcd5eafbd04a126">00120</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#9f9e801481d686e83dcd5eafbd04a126">TTabItem::SetText</a>(LPCTSTR szLabel)
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00123"></a>00123   ASSERT(szLabel);
<a name="l00124"></a>00124   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;SetWindowText(szLabel);
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// Enable/disable a window</span>
<a name="l00128"></a><a class="code" href="class_t_tab_item.html#671fdca85688ee571383ca0e1d33ece6">00128</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#671fdca85688ee571383ca0e1d33ece6">TTabItem::Enable</a>(BOOL bEnable)
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130   <a class="code" href="class_t_tab_item.html#50069f6f9b7859e659c9017e2b5e0b5d">m_bWndEnabled</a> = bEnable;
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="comment">// Enable/disable tab caption</span>
<a name="l00134"></a><a class="code" href="class_t_tab_item.html#b273b883a557e5be8ec6870d9fc9a5cb">00134</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#b273b883a557e5be8ec6870d9fc9a5cb">TTabItem::EnableTab</a>(BOOL bEnable)
<a name="l00135"></a>00135 {
<a name="l00136"></a>00136   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00137"></a>00137   <a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a> = bEnable;
<a name="l00138"></a>00138   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;EnableWindow(<a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a>);
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="comment">// Show/hide tab caption</span>
<a name="l00142"></a><a class="code" href="class_t_tab_item.html#43f7bff5828726752cf2a65ace64793c">00142</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_item.html#43f7bff5828726752cf2a65ace64793c">TTabItem::ShowTab</a>(BOOL bShow)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144   ASSERT(<a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>);
<a name="l00145"></a>00145   <a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a> = bShow;
<a name="l00146"></a>00146   <a class="code" href="class_t_tab_item.html#882c7e0262f0edc59f689b5ace1b8edf">m_pCaption</a>-&gt;ShowWindow(bShow ? SW_SHOW : SW_HIDE);
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="class_t_tab_item.html#bf6d6982c6687228e65accd9141c5eb1">00149</a> CWnd *<a class="code" href="class_t_tab_item.html#bf6d6982c6687228e65accd9141c5eb1">TTabItem::GetSafeWnd</a>(<span class="keywordtype">void</span>)
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151   <span class="keywordflow">return</span> (<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> &amp;&amp; ::IsWindow(<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;m_hWnd)) ? <a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> : NULL;
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">//=============================================================================</span>
<a name="l00155"></a>00155 <span class="comment">// class TTabWnd</span>
<a name="l00156"></a>00156 <span class="comment">//</span>
<a name="l00157"></a>00157 <span class="comment">//=============================================================================</span>
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="_visual_fx_8cpp.html#28a35b3f6cb3902698fdbbb9742e1a98">00159</a> <span class="preprocessor">#define TABWND_DEFAULT_ID 0x2578</span>
<a name="l00160"></a><a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">00160</a> <span class="preprocessor"></span><span class="preprocessor">#define TABWND_HEIGHT     30    // Height of the gray border between the toolbar </span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>                                <span class="comment">// and the client area</span>
<a name="l00162"></a><a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">00162</a> <span class="preprocessor">#define TAB_HEIGHT        20    // Height on the normal tab</span>
<a name="l00163"></a><a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">00163</a> <span class="preprocessor"></span><span class="preprocessor">#define TABSEL_HEIGHT     20    // Height of the selected tab</span>
<a name="l00164"></a><a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">00164</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_SPACE         6     // Add to tab caption text width</span>
<a name="l00165"></a><a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">00165</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_DEPL          4     // Distance between the tabs and the client area</span>
<a name="l00166"></a><a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">00166</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_MAXLEN        200</span>
<a name="l00167"></a><a class="code" href="_visual_fx_8cpp.html#3ed5f7a1f9805b7fbde9f8c2a9cb10be">00167</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_ICON          16</span>
<a name="l00168"></a><a class="code" href="_visual_fx_8cpp.html#55c5be1879f229fc0b73b8986e532265">00168</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_ICON_X        2</span>
<a name="l00169"></a><a class="code" href="_visual_fx_8cpp.html#f5c24c09e9b6051936e42d154b4aae4e">00169</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_ICON_Y        2</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>
<a name="l00171"></a>00171 IMPLEMENT_DYNCREATE(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>,CWnd)
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 BEGIN_MESSAGE_MAP(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>, CWnd)
<a name="l00174"></a>00174   <span class="comment">//{{AFX_MSG_MAP(TTabWnd)</span>
<a name="l00175"></a>00175   ON_MESSAGE(WM_SIZEPARENT, OnSizeParent)
<a name="l00176"></a>00176   ON_WM_ERASEBKGND()
<a name="l00177"></a>00177   ON_WM_PAINT()
<a name="l00178"></a>00178   ON_WM_LBUTTONUP()
<a name="l00179"></a>00179   ON_WM_DESTROY()
<a name="l00180"></a>00180   ON_WM_SIZE()
<a name="l00181"></a>00181         ON_WM_CREATE()
<a name="l00182"></a>00182         <span class="comment">//}}AFX_MSG_MAP</span>
<a name="l00183"></a>00183 END_MESSAGE_MAP()
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="class_t_tab_wnd.html#2afb503ce2063f07a3104786ba35d68d">00185</a> TTabWnd::TTabWnd()
<a name="l00186"></a>00186 {
<a name="l00187"></a>00187   m_nSelectedTab = 0;
<a name="l00188"></a>00188   m_bLockFlag = FALSE;
<a name="l00189"></a>00189   m_nTabPos = TP_BOTTOM;
<a name="l00190"></a>00190   <span class="comment">// cache most used resources</span>
<a name="l00191"></a>00191   m_BrushBlack.CreateSolidBrush(RGB(0,0,0));
<a name="l00192"></a>00192   m_BrushLGray.CreateSolidBrush(::GetSysColor(COLOR_BTNFACE));
<a name="l00193"></a>00193   m_PenBlack.CreatePen(PS_SOLID, 1, (COLORREF)0);
<a name="l00194"></a>00194   m_PenLGray.CreatePen(PS_SOLID, 1, ::GetSysColor(COLOR_BTNFACE));
<a name="l00195"></a>00195   m_PenWhite.CreatePen(PS_SOLID, 1, ::GetSysColor(COLOR_BTNHIGHLIGHT));
<a name="l00196"></a>00196   m_PenWhite2.CreatePen(PS_SOLID, 2, ::GetSysColor(COLOR_BTNHIGHLIGHT));
<a name="l00197"></a>00197   m_PenDGray.CreatePen(PS_SOLID, 1, ::GetSysColor(COLOR_BTNSHADOW));
<a name="l00198"></a>00198   m_PenDGray2.CreatePen(PS_SOLID, 2, ::GetSysColor(COLOR_BTNSHADOW));
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="class_t_tab_wnd.html#cbfe935407ce4beb5f6ded87fc0f0b30">00201</a> <a class="code" href="class_t_tab_wnd.html#cbfe935407ce4beb5f6ded87fc0f0b30">TTabWnd::~TTabWnd</a>()
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="comment">// Find a tab within this tab window</span>
<a name="l00206"></a><a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">00206</a> <a class="code" href="class_t_tab_item.html">TTabItem</a> *<a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">TTabWnd::findTabItem</a>(<span class="keywordtype">int</span> nIndex)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208   <span class="keywordtype">int</span> nNdx = 0;
<a name="l00209"></a>00209   TTabItemList::iterator iterator;
<a name="l00210"></a>00210   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00211"></a>00211     <span class="keywordflow">if</span> (nNdx == nIndex)
<a name="l00212"></a>00212       <span class="keywordflow">return</span> (*iterator);
<a name="l00213"></a>00213     nNdx ++;
<a name="l00214"></a>00214   }
<a name="l00215"></a>00215   <span class="keywordflow">return</span> NULL;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">// Create a tab window</span>
<a name="l00219"></a><a class="code" href="class_t_tab_wnd.html#296555cc1fbe8cd6e6f2df1eb567cf8b">00219</a> BOOL <a class="code" href="class_t_tab_wnd.html#296555cc1fbe8cd6e6f2df1eb567cf8b">TTabWnd::Create</a>(LPCTSTR lpszClassName, LPCTSTR lpszWindowName, 
<a name="l00220"></a>00220                      DWORD dwStyle, <span class="keyword">const</span> RECT&amp; prect, CWnd* pParentWnd, 
<a name="l00221"></a>00221                      UINT nID, CCreateContext *pContext)
<a name="l00222"></a>00222 {
<a name="l00223"></a>00223   ASSERT(pParentWnd);
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   dwStyle &amp;= ~WS_BORDER;
<a name="l00226"></a>00226   CRect rect(prect);
<a name="l00227"></a>00227   <span class="keywordflow">if</span> (!CWnd::Create(NULL, lpszWindowName, dwStyle, rect, pParentWnd, nID, pContext))
<a name="l00228"></a>00228     <span class="keywordflow">return</span> FALSE;
<a name="l00229"></a>00229   <span class="keywordflow">if</span> (pParentWnd-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {
<a name="l00230"></a>00230     ((CFrameWnd*)pParentWnd)-&gt;ModifyStyleEx(WS_EX_CLIENTEDGE,0,SWP_FRAMECHANGED);
<a name="l00231"></a>00231     ((CFrameWnd*)pParentWnd)-&gt;RecalcLayout();
<a name="l00232"></a>00232   }
<a name="l00233"></a>00233   <a class="code" href="class_t_tab_wnd.html#016f6f8f9030f94efeefcfef6d1b6412">ResizeTab</a>();
<a name="l00234"></a>00234   <span class="keywordflow">return</span> TRUE;
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a><a class="code" href="class_t_tab_wnd.html#687a9004cf11bf9d71654ed7d67db49e">00237</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#687a9004cf11bf9d71654ed7d67db49e">TTabWnd::OnCreate</a>(LPCREATESTRUCT lpCreateStruct) 
<a name="l00238"></a>00238 {
<a name="l00239"></a>00239         <span class="keywordflow">if</span> (CWnd::OnCreate(lpCreateStruct) == -1)
<a name="l00240"></a>00240                 <span class="keywordflow">return</span> -1;
<a name="l00241"></a>00241         
<a name="l00242"></a>00242   <a class="code" href="class_t_tab_wnd.html#25d71d1fd22d69c1b504415082e33cef">createFont</a>();
<a name="l00243"></a>00243         <span class="keywordflow">return</span> 0;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="class_t_tab_wnd.html#931a6ebb5f74574941b73bb3c827b8e2">00246</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#931a6ebb5f74574941b73bb3c827b8e2">TTabWnd::OnDestroy</a>() 
<a name="l00247"></a>00247 {
<a name="l00248"></a>00248   CWnd::OnDestroy();
<a name="l00249"></a>00249   TTabItemList::iterator iterator;
<a name="l00250"></a>00250   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator ++) {
<a name="l00251"></a>00251     <span class="keyword">delete</span> (*iterator);
<a name="l00252"></a>00252   }
<a name="l00253"></a>00253   <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.clear();
<a name="l00254"></a>00254   <span class="comment">// This is done in TVisualFramework</span>
<a name="l00255"></a>00255   <span class="comment">//if (GetParent()-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)))</span>
<a name="l00256"></a>00256   <span class="comment">//  delete this;</span>
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="comment">// Virtual function to check whether switch to new tab can be done</span>
<a name="l00260"></a><a class="code" href="class_t_tab_wnd.html#8e10fe897450f3dac07b70edcaf54bf2">00260</a> BOOL <a class="code" href="class_t_tab_wnd.html#8e10fe897450f3dac07b70edcaf54bf2">TTabWnd::CanSetActivePane</a>(CWnd *pOldPane, CWnd *pNewPane)
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262   <span class="keywordflow">return</span> TRUE;
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">// Virtual function (after the switch is done)</span>
<a name="l00266"></a><a class="code" href="class_t_tab_wnd.html#9a7af43c2515ec6d36d9abbf5cba18d2">00266</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#9a7af43c2515ec6d36d9abbf5cba18d2">TTabWnd::OnSetActivePane</a>(CWnd *pOldPane, CWnd *pNewPane)
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="comment">// Create fonts for tab labels</span>
<a name="l00271"></a><a class="code" href="class_t_tab_wnd.html#25d71d1fd22d69c1b504415082e33cef">00271</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#25d71d1fd22d69c1b504415082e33cef">TTabWnd::createFont</a>()
<a name="l00272"></a>00272 {
<a name="l00273"></a>00273         NONCLIENTMETRICS metrics;
<a name="l00274"></a>00274         metrics.cbSize = <span class="keyword">sizeof</span>(metrics);
<a name="l00275"></a>00275   ::SystemParametersInfo(SPI_GETNONCLIENTMETRICS, 0, &amp;metrics, 0);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277   CWindowDC wdc(NULL);
<a name="l00278"></a>00278   <span class="keywordtype">int</span> nLPixY = GetDeviceCaps(wdc.m_hDC, LOGPIXELSY);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>.CreateFontIndirect(&amp;metrics.lfStatusFont);
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">// Add a tab to this window</span>
<a name="l00284"></a><a class="code" href="class_t_tab_wnd.html#b44d4eeaf7b0475dc747ab980399cafa">00284</a> <a class="code" href="class_t_tab_item.html">TTabItem</a> *<a class="code" href="class_t_tab_wnd.html#b44d4eeaf7b0475dc747ab980399cafa">TTabWnd::addTab</a>(CWnd *pWnd, LPCTSTR szLabel)
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286   ASSERT(pWnd);
<a name="l00287"></a>00287   ASSERT(szLabel);
<a name="l00288"></a>00288 
<a name="l00289"></a>00289   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <span class="keyword">new</span> <a class="code" href="class_t_tab_item.html">TTabItem</a>(<span class="keyword">this</span>,szLabel);
<a name="l00290"></a>00290   pItem-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> = pWnd;
<a name="l00291"></a>00291   <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.insert(<a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(), pItem);
<a name="l00292"></a>00292   <span class="keywordflow">return</span> pItem;
<a name="l00293"></a>00293 }
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="class_t_tab_wnd.html#e7cd99d6d1ff5e1cad3cc55482d9a3ae">00295</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#e7cd99d6d1ff5e1cad3cc55482d9a3ae">TTabWnd::GetTabLength</a>()
<a name="l00296"></a>00296 {
<a name="l00297"></a>00297   <span class="keywordtype">int</span> nLength = 0;
<a name="l00298"></a>00298   TTabItemList::iterator iterator;
<a name="l00299"></a>00299   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00300"></a>00300     nLength += (*iterator)-&gt;GetLength();
<a name="l00301"></a>00301   }
<a name="l00302"></a>00302   <span class="keywordflow">return</span> nLength;
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="comment">// Get index of currently selected tab</span>
<a name="l00306"></a><a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">00306</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">TTabWnd::GetTabIndex</a>(<span class="keywordtype">void</span>)
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308   <span class="keywordflow">return</span> <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>;
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">// Get number of tabs</span>
<a name="l00312"></a><a class="code" href="class_t_tab_wnd.html#a76c6ab8bb1e9550c9dea89decf4b1eb">00312</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#a76c6ab8bb1e9550c9dea89decf4b1eb">TTabWnd::GetTabCount</a>(<span class="keywordtype">void</span>)
<a name="l00313"></a>00313 {
<a name="l00314"></a>00314   <span class="keywordflow">return</span> <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.size();
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 <span class="comment">// Get index of the tab associated with specified window</span>
<a name="l00318"></a><a class="code" href="class_t_tab_wnd.html#5f4e8d1ae724a47f7e2e3374a4c03e55">00318</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">TTabWnd::GetTabIndex</a>(CWnd *pWnd)
<a name="l00319"></a>00319 {
<a name="l00320"></a>00320   ASSERT(pWnd);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   <span class="keywordtype">int</span> nIndex = 0;
<a name="l00323"></a>00323   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem;
<a name="l00324"></a>00324   TTabItemList::iterator iterator;
<a name="l00325"></a>00325   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00326"></a>00326     pItem = *iterator;
<a name="l00327"></a>00327     <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> == pWnd)
<a name="l00328"></a>00328       <span class="keywordflow">return</span> nIndex;
<a name="l00329"></a>00329     nIndex ++;
<a name="l00330"></a>00330   }
<a name="l00331"></a>00331   <span class="keywordflow">return</span> -1;
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="comment">// Get pointer to window associated with the specified tab index</span>
<a name="l00335"></a><a class="code" href="class_t_tab_wnd.html#6830af4f41f92b986b9b8bc9cc616637">00335</a> CWnd *<a class="code" href="class_t_tab_wnd.html#6830af4f41f92b986b9b8bc9cc616637">TTabWnd::GetTabWnd</a>(<span class="keywordtype">int</span> index)
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(index);
<a name="l00338"></a>00338   ASSERT(pItem);
<a name="l00339"></a>00339   return ::IsWindow(pItem-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;m_hWnd) ? pItem-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> : NULL;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">// Get tab caption text of the specified tab</span>
<a name="l00343"></a><a class="code" href="class_t_tab_wnd.html#e671a80fba7d324a1a7ccc5cc6e2c624">00343</a> CString <a class="code" href="class_t_tab_wnd.html#e671a80fba7d324a1a7ccc5cc6e2c624">TTabWnd::GetTabLabel</a>(<span class="keywordtype">int</span> nIndex)
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00346"></a>00346   ASSERT(pItem);
<a name="l00347"></a>00347   <span class="keywordflow">return</span> pItem-&gt;<a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">GetText</a>();
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">// Set text of tab caption</span>
<a name="l00351"></a><a class="code" href="class_t_tab_wnd.html#92253f49db65a9a1df10fe9380c1814d">00351</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#92253f49db65a9a1df10fe9380c1814d">TTabWnd::SetTabLabel</a>(<span class="keywordtype">int</span> nIndex, LPCTSTR szLabel)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353   ASSERT(szLabel);
<a name="l00354"></a>00354   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00355"></a>00355   ASSERT(pItem);
<a name="l00356"></a>00356   pItem-&gt;<a class="code" href="class_t_tab_item.html#9f9e801481d686e83dcd5eafbd04a126">SetText</a>(szLabel);
<a name="l00357"></a>00357   <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">invalidateTabArea</a>();
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="comment">// Enable/disable a view</span>
<a name="l00361"></a><a class="code" href="class_t_tab_wnd.html#f945e4087b0430208d8e070276f5e997">00361</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#f945e4087b0430208d8e070276f5e997">TTabWnd::Enable</a>(<span class="keywordtype">int</span> nIndex, BOOL bEnable)
<a name="l00362"></a>00362 {
<a name="l00363"></a>00363   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00364"></a>00364   ASSERT(pItem);
<a name="l00365"></a>00365   pItem-&gt;<a class="code" href="class_t_tab_item.html#671fdca85688ee571383ca0e1d33ece6">Enable</a>(bEnable);
<a name="l00366"></a>00366   <span class="comment">//pItem-&gt;m_pWnd-&gt;EnableWindow(bEnable);</span>
<a name="l00367"></a>00367 }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 <span class="comment">// Cannot disable currently selected tab</span>
<a name="l00370"></a><a class="code" href="class_t_tab_wnd.html#e04c02a365d6e0f3b73c9f9ee5ff6b70">00370</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#e04c02a365d6e0f3b73c9f9ee5ff6b70">TTabWnd::EnableTab</a>(<span class="keywordtype">int</span> nIndex, BOOL bEnable)
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372   ASSERT(nIndex != <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>);
<a name="l00373"></a>00373   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00374"></a>00374   ASSERT(pItem);
<a name="l00375"></a>00375   pItem-&gt;<a class="code" href="class_t_tab_item.html#b273b883a557e5be8ec6870d9fc9a5cb">EnableTab</a>(bEnable);
<a name="l00376"></a>00376   <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">invalidateTabArea</a>();
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="comment">// Cannot make invisible currently selected tab</span>
<a name="l00380"></a><a class="code" href="class_t_tab_wnd.html#f1988ca189d57fcdbc4db80047e558a5">00380</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#f1988ca189d57fcdbc4db80047e558a5">TTabWnd::ShowTab</a>(<span class="keywordtype">int</span> nIndex, BOOL bShow)
<a name="l00381"></a>00381 {
<a name="l00382"></a>00382   ASSERT(nIndex != <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>);
<a name="l00383"></a>00383   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00384"></a>00384   ASSERT(pItem);
<a name="l00385"></a>00385   pItem-&gt;<a class="code" href="class_t_tab_item.html#43f7bff5828726752cf2a65ace64793c">ShowTab</a>(bShow);
<a name="l00386"></a>00386   <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">invalidateTabArea</a>();
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="comment">// Is tab enabled</span>
<a name="l00390"></a><a class="code" href="class_t_tab_wnd.html#49ee50f023e5a1d6331ff91d58d0d6cd">00390</a> BOOL <a class="code" href="class_t_tab_wnd.html#49ee50f023e5a1d6331ff91d58d0d6cd">TTabWnd::IsTabEnabled</a>(<span class="keywordtype">int</span> nIndex)
<a name="l00391"></a>00391 {
<a name="l00392"></a>00392   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00393"></a>00393   ASSERT(pItem);
<a name="l00394"></a>00394   <span class="keywordflow">return</span> pItem-&gt;<a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a>;
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">// Is tab visible</span>
<a name="l00398"></a><a class="code" href="class_t_tab_wnd.html#4341bb62d68b1f05149ef444cc50c775">00398</a> BOOL <a class="code" href="class_t_tab_wnd.html#4341bb62d68b1f05149ef444cc50c775">TTabWnd::IsTabVisible</a>(<span class="keywordtype">int</span> nIndex)
<a name="l00399"></a>00399 {
<a name="l00400"></a>00400   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00401"></a>00401   ASSERT(pItem);
<a name="l00402"></a>00402   <span class="keywordflow">return</span> pItem-&gt;<a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a>;
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="comment">// Set font</span>
<a name="l00406"></a><a class="code" href="class_t_tab_wnd.html#1be825d9dd781adfb55f4bb83f944139">00406</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#1be825d9dd781adfb55f4bb83f944139">TTabWnd::SetFont</a>(CFont *pFont)
<a name="l00407"></a>00407 {
<a name="l00408"></a>00408   ASSERT(pFont);
<a name="l00409"></a>00409   CWnd::SetFont(pFont);
<a name="l00410"></a>00410   <a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>.DeleteObject();
<a name="l00411"></a>00411   LOGFONT lf;
<a name="l00412"></a>00412   pFont-&gt;GetLogFont(&amp;lf);
<a name="l00413"></a>00413   <a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>.CreateFontIndirect(&amp;lf);
<a name="l00414"></a>00414   <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">invalidateTabArea</a>();
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="comment">// Set position of tabs (top or bottom)</span>
<a name="l00418"></a><a class="code" href="class_t_tab_wnd.html#927fa6c582046a79b476ad6195a8a199">00418</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#927fa6c582046a79b476ad6195a8a199">TTabWnd::SetTabPos</a>(<a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83">TTabPos</a> nTabPos)
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420   <a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a> = nTabPos;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">// Invalidate rectangle to redraw tabs</span>
<a name="l00424"></a><a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">00424</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">TTabWnd::invalidateTabArea</a>(<span class="keywordtype">void</span>)
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426   CRect rect;
<a name="l00427"></a>00427   <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00428"></a>00428   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>: 
<a name="l00429"></a>00429     InvalidateRect(&amp;CRect(0, 0, 32000, <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>)); 
<a name="l00430"></a>00430     <span class="keywordflow">break</span>;
<a name="l00431"></a>00431   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00432"></a>00432     GetClientRect(&amp;rect);
<a name="l00433"></a>00433     InvalidateRect(&amp;CRect(CPoint(0,rect.Height()-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>), 
<a name="l00434"></a>00434                           CSize(32000,<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>)));
<a name="l00435"></a>00435     <span class="keywordflow">break</span>;
<a name="l00436"></a>00436   };
<a name="l00437"></a>00437 }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 <span class="comment">// Draws a selected tab and returns its height</span>
<a name="l00440"></a><a class="code" href="class_t_tab_wnd.html#0999afc88f2c0d27e1fe5af97bf3a045">00440</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#0999afc88f2c0d27e1fe5af97bf3a045">TTabWnd::drawSelTabTop</a>(CDC *pDC, <span class="keywordtype">int</span> x, CRect&amp; client, <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem)
<a name="l00441"></a>00441 {
<a name="l00442"></a>00442   ASSERT(pItem);
<a name="l00443"></a>00443   ASSERT(pDC);
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   CString str = pItem-&gt;<a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">GetText</a>();
<a name="l00446"></a>00446   CSize textSize = pDC-&gt;GetTextExtent(str);
<a name="l00447"></a>00447   textSize.cx += 4;
<a name="l00448"></a>00448   <span class="keywordflow">if</span> (textSize.cx &gt; <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>)
<a name="l00449"></a>00449     textSize.cx = <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="keywordtype">int</span> y = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> - <a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a> - <a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">TAB_DEPL</a>;
<a name="l00452"></a>00452   <span class="keywordtype">int</span> nDeltaWidth = 0;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00455"></a>00455     nDeltaWidth = <a class="code" href="_visual_fx_8cpp.html#3ed5f7a1f9805b7fbde9f8c2a9cb10be">TAB_ICON</a> + <a class="code" href="_visual_fx_8cpp.html#55c5be1879f229fc0b73b8986e532265">TAB_ICON_X</a>;
<a name="l00456"></a>00456     textSize.cx += nDeltaWidth;
<a name="l00457"></a>00457   }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <span class="comment">// black border, no bottom line</span>
<a name="l00460"></a>00460   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#e7d93dd417042b0a2777550b15acd2bb">m_PenBlack</a>);
<a name="l00461"></a>00461   pDC-&gt;MoveTo(x,y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00462"></a>00462   pDC-&gt;LineTo(x,y);
<a name="l00463"></a>00463   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-1, y);
<a name="l00464"></a>00464   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-1, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>);
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <span class="comment">// left and upper border in white, double line</span>
<a name="l00467"></a>00467   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#a75540da3e3c867ba2d96dba26115cdc">m_PenWhite2</a>);
<a name="l00468"></a>00468   pDC-&gt;MoveTo(x+2,y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00469"></a>00469   pDC-&gt;LineTo(x+2,y+2);
<a name="l00470"></a>00470   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-4, y+2);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   <span class="comment">// right border, dark gray, double line</span>
<a name="l00473"></a>00473   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#182f4428d37b9ab7f0dbde7af47619b9">m_PenDGray2</a>);
<a name="l00474"></a>00474   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+2);
<a name="l00475"></a>00475   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="comment">// clean up</span>
<a name="l00478"></a>00478   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#c707b252ab341d9c70f063f33921650e">m_PenLGray</a>);
<a name="l00479"></a>00479   pDC-&gt;MoveTo(x-1, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>);
<a name="l00480"></a>00480   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>);
<a name="l00481"></a>00481   pDC-&gt;MoveTo(x-1, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00482"></a>00482   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="comment">// a black line to far left and right</span>
<a name="l00485"></a>00485   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#e7d93dd417042b0a2777550b15acd2bb">m_PenBlack</a>);
<a name="l00486"></a>00486   pDC-&gt;MoveTo(0, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00487"></a>00487   pDC-&gt;LineTo(x, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00488"></a>00488   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>+1, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00489"></a>00489   pDC-&gt;LineTo(client.right, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00490"></a>00490 
<a name="l00491"></a>00491   <span class="comment">// and a white double line</span>
<a name="l00492"></a>00492   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#a75540da3e3c867ba2d96dba26115cdc">m_PenWhite2</a>);
<a name="l00493"></a>00493   <span class="keywordflow">if</span> (x!=0) {
<a name="l00494"></a>00494     pDC-&gt;MoveTo(0, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00495"></a>00495     pDC-&gt;LineTo(x, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00498"></a>00498   pDC-&gt;LineTo(client.right, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>+1);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <span class="comment">// gray inside</span>
<a name="l00501"></a>00501   pDC-&gt;FillSolidRect(x+3, y+3,textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-6, <a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>, 
<a name="l00502"></a>00502                   ::GetSysColor(COLOR_BTNFACE));
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00505"></a>00505     ::DrawIconEx(pDC-&gt;m_hDC,x+4,y+<a class="code" href="_visual_fx_8cpp.html#f5c24c09e9b6051936e42d154b4aae4e">TAB_ICON_Y</a>,pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>,16,16,0,NULL,DI_NORMAL);
<a name="l00506"></a>00506   }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   CRect rect(CPoint(x+nDeltaWidth+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>/2, y+(<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-textSize.cy)/2+1), 
<a name="l00509"></a>00509              CSize(textSize.cx-nDeltaWidth, textSize.cy));
<a name="l00510"></a>00510   pItem-&gt;<a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">SetFont</a>(&amp;<a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>);
<a name="l00511"></a>00511   pItem-&gt;<a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">SetRect</a>(rect);
<a name="l00512"></a>00512   
<a name="l00513"></a>00513   <span class="keywordflow">return</span> textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 <span class="comment">// Draw a selected tab at the bottom</span>
<a name="l00517"></a><a class="code" href="class_t_tab_wnd.html#3734d9e5077c1f8fd418199793df9d22">00517</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#3734d9e5077c1f8fd418199793df9d22">TTabWnd::drawSelTabBottom</a>(CDC *pDC, <span class="keywordtype">int</span> x, CRect&amp; client, <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem)
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519   ASSERT(pItem);
<a name="l00520"></a>00520   ASSERT(pDC);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522   CString str = pItem-&gt;<a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">GetText</a>();
<a name="l00523"></a>00523   CSize textSize = pDC-&gt;GetTextExtent(str);
<a name="l00524"></a>00524   textSize.cx += 4;
<a name="l00525"></a>00525   <span class="keywordflow">if</span> (textSize.cx &gt; <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>)
<a name="l00526"></a>00526     textSize.cx = <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="keywordtype">int</span> y = client.Height() - <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> + <a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">TAB_DEPL</a>;
<a name="l00529"></a>00529   <span class="keywordtype">int</span> nDeltaWidth = 0;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00532"></a>00532     nDeltaWidth = <a class="code" href="_visual_fx_8cpp.html#3ed5f7a1f9805b7fbde9f8c2a9cb10be">TAB_ICON</a> + <a class="code" href="_visual_fx_8cpp.html#55c5be1879f229fc0b73b8986e532265">TAB_ICON_X</a>;
<a name="l00533"></a>00533     textSize.cx += nDeltaWidth;
<a name="l00534"></a>00534   }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536   <span class="comment">// black border, no bottom line</span>
<a name="l00537"></a>00537   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#e7d93dd417042b0a2777550b15acd2bb">m_PenBlack</a>);
<a name="l00538"></a>00538   pDC-&gt;MoveTo(x,y);
<a name="l00539"></a>00539   pDC-&gt;LineTo(x,y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>);
<a name="l00540"></a>00540   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-1, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>);
<a name="l00541"></a>00541   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-1, y);
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="comment">// left border in white, double line</span>
<a name="l00544"></a>00544   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#a75540da3e3c867ba2d96dba26115cdc">m_PenWhite2</a>);
<a name="l00545"></a>00545   pDC-&gt;MoveTo(x+2,y);
<a name="l00546"></a>00546   pDC-&gt;LineTo(x+2,y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="comment">// right and bottom border, dark gray, double line</span>
<a name="l00549"></a>00549   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#182f4428d37b9ab7f0dbde7af47619b9">m_PenDGray2</a>);
<a name="l00550"></a>00550   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-4, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00551"></a>00551   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y);
<a name="l00552"></a>00552   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+<a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-1);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554   <span class="comment">// a black line to far left and right</span>
<a name="l00555"></a>00555   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#e7d93dd417042b0a2777550b15acd2bb">m_PenBlack</a>);
<a name="l00556"></a>00556   pDC-&gt;MoveTo(0, y);
<a name="l00557"></a>00557   pDC-&gt;LineTo(x, y);
<a name="l00558"></a>00558   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, y);
<a name="l00559"></a>00559   pDC-&gt;LineTo(client.right, y);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561   <span class="comment">// and a gray line to far left and right</span>
<a name="l00562"></a>00562   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#3b52fa64056f975c3b4acb3667b420ef">m_PenDGray</a>);
<a name="l00563"></a>00563   <span class="keywordflow">if</span> (x != 0) {
<a name="l00564"></a>00564     pDC-&gt;MoveTo(0, y-1);
<a name="l00565"></a>00565     pDC-&gt;LineTo(x, y-1);
<a name="l00566"></a>00566   }
<a name="l00567"></a>00567   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y-1);
<a name="l00568"></a>00568   pDC-&gt;LineTo(client.right, y-1);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570   <span class="comment">// gray inside</span>
<a name="l00571"></a>00571   pDC-&gt;FillSolidRect(x+3,y,textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-6, <a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-2, 
<a name="l00572"></a>00572                     ::GetSysColor(COLOR_BTNFACE));
<a name="l00573"></a>00573 
<a name="l00574"></a>00574   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00575"></a>00575     ::DrawIconEx(pDC-&gt;m_hDC,x+4,y+<a class="code" href="_visual_fx_8cpp.html#f5c24c09e9b6051936e42d154b4aae4e">TAB_ICON_Y</a>,pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>,16,16,0,NULL,DI_NORMAL);
<a name="l00576"></a>00576   }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578   CRect rect(CPoint(x+nDeltaWidth+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>/2, y+(<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-textSize.cy)/2+1), 
<a name="l00579"></a>00579              CSize(textSize.cx-nDeltaWidth, textSize.cy));
<a name="l00580"></a>00580   pItem-&gt;<a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">SetFont</a>(&amp;<a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>);
<a name="l00581"></a>00581   pItem-&gt;<a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">SetRect</a>(rect);
<a name="l00582"></a>00582   
<a name="l00583"></a>00583   <span class="keywordflow">return</span> textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>;
<a name="l00584"></a>00584 }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="comment">// Draws an unselected tab and returs its height</span>
<a name="l00587"></a><a class="code" href="class_t_tab_wnd.html#9e7d58ddaca980239a0729207e54c964">00587</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#9e7d58ddaca980239a0729207e54c964">TTabWnd::drawTabTop</a>(CDC *pDC, <span class="keywordtype">int</span> x, CRect&amp; client, <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem)
<a name="l00588"></a>00588 {
<a name="l00589"></a>00589   ASSERT(pItem);
<a name="l00590"></a>00590   ASSERT(pDC);
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   CString str = pItem-&gt;<a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">GetText</a>();
<a name="l00593"></a>00593   CSize textSize = pDC-&gt;GetTextExtent(str);
<a name="l00594"></a>00594   textSize.cx += 4;
<a name="l00595"></a>00595   <span class="keywordflow">if</span> (textSize.cx &gt; <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>)
<a name="l00596"></a>00596     textSize.cx = <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>;
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="keywordtype">int</span> y = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-<a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">TAB_DEPL</a>;
<a name="l00599"></a>00599   <span class="keywordtype">int</span> nDeltaWidth = 0;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00602"></a>00602     nDeltaWidth = <a class="code" href="_visual_fx_8cpp.html#3ed5f7a1f9805b7fbde9f8c2a9cb10be">TAB_ICON</a> + <a class="code" href="_visual_fx_8cpp.html#55c5be1879f229fc0b73b8986e532265">TAB_ICON_X</a>;
<a name="l00603"></a>00603     textSize.cx += nDeltaWidth;
<a name="l00604"></a>00604   }
<a name="l00605"></a>00605   
<a name="l00606"></a>00606   <span class="comment">// black border</span>
<a name="l00607"></a>00607   pDC-&gt;FrameRect(&amp;CRect(CPoint(x,y), CSize(textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>)), 
<a name="l00608"></a>00608                   &amp;<a class="code" href="class_t_tab_wnd.html#23fd170e9fe6eb4708e2d09cb4a9833d">m_BrushBlack</a>);
<a name="l00609"></a>00609 
<a name="l00610"></a>00610   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#77d540aa1c8c8bd4619a4f3a9f4df6c0">m_PenWhite</a>);
<a name="l00611"></a>00611   pDC-&gt;MoveTo(x+1, y+1);
<a name="l00612"></a>00612   pDC-&gt;LineTo(x+1, y+<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-1);
<a name="l00613"></a>00613   pDC-&gt;MoveTo(x+1, y+1);
<a name="l00614"></a>00614   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+1);
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#3b52fa64056f975c3b4acb3667b420ef">m_PenDGray</a>);
<a name="l00617"></a>00617   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+1);
<a name="l00618"></a>00618   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-1);
<a name="l00619"></a>00619 
<a name="l00620"></a>00620   pDC-&gt;FillRect(&amp;CRect(CPoint(x+2,y+2), CSize(textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-4, <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-3)), 
<a name="l00621"></a>00621                 &amp;<a class="code" href="class_t_tab_wnd.html#22fa47975020935d259649c64a9c121c">m_BrushLGray</a>);
<a name="l00622"></a>00622 
<a name="l00623"></a>00623   <span class="comment">// clean up</span>
<a name="l00624"></a>00624   <span class="keywordtype">int</span> dy = <a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a>-<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>;
<a name="l00625"></a>00625   pDC-&gt;FillSolidRect(x, y-dy, textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, dy, GetSysColor(COLOR_BTNFACE));
<a name="l00626"></a>00626 
<a name="l00627"></a>00627   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00628"></a>00628     ::DrawIconEx(pDC-&gt;m_hDC,x+4,y+<a class="code" href="_visual_fx_8cpp.html#f5c24c09e9b6051936e42d154b4aae4e">TAB_ICON_Y</a>,pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>,16,16,0,NULL,DI_NORMAL);
<a name="l00629"></a>00629   }
<a name="l00630"></a>00630 
<a name="l00631"></a>00631   CRect rect(CPoint(x+nDeltaWidth+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>/2, y+(TAB_HEIGHT-textSize.cy)/2+1), 
<a name="l00632"></a>00632              CSize(textSize.cx-nDeltaWidth, textSize.cy));
<a name="l00633"></a>00633   pItem-&gt;<a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">SetFont</a>(&amp;<a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>);
<a name="l00634"></a>00634   pItem-&gt;<a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">SetRect</a>(rect);
<a name="l00635"></a>00635   
<a name="l00636"></a>00636   <span class="keywordflow">return</span> textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 <span class="comment">// Draw an unselected tab at the bottom</span>
<a name="l00640"></a><a class="code" href="class_t_tab_wnd.html#07278a2cc8dbb8509019e4c2cae2796f">00640</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#07278a2cc8dbb8509019e4c2cae2796f">TTabWnd::drawTabBottom</a>(CDC *pDC, <span class="keywordtype">int</span> x, CRect&amp; client, <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem)
<a name="l00641"></a>00641 {
<a name="l00642"></a>00642   ASSERT(pItem);
<a name="l00643"></a>00643   ASSERT(pDC);
<a name="l00644"></a>00644 
<a name="l00645"></a>00645   CString str = pItem-&gt;<a class="code" href="class_t_tab_item.html#aee4cdb507ec809546588bea0ea77bdc">GetText</a>();
<a name="l00646"></a>00646   CSize textSize = pDC-&gt;GetTextExtent(str);
<a name="l00647"></a>00647   textSize.cx += 4;
<a name="l00648"></a>00648   <span class="keywordflow">if</span> (textSize.cx &gt; <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>)
<a name="l00649"></a>00649     textSize.cx = <a class="code" href="_visual_fx_8cpp.html#33f0cce96eb0dca68b6862d4401d0fbf">TAB_MAXLEN</a>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="keywordtype">int</span> y = client.Height() - <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> + <a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">TAB_DEPL</a>;
<a name="l00652"></a>00652   <span class="keywordtype">int</span> nDeltaWidth = 0;
<a name="l00653"></a>00653 
<a name="l00654"></a>00654   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00655"></a>00655     nDeltaWidth = <a class="code" href="_visual_fx_8cpp.html#3ed5f7a1f9805b7fbde9f8c2a9cb10be">TAB_ICON</a> + <a class="code" href="_visual_fx_8cpp.html#55c5be1879f229fc0b73b8986e532265">TAB_ICON_X</a>;
<a name="l00656"></a>00656     textSize.cx += nDeltaWidth;
<a name="l00657"></a>00657   }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   <span class="comment">// black border</span>
<a name="l00660"></a>00660   pDC-&gt;FrameRect(&amp;CRect(CPoint(x,y), CSize(textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>, <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>+1)), 
<a name="l00661"></a>00661                   &amp;<a class="code" href="class_t_tab_wnd.html#23fd170e9fe6eb4708e2d09cb4a9833d">m_BrushBlack</a>);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <span class="comment">// Gray border bottom and right side</span>
<a name="l00664"></a>00664   pDC-&gt;SelectObject(&amp;<a class="code" href="class_t_tab_wnd.html#3b52fa64056f975c3b4acb3667b420ef">m_PenDGray</a>);
<a name="l00665"></a>00665   pDC-&gt;MoveTo(x+1, y+<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-1);
<a name="l00666"></a>00666   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-1);
<a name="l00667"></a>00667   pDC-&gt;MoveTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y);
<a name="l00668"></a>00668   pDC-&gt;LineTo(x+textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-2, y+<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-1);
<a name="l00669"></a>00669 
<a name="l00670"></a>00670   pDC-&gt;FillRect(&amp;CRect(CPoint(x+1,y+1), CSize(textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>-4, <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-3)), 
<a name="l00671"></a>00671                 &amp;<a class="code" href="class_t_tab_wnd.html#22fa47975020935d259649c64a9c121c">m_BrushLGray</a>);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>) {
<a name="l00674"></a>00674     ::DrawIconEx(pDC-&gt;m_hDC,x+4,y+<a class="code" href="_visual_fx_8cpp.html#f5c24c09e9b6051936e42d154b4aae4e">TAB_ICON_Y</a>,pItem-&gt;<a class="code" href="class_t_tab_item.html#71605a851094da91b40152f3d9e2dfcf">m_hIcon</a>,16,16,0,NULL,DI_NORMAL);
<a name="l00675"></a>00675   }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677   CRect rect(CPoint(x+nDeltaWidth+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>/2, y+(<a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>-textSize.cy)/2+1), 
<a name="l00678"></a>00678              CSize(textSize.cx-nDeltaWidth, textSize.cy));
<a name="l00679"></a>00679   pItem-&gt;<a class="code" href="class_t_tab_item.html#a059f2d45e059b97d3b396d1ecb45b04">SetFont</a>(&amp;<a class="code" href="class_t_tab_wnd.html#56b9de8f5f221d65580a682e9d14725e">m_Font</a>);
<a name="l00680"></a>00680   pItem-&gt;<a class="code" href="class_t_tab_item.html#2fb80c8918ed4ffe16fce9db167e9c5f">SetRect</a>(rect);
<a name="l00681"></a>00681   
<a name="l00682"></a>00682   <span class="keywordflow">return</span> textSize.cx+<a class="code" href="_visual_fx_8cpp.html#5f4f10c181ca7a50679b56d53890bfda">TAB_SPACE</a>;
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="comment">// Draw edge arround client area</span>
<a name="l00686"></a><a class="code" href="class_t_tab_wnd.html#75a4237a440243522f9a37da93f52e84">00686</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#75a4237a440243522f9a37da93f52e84">TTabWnd::drawClient</a>(CDC *pDc, CRect&amp; rect)
<a name="l00687"></a>00687 {
<a name="l00688"></a>00688   ASSERT(pDc);
<a name="l00689"></a>00689 
<a name="l00690"></a>00690   CWnd *pParent = GetParent();
<a name="l00691"></a>00691   ASSERT(pParent);
<a name="l00692"></a>00692   <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00693"></a>00693   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>:
<a name="l00694"></a>00694     <span class="keywordflow">if</span> (pParent-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {
<a name="l00695"></a>00695       pDc-&gt;DrawEdge(&amp;rect, EDGE_ETCHED, BF_TOP);
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697     pDc-&gt;Draw3dRect(0,<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>, rect.right, rect.bottom-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>,
<a name="l00698"></a>00698                    ::GetSysColor(COLOR_BTNSHADOW), ::GetSysColor(COLOR_BTNHIGHLIGHT));
<a name="l00699"></a>00699     pDc-&gt;Draw3dRect(1,<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>+1, rect.right-2, rect.bottom-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-2,
<a name="l00700"></a>00700                     0, ::GetSysColor(COLOR_3DLIGHT));
<a name="l00701"></a>00701     <span class="keywordflow">break</span>;
<a name="l00702"></a>00702   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (pParent-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {
<a name="l00704"></a>00704       pDc-&gt;DrawEdge(&amp;rect, EDGE_ETCHED, BF_BOTTOM);
<a name="l00705"></a>00705     }
<a name="l00706"></a>00706     pDc-&gt;Draw3dRect(0,0, rect.right, rect.bottom-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>+1,
<a name="l00707"></a>00707                    ::GetSysColor(COLOR_BTNSHADOW), ::GetSysColor(COLOR_BTNHIGHLIGHT));
<a name="l00708"></a>00708     pDc-&gt;Draw3dRect(1,1, rect.right-2, rect.bottom-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-1,
<a name="l00709"></a>00709                     0, ::GetSysColor(COLOR_3DLIGHT));
<a name="l00710"></a>00710     <span class="keywordflow">break</span>;
<a name="l00711"></a>00711   }
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a><a class="code" href="class_t_tab_wnd.html#642072617fd4b4b6cf349194c71c71b0">00714</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#642072617fd4b4b6cf349194c71c71b0">TTabWnd::OnPaint</a>()
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716   CPaintDC dc(<span class="keyword">this</span>); <span class="comment">// device context for painting</span>
<a name="l00717"></a>00717   CRect client;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719   GetClientRect(&amp;client);
<a name="l00720"></a>00720   <a class="code" href="class_t_tab_wnd.html#75a4237a440243522f9a37da93f52e84">drawClient</a>(&amp;dc, client);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722   <span class="keywordtype">int</span> x = 0, nIndex = 0;
<a name="l00723"></a>00723   TTabItemList::iterator iterator;
<a name="l00724"></a>00724   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00725"></a>00725     <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = *iterator;
<a name="l00726"></a>00726     ASSERT(pItem != NULL);
<a name="l00727"></a>00727     <span class="keywordflow">if</span> (pItem-&gt;m_bVisible) {
<a name="l00728"></a>00728       pItem-&gt;m_nMinX = x;
<a name="l00729"></a>00729       <span class="keywordflow">if</span> (nIndex != <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>) {
<a name="l00730"></a>00730         <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00731"></a>00731         <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>: x += <a class="code" href="class_t_tab_wnd.html#9e7d58ddaca980239a0729207e54c964">drawTabTop</a>(&amp;dc, x, client, pItem); <span class="keywordflow">break</span>;
<a name="l00732"></a>00732         <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>: x += <a class="code" href="class_t_tab_wnd.html#07278a2cc8dbb8509019e4c2cae2796f">drawTabBottom</a>(&amp;dc, x, client, pItem); <span class="keywordflow">break</span>;
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734       } <span class="keywordflow">else</span> {
<a name="l00735"></a>00735         <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00736"></a>00736         <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>: x += <a class="code" href="class_t_tab_wnd.html#0999afc88f2c0d27e1fe5af97bf3a045">drawSelTabTop</a>(&amp;dc, x, client, pItem); <span class="keywordflow">break</span>;
<a name="l00737"></a>00737         <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>: x += <a class="code" href="class_t_tab_wnd.html#3734d9e5077c1f8fd418199793df9d22">drawSelTabBottom</a>(&amp;dc, x, client, pItem); <span class="keywordflow">break</span>;
<a name="l00738"></a>00738         }
<a name="l00739"></a>00739       }
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741     pItem-&gt;m_nMaxX = x;
<a name="l00742"></a>00742     nIndex ++;
<a name="l00743"></a>00743   }
<a name="l00744"></a>00744 }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746 <span class="comment">// Returns tab index that holds specified point</span>
<a name="l00747"></a><a class="code" href="class_t_tab_wnd.html#f1e3661a2527cbbc28ca552b0db52b77">00747</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#7e1415f46315d31b9a51b38861f4f154">TTabWnd::HitTest</a>(CPoint&amp; point)
<a name="l00748"></a>00748 {
<a name="l00749"></a>00749   <span class="keywordflow">return</span> <a class="code" href="class_t_tab_wnd.html#7e1415f46315d31b9a51b38861f4f154">HitTest</a>(point.x,point.y);
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="comment">// Returns tab index that holds specified point</span>
<a name="l00753"></a><a class="code" href="class_t_tab_wnd.html#7e1415f46315d31b9a51b38861f4f154">00753</a> <span class="keywordtype">int</span> <a class="code" href="class_t_tab_wnd.html#7e1415f46315d31b9a51b38861f4f154">TTabWnd::HitTest</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)
<a name="l00754"></a>00754 {
<a name="l00755"></a>00755   <span class="keywordtype">int</span> notsel_y_min, sel_y_min, y_max;
<a name="l00756"></a>00756   CRect rect;
<a name="l00757"></a>00757 
<a name="l00758"></a>00758   GetClientRect(&amp;rect);
<a name="l00759"></a>00759   <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00760"></a>00760   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>:
<a name="l00761"></a>00761     notsel_y_min = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> - <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a> - <a class="code" href="_visual_fx_8cpp.html#07f834889725373fa44d2418f1b79938">TAB_DEPL</a>;
<a name="l00762"></a>00762     sel_y_min = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> - <a class="code" href="_visual_fx_8cpp.html#96d197db744fda82c1ffa0a3de1eafe7">TABSEL_HEIGHT</a> - TAB_DEPL;
<a name="l00763"></a>00763     y_max = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> - TAB_DEPL;
<a name="l00764"></a>00764     <span class="keywordflow">break</span>;
<a name="l00765"></a>00765   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00766"></a>00766     notsel_y_min = rect.Height() - <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> + TAB_DEPL;
<a name="l00767"></a>00767     sel_y_min = rect.Height() - <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> + TAB_DEPL;
<a name="l00768"></a>00768     y_max = rect.Height() - <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a> + TAB_DEPL + <a class="code" href="_visual_fx_8cpp.html#277b8b2978837abff020380f7206b510">TAB_HEIGHT</a>;
<a name="l00769"></a>00769     <span class="keywordflow">break</span>;
<a name="l00770"></a>00770   };
<a name="l00771"></a>00771 
<a name="l00772"></a>00772   <span class="keywordtype">int</span> nIndex = 0;
<a name="l00773"></a>00773   TTabItemList::iterator iterator;
<a name="l00774"></a>00774   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00775"></a>00775     <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = (*iterator);
<a name="l00776"></a>00776     <span class="keywordflow">if</span> (pItem-&gt;m_bEnabled &amp;&amp; pItem-&gt;m_bVisible) {
<a name="l00777"></a>00777       <span class="keywordflow">if</span> (nIndex != <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a> &amp;&amp; (y &lt; notsel_y_min || y &gt; y_max)) 
<a name="l00778"></a>00778         <span class="keywordflow">continue</span>;
<a name="l00779"></a>00779       <span class="keywordflow">if</span> (nIndex == <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a> &amp;&amp; (y &lt; sel_y_min || y &gt; y_max)) 
<a name="l00780"></a>00780         <span class="keywordflow">continue</span>;
<a name="l00781"></a>00781       <span class="keywordflow">if</span> (x &gt;= pItem-&gt;m_nMinX &amp;&amp; x &lt;= pItem-&gt;m_nMaxX)
<a name="l00782"></a>00782         <span class="keywordflow">return</span> nIndex;
<a name="l00783"></a>00783     }
<a name="l00784"></a>00784     nIndex++;
<a name="l00785"></a>00785   }
<a name="l00786"></a>00786   <span class="keywordflow">return</span> -1;
<a name="l00787"></a>00787 }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 <span class="comment">// Switch focus to specified tab index</span>
<a name="l00790"></a><a class="code" href="class_t_tab_wnd.html#ba2d267f278af2761d4ea75c57790048">00790</a> BOOL <a class="code" href="class_t_tab_wnd.html#ba2d267f278af2761d4ea75c57790048">TTabWnd::SetActivePane</a>(<span class="keywordtype">int</span> nIndex, BOOL bActivate)
<a name="l00791"></a>00791 {
<a name="l00792"></a>00792   <span class="keywordflow">if</span> (nIndex == -1)
<a name="l00793"></a>00793     <span class="keywordflow">return</span> FALSE;
<a name="l00794"></a>00794   <span class="keywordflow">if</span> (nIndex == <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>)
<a name="l00795"></a>00795     <span class="keywordflow">return</span> TRUE;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pNewPane = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(nIndex);
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (!pNewPane-&gt;<a class="code" href="class_t_tab_item.html#4d108a1d302aa625a218c18e6b5779e9">m_bEnabled</a> || !pNewPane-&gt;<a class="code" href="class_t_tab_item.html#a719406da8d5ecbe4a8a3c9544d08de1">m_bVisible</a>)
<a name="l00799"></a>00799     <span class="keywordflow">return</span> FALSE;
<a name="l00800"></a>00800   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pOldPane = NULL;
<a name="l00801"></a>00801   <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a> != -1)
<a name="l00802"></a>00802     pOldPane = <a class="code" href="class_t_tab_wnd.html#84e426682722d6843a87584a763eb90d">findTabItem</a>(<a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a>);
<a name="l00803"></a>00803   <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#8e10fe897450f3dac07b70edcaf54bf2">CanSetActivePane</a>(pOldPane ? pOldPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> : NULL, pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>)) {
<a name="l00804"></a>00804     <span class="comment">// Deactivate old pane</span>
<a name="l00805"></a>00805     <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a> != -1) {
<a name="l00806"></a>00806       pOldPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;EnableWindow(FALSE);
<a name="l00807"></a>00807       pOldPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;ShowWindow(SW_HIDE);
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809     <span class="comment">// Activate new pane</span>
<a name="l00810"></a>00810     pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;EnableWindow(pNewPane-&gt;<a class="code" href="class_t_tab_item.html#50069f6f9b7859e659c9017e2b5e0b5d">m_bWndEnabled</a> ? TRUE : FALSE);
<a name="l00811"></a>00811     pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;ShowWindow(SW_SHOW);
<a name="l00812"></a>00812     pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>-&gt;SetFocus();
<a name="l00813"></a>00813     <span class="comment">// Save index of new pane</span>
<a name="l00814"></a>00814     <a class="code" href="class_t_tab_wnd.html#2c00a449090188b9f74b196171374401">m_nSelectedTab</a> = nIndex;
<a name="l00815"></a>00815     <span class="comment">// Invalidate tab</span>
<a name="l00816"></a>00816     <a class="code" href="class_t_tab_wnd.html#a4763382094235501de896799fcabfea">invalidateTabArea</a>();
<a name="l00817"></a>00817     <span class="comment">// Inform derived class</span>
<a name="l00818"></a>00818     <a class="code" href="class_t_tab_wnd.html#9a7af43c2515ec6d36d9abbf5cba18d2">OnSetActivePane</a>(pOldPane ? pOldPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a> : NULL, pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>);
<a name="l00819"></a>00819     <span class="comment">// Update frame window</span>
<a name="l00820"></a>00820     <span class="keywordflow">if</span> (bActivate) {
<a name="l00821"></a>00821       CWnd *pParent = GetParent();
<a name="l00822"></a>00822       <span class="keywordflow">while</span> (pParent &amp;&amp; !pParent-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd)))
<a name="l00823"></a>00823         pParent = pParent-&gt;GetParent();
<a name="l00824"></a>00824       ASSERT(pParent != NULL);
<a name="l00825"></a>00825       <a class="code" href="class_t_tab_wnd.html#b20aab95626983c2512d25cd9dd1ba46">updateFrame</a>((CFrameWnd*)pParent, pNewPane-&gt;<a class="code" href="class_t_tab_item.html#2d4365dc154391b48709c41905f0e9e5">m_pWnd</a>);
<a name="l00826"></a>00826     }
<a name="l00827"></a>00827     <span class="keywordflow">return</span> TRUE;
<a name="l00828"></a>00828   }
<a name="l00829"></a>00829   <span class="keywordflow">return</span> FALSE;
<a name="l00830"></a>00830 }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 <span class="comment">// Update frame window active view based on newly selected tab item</span>
<a name="l00833"></a><a class="code" href="class_t_tab_wnd.html#b20aab95626983c2512d25cd9dd1ba46">00833</a> BOOL <a class="code" href="class_t_tab_wnd.html#b20aab95626983c2512d25cd9dd1ba46">TTabWnd::updateFrame</a>(CFrameWnd *pFrame, CWnd *pWnd)
<a name="l00834"></a>00834 {
<a name="l00835"></a>00835   ASSERT(pFrame);
<a name="l00836"></a>00836   ASSERT(pWnd);
<a name="l00837"></a>00837 
<a name="l00838"></a>00838   <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(CView))) {
<a name="l00839"></a>00839     <span class="comment">// New tab item is a view</span>
<a name="l00840"></a>00840     pFrame-&gt;SetActiveView((CView*)pWnd);
<a name="l00841"></a>00841     <span class="keywordflow">return</span> TRUE;
<a name="l00842"></a>00842   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd))) {
<a name="l00843"></a>00843     CSplitterWnd *pSplitter = (CSplitterWnd*)pWnd;
<a name="l00844"></a>00844     CWnd *pView = pSplitter-&gt;GetActivePane();
<a name="l00845"></a>00845     <span class="keywordflow">if</span> (pView == NULL) {
<a name="l00846"></a>00846       CWnd *pTmpView;
<a name="l00847"></a>00847       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; pSplitter-&gt;GetRowCount(); x ++) {
<a name="l00848"></a>00848         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; pSplitter-&gt;GetColumnCount(); y ++) {
<a name="l00849"></a>00849           pTmpView = pSplitter-&gt;GetPane(x,y);
<a name="l00850"></a>00850           <span class="keywordflow">if</span> (pTmpView-&gt;IsWindowEnabled()) {
<a name="l00851"></a>00851             <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#b20aab95626983c2512d25cd9dd1ba46">updateFrame</a>(pFrame, pTmpView))
<a name="l00852"></a>00852               <span class="keywordflow">return</span> TRUE;
<a name="l00853"></a>00853           }
<a name="l00854"></a>00854         }
<a name="l00855"></a>00855       }
<a name="l00856"></a>00856     }
<a name="l00857"></a>00857     <span class="keywordflow">if</span> (pView == NULL)
<a name="l00858"></a>00858       pView = pSplitter-&gt;GetPane(0,0);
<a name="l00859"></a>00859     pFrame-&gt;SetActiveView((CView*)pView);
<a name="l00860"></a>00860   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l00861"></a>00861     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pWnd;
<a name="l00862"></a>00862     <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex();
<a name="l00863"></a>00863     CWnd *pTabWnd = pTab-&gt;GetTabWnd(nIndex);
<a name="l00864"></a>00864     <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#b20aab95626983c2512d25cd9dd1ba46">updateFrame</a>(pFrame, pTabWnd))
<a name="l00865"></a>00865       <span class="keywordflow">return</span> TRUE;
<a name="l00866"></a>00866   }
<a name="l00867"></a>00867   <span class="keywordflow">return</span> FALSE;
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870 <span class="comment">// Resize tab</span>
<a name="l00871"></a><a class="code" href="class_t_tab_wnd.html#016f6f8f9030f94efeefcfef6d1b6412">00871</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#016f6f8f9030f94efeefcfef6d1b6412">TTabWnd::ResizeTab</a>(<span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy)
<a name="l00872"></a>00872 {
<a name="l00873"></a>00873   CRect rect;
<a name="l00874"></a>00874   CWnd *pParent = (CWnd*)GetParent();
<a name="l00875"></a>00875   ASSERT(pParent);
<a name="l00876"></a>00876   pParent-&gt;GetClientRect(&amp;rect); 
<a name="l00877"></a>00877 
<a name="l00878"></a>00878   <span class="keywordflow">if</span> (pParent-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd))) {
<a name="l00879"></a>00879     CSplitterWnd *splitter = (CSplitterWnd*)pParent;
<a name="l00880"></a>00880     ASSERT(pParent);
<a name="l00881"></a>00881     <span class="keywordtype">int</span> row,col;
<a name="l00882"></a>00882     splitter-&gt;IsChildPane(<span class="keyword">this</span>,row,col);
<a name="l00883"></a>00883     splitter-&gt;RecalcLayout();
<a name="l00884"></a>00884   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pParent-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {
<a name="l00885"></a>00885     <a class="code" href="class_t_tab_wnd.html#50529c70043b800f7179a4b7caae3a33">m_bLockFlag</a> = TRUE;
<a name="l00886"></a>00886     pParent-&gt;RepositionBars(0, 0xFFFF, AFX_IDW_PANE_FIRST, CWnd::reposQuery, &amp;rect);
<a name="l00887"></a>00887     MoveWindow(rect.left,rect.top,rect.Width(),rect.Height());
<a name="l00888"></a>00888     <a class="code" href="class_t_tab_wnd.html#50529c70043b800f7179a4b7caae3a33">m_bLockFlag</a> = FALSE;
<a name="l00889"></a>00889   }
<a name="l00890"></a>00890 
<a name="l00891"></a>00891   <a class="code" href="class_t_tab_wnd.html#50529c70043b800f7179a4b7caae3a33">m_bLockFlag</a> = TRUE; <span class="comment">// reentrancy check (might get called recursivly from OnSize)</span>
<a name="l00892"></a>00892   CWnd *pWnd;
<a name="l00893"></a>00893   TTabItemList::iterator iterator;
<a name="l00894"></a>00894   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.begin(); iterator != <a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.end(); iterator++) {
<a name="l00895"></a>00895     pWnd = (*iterator)-&gt;m_pWnd;
<a name="l00896"></a>00896     if (cx == -1 &amp;&amp; cy == -1) {
<a name="l00897"></a>00897       <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00898"></a>00898       <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>:
<a name="l00899"></a>00899         pWnd-&gt;MoveWindow(1, <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>+1, 
<a name="l00900"></a>00900                          rect.Width()-2, rect.Height()-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-2);
<a name="l00901"></a>00901         <span class="keywordflow">break</span>;
<a name="l00902"></a>00902       <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00903"></a>00903         pWnd-&gt;MoveWindow(1, 0, rect.Width()-2, rect.Height()-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>);
<a name="l00904"></a>00904         <span class="keywordflow">break</span>;
<a name="l00905"></a>00905       }
<a name="l00906"></a>00906     } <span class="keywordflow">else</span> {
<a name="l00907"></a>00907       <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00908"></a>00908       <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>:
<a name="l00909"></a>00909         pWnd-&gt;MoveWindow(1, <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>+1, cx, cy-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-2);
<a name="l00910"></a>00910         <span class="keywordflow">break</span>;
<a name="l00911"></a>00911       <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00912"></a>00912         pWnd-&gt;MoveWindow(1, 0, cx, cy-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>);
<a name="l00913"></a>00913         <span class="keywordflow">break</span>;
<a name="l00914"></a>00914       }
<a name="l00915"></a>00915     }
<a name="l00916"></a>00916   }
<a name="l00917"></a>00917   <a class="code" href="class_t_tab_wnd.html#50529c70043b800f7179a4b7caae3a33">m_bLockFlag</a>=FALSE;
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="comment">// Erase area where the tabs are displayed</span>
<a name="l00921"></a><a class="code" href="class_t_tab_wnd.html#7ab9d53352365f6cf12c299daf964f13">00921</a> BOOL <a class="code" href="class_t_tab_wnd.html#7ab9d53352365f6cf12c299daf964f13">TTabWnd::OnEraseBkgnd</a>(CDC* pDC)
<a name="l00922"></a>00922 {
<a name="l00923"></a>00923   ASSERT(pDC);
<a name="l00924"></a>00924 
<a name="l00925"></a>00925   CRect rect;
<a name="l00926"></a>00926   GetClientRect(&amp;rect);
<a name="l00927"></a>00927   <span class="keywordflow">switch</span> (<a class="code" href="class_t_tab_wnd.html#18a24449dc2f1372afe3ac38172caab4">m_nTabPos</a>) {
<a name="l00928"></a>00928   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TP_TOP</a>:
<a name="l00929"></a>00929     pDC-&gt;FillSolidRect(&amp;CRect(0, 0, rect.right, <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>), 
<a name="l00930"></a>00930                       ::GetSysColor(COLOR_BTNFACE));
<a name="l00931"></a>00931     <span class="keywordflow">break</span>;
<a name="l00932"></a>00932   <span class="keywordflow">case</span> <a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TP_BOTTOM</a>:
<a name="l00933"></a>00933     pDC-&gt;FillSolidRect(&amp;CRect(0, rect.bottom-<a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>-3, rect.right, rect.bottom), 
<a name="l00934"></a>00934                       ::GetSysColor(COLOR_BTNFACE));
<a name="l00935"></a>00935     <span class="keywordflow">break</span>;
<a name="l00936"></a>00936   }
<a name="l00937"></a>00937   <span class="keywordflow">return</span> TRUE;
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 <span class="comment">// Handle couse click on tabs</span>
<a name="l00941"></a><a class="code" href="class_t_tab_wnd.html#8d03b4e180725e2614dd00d3b76e14cf">00941</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#8d03b4e180725e2614dd00d3b76e14cf">TTabWnd::OnLButtonUp</a>(UINT nFlags, CPoint point)
<a name="l00942"></a>00942 {
<a name="l00943"></a>00943   <span class="keywordtype">int</span> nNewTab = <a class="code" href="class_t_tab_wnd.html#7e1415f46315d31b9a51b38861f4f154">HitTest</a>(point.x, point.y);
<a name="l00944"></a>00944   <a class="code" href="class_t_tab_wnd.html#ba2d267f278af2761d4ea75c57790048">SetActivePane</a>(nNewTab);
<a name="l00945"></a>00945   CWnd::OnLButtonUp(nFlags, point);
<a name="l00946"></a>00946 }
<a name="l00947"></a>00947 
<a name="l00948"></a>00948 <span class="comment">// Handle resize</span>
<a name="l00949"></a><a class="code" href="class_t_tab_wnd.html#0c8315631d731c7acc46935dbc12466a">00949</a> LRESULT <a class="code" href="class_t_tab_wnd.html#0c8315631d731c7acc46935dbc12466a">TTabWnd::OnSizeParent</a>(WPARAM, LPARAM lParam)
<a name="l00950"></a>00950 {
<a name="l00951"></a>00951   <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#50529c70043b800f7179a4b7caae3a33">m_bLockFlag</a>)
<a name="l00952"></a>00952     <span class="keywordflow">return</span> 0;
<a name="l00953"></a>00953   <a class="code" href="class_t_tab_wnd.html#016f6f8f9030f94efeefcfef6d1b6412">ResizeTab</a>();
<a name="l00954"></a>00954   <span class="keywordflow">return</span> 0;
<a name="l00955"></a>00955 }
<a name="l00956"></a>00956 
<a name="l00957"></a>00957 <span class="comment">// Handle resize</span>
<a name="l00958"></a><a class="code" href="class_t_tab_wnd.html#ce28657196dffc6532cdbfd58fabbc93">00958</a> <span class="keywordtype">void</span> <a class="code" href="class_t_tab_wnd.html#ce28657196dffc6532cdbfd58fabbc93">TTabWnd::OnSize</a>(UINT nType, <span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy) 
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960   CWnd::OnSize(nType, cx, cy);
<a name="l00961"></a>00961   <a class="code" href="class_t_tab_wnd.html#016f6f8f9030f94efeefcfef6d1b6412">ResizeTab</a>(cx,cy);
<a name="l00962"></a>00962 }
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 <span class="comment">// Create a CView derived class as a tab</span>
<a name="l00965"></a><a class="code" href="class_t_tab_wnd.html#6f66ebc7bc56f7094795f0dfcfdb1675">00965</a> <a class="code" href="class_t_tab_item.html">TTabItem</a> *<a class="code" href="class_t_tab_wnd.html#6f66ebc7bc56f7094795f0dfcfdb1675">TTabWnd::CreatePane</a>(LPCTSTR lpszLabel, CRuntimeClass *pViewClass, 
<a name="l00966"></a>00966                                  CCreateContext *pContext)
<a name="l00967"></a>00967 {
<a name="l00968"></a>00968   CRect rect, client;
<a name="l00969"></a>00969   ASSERT(pViewClass &amp;&amp; pContext);
<a name="l00970"></a>00970 
<a name="l00971"></a>00971   CWnd *pWnd = (CWnd*)pViewClass-&gt;CreateObject();
<a name="l00972"></a>00972   <span class="keywordflow">if</span> (!pWnd) 
<a name="l00973"></a>00973     <span class="keywordflow">return</span> NULL;
<a name="l00974"></a>00974   
<a name="l00975"></a>00975   GetClientRect(&amp;client);
<a name="l00976"></a>00976   rect.left = 0;
<a name="l00977"></a>00977   rect.top = <a class="code" href="_visual_fx_8cpp.html#1d7219045c5e07a1d34d82b677e13cc0">TABWND_HEIGHT</a>+2;
<a name="l00978"></a>00978   rect.right = client.right;
<a name="l00979"></a>00979   rect.bottom = client.bottom;
<a name="l00980"></a>00980 
<a name="l00981"></a>00981   <span class="keywordtype">int</span> dwStyle = AFX_WS_DEFAULT_VIEW;
<a name="l00982"></a>00982   <span class="keywordflow">if</span> (GetParent()-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd))) {
<a name="l00983"></a>00983     dwStyle &amp;= ~WS_BORDER;
<a name="l00984"></a>00984   }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986   <span class="keywordflow">if</span> (!pWnd-&gt;Create(NULL, NULL, dwStyle, rect, <span class="keyword">this</span>, 13576+<a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.size(), pContext))
<a name="l00987"></a>00987   {
<a name="l00988"></a>00988     TRACE0(<span class="stringliteral">"Warning: couldn't create client area for tab view\n"</span>);
<a name="l00989"></a>00989     <span class="comment">// pWnd will be cleaned up by PostNcDestroy</span>
<a name="l00990"></a>00990     <span class="keywordflow">return</span> NULL;
<a name="l00991"></a>00991   }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993   <span class="comment">// Insert new tab object into the list</span>
<a name="l00994"></a>00994   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pTab = <a class="code" href="class_t_tab_wnd.html#b44d4eeaf7b0475dc747ab980399cafa">addTab</a>(pWnd,lpszLabel);
<a name="l00995"></a>00995   ASSERT(pTab);
<a name="l00996"></a>00996   <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.size() != 1) {
<a name="l00997"></a>00997     pWnd-&gt;EnableWindow(FALSE);
<a name="l00998"></a>00998     pWnd-&gt;ShowWindow(SW_HIDE);
<a name="l00999"></a>00999   <span class="comment">/*</span>
<a name="l01000"></a>01000 <span class="comment">  // Framework is responsible to set the active view</span>
<a name="l01001"></a>01001 <span class="comment">  } else {</span>
<a name="l01002"></a>01002 <span class="comment">    CWnd *pParent = GetParent();</span>
<a name="l01003"></a>01003 <span class="comment">    if (pParent-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {</span>
<a name="l01004"></a>01004 <span class="comment">      ((CFrameWnd*)pParent)-&gt;SetActiveView((CView*)pWnd);</span>
<a name="l01005"></a>01005 <span class="comment">    } else if (pParent-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd))) {</span>
<a name="l01006"></a>01006 <span class="comment">      ((CSplitterWnd*)pParent)-&gt;SetActivePane(0,0,pWnd);</span>
<a name="l01007"></a>01007 <span class="comment">    }</span>
<a name="l01008"></a>01008 <span class="comment">  */</span>
<a name="l01009"></a>01009   }
<a name="l01010"></a>01010   <span class="keywordflow">return</span> pTab;
<a name="l01011"></a>01011 }
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 <span class="comment">// Create a splitter window as a tab</span>
<a name="l01014"></a><a class="code" href="class_t_tab_wnd.html#0ed4584a02141b1eb53fdd0193a9ad1c">01014</a> <a class="code" href="class_t_tab_item.html">TTabItem</a> *<a class="code" href="class_t_tab_wnd.html#6f66ebc7bc56f7094795f0dfcfdb1675">TTabWnd::CreatePane</a>(LPCTSTR lpszLabel, <span class="keywordtype">int</span> nRows, <span class="keywordtype">int</span> nCols, 
<a name="l01015"></a>01015                                  CWnd *pWnd, UINT nID)
<a name="l01016"></a>01016 {
<a name="l01017"></a>01017   ASSERT(pWnd);
<a name="l01018"></a>01018   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)));
<a name="l01019"></a>01019 
<a name="l01020"></a>01020   <span class="comment">// Moved to TVisualFramework to handle creation of CSplitterWnd derived classes</span>
<a name="l01021"></a>01021   <span class="comment">//CSplitterWnd *pWnd = new CSplitterWnd;</span>
<a name="l01022"></a>01022   <span class="comment">//if (!pWnd) </span>
<a name="l01023"></a>01023   <span class="comment">//  return NULL;</span>
<a name="l01024"></a>01024 
<a name="l01025"></a>01025   <span class="keywordtype">int</span> dwStyle = AFX_WS_DEFAULT_VIEW;
<a name="l01026"></a>01026   dwStyle &amp;= ~WS_BORDER;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028   CSplitterWnd *pSplitter = (CSplitterWnd*)pWnd;
<a name="l01029"></a>01029   <span class="keywordflow">if</span> (!pSplitter-&gt;CreateStatic(<span class="keyword">this</span>, nRows, nCols, dwStyle, nID)) {
<a name="l01030"></a>01030     TRACE0(<span class="stringliteral">"Warning: couldn't create client area for tab view\n"</span>);
<a name="l01031"></a>01031     <span class="comment">// pWnd will be cleaned up by PostNcDestroy</span>
<a name="l01032"></a>01032     <span class="keywordflow">return</span> NULL;
<a name="l01033"></a>01033   }
<a name="l01034"></a>01034 
<a name="l01035"></a>01035   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pTab = <a class="code" href="class_t_tab_wnd.html#b44d4eeaf7b0475dc747ab980399cafa">addTab</a>(pWnd,lpszLabel);
<a name="l01036"></a>01036   ASSERT(pTab);
<a name="l01037"></a>01037   <span class="keywordflow">if</span> (<a class="code" href="class_t_tab_wnd.html#9f7034c7760e0c204f90ed34a4e974bc">m_TabList</a>.size() != 1) {
<a name="l01038"></a>01038     pWnd-&gt;EnableWindow(FALSE);
<a name="l01039"></a>01039     pWnd-&gt;ShowWindow(SW_HIDE);
<a name="l01040"></a>01040   } 
<a name="l01041"></a>01041 
<a name="l01042"></a>01042   <span class="comment">/*</span>
<a name="l01043"></a>01043 <span class="comment">  // Framework will set the active view</span>
<a name="l01044"></a>01044 <span class="comment">  CWnd *paneWnd = pWnd-&gt;GetActivePane();</span>
<a name="l01045"></a>01045 <span class="comment">  if (paneWnd) {</span>
<a name="l01046"></a>01046 <span class="comment">    ((CFrameWnd*)GetParent())-&gt;SetActiveView((CView*)paneWnd);</span>
<a name="l01047"></a>01047 <span class="comment">  } else {</span>
<a name="l01048"></a>01048 <span class="comment">    paneWnd = pWnd-&gt;GetPane(0,0);</span>
<a name="l01049"></a>01049 <span class="comment">    pWnd-&gt;SetActivePane(0,0);</span>
<a name="l01050"></a>01050 <span class="comment">    ((CFrameWnd*)GetParent())-&gt;SetActiveView((CView*)paneWnd);</span>
<a name="l01051"></a>01051 <span class="comment">  }</span>
<a name="l01052"></a>01052 <span class="comment">  */</span>
<a name="l01053"></a>01053 
<a name="l01054"></a>01054   <span class="keywordflow">return</span> pTab;
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 <span class="comment">//=============================================================================</span>
<a name="l01058"></a>01058 <span class="comment">// class TVisualObject</span>
<a name="l01059"></a>01059 <span class="comment">//</span>
<a name="l01060"></a>01060 <span class="comment">//=============================================================================</span>
<a name="l01061"></a>01061 
<a name="l01062"></a>01062 <span class="comment">// Private constructor</span>
<a name="l01063"></a><a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">01063</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>()
<a name="l01064"></a>01064 {
<a name="l01065"></a>01065 }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067 <span class="comment">// Create a plain view</span>
<a name="l01068"></a><a class="code" href="class_t_visual_object.html#20ed117dd4b53a3249869442930aae22">01068</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(DWORD dwId, CCreateContext *pContext, 
<a name="l01069"></a>01069                        CRuntimeClass *pClass)
<a name="l01070"></a>01070 {
<a name="l01071"></a>01071   ASSERT(pContext);
<a name="l01072"></a>01072   ASSERT(pClass);
<a name="l01073"></a>01073   ASSERT(pClass-&gt;IsDerivedFrom(RUNTIME_CLASS(CView)));
<a name="l01074"></a>01074 
<a name="l01075"></a>01075   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01076"></a>01076   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = dwId;
<a name="l01077"></a>01077   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd025d946ffdb6faaee03f4546e46b02afd">OT_VIEW</a>;
<a name="l01078"></a>01078   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = pContext;
<a name="l01079"></a>01079   <a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> = pClass;
<a name="l01080"></a>01080   <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">checkStyle</a>();
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 <span class="comment">// Create a view within a tab window or a tab window</span>
<a name="l01084"></a><a class="code" href="class_t_visual_object.html#749d7e443121346d672457c53516a11f">01084</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(DWORD dwId, LPCTSTR szTitle, CCreateContext *pContext, 
<a name="l01085"></a>01085                        CRuntimeClass *pClass, DWORD dwStyle)
<a name="l01086"></a>01086 {
<a name="l01087"></a>01087   ASSERT(szTitle);
<a name="l01088"></a>01088   ASSERT(pContext);
<a name="l01089"></a>01089   ASSERT(pClass);
<a name="l01090"></a>01090 
<a name="l01091"></a>01091   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01092"></a>01092   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = dwId;
<a name="l01093"></a>01093   <span class="keywordflow">if</span> (pClass-&gt;IsDerivedFrom(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01094"></a>01094     <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0da9994da85d755d961904ca04879b0c8">OT_TAB</a>;
<a name="l01095"></a>01095   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pClass-&gt;IsDerivedFrom(RUNTIME_CLASS(CView))) {
<a name="l01096"></a>01096     <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd086e728851fc537ef1a42ce5cfcedc05c">OT_TABVIEW</a>;
<a name="l01097"></a>01097   } <span class="keywordflow">else</span> {
<a name="l01098"></a>01098     ASSERT(FALSE);
<a name="l01099"></a>01099   }
<a name="l01100"></a>01100   <a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a> = szTitle;
<a name="l01101"></a>01101   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = pContext;
<a name="l01102"></a>01102   <a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> = pClass;
<a name="l01103"></a>01103   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = dwStyle;
<a name="l01104"></a>01104   <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">checkStyle</a>();
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 <span class="comment">// Create a splitter window</span>
<a name="l01108"></a><a class="code" href="class_t_visual_object.html#9e9ab6bf1a72aeb2afd46f426561d0e1">01108</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(DWORD dwId, LPCTSTR szTitle, <span class="keywordtype">int</span> nRows, <span class="keywordtype">int</span> nCols, 
<a name="l01109"></a>01109                        CCreateContext *pContext, DWORD dwStyle)
<a name="l01110"></a>01110 {
<a name="l01111"></a>01111   ASSERT(szTitle);
<a name="l01112"></a>01112   ASSERT(pContext);
<a name="l01113"></a>01113   ASSERT(nRows);
<a name="l01114"></a>01114   ASSERT(nCols);
<a name="l01115"></a>01115 
<a name="l01116"></a>01116   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01117"></a>01117   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = dwId;
<a name="l01118"></a>01118   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">OT_SPLITTER</a>;
<a name="l01119"></a>01119   <a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a> = szTitle;
<a name="l01120"></a>01120   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = pContext;
<a name="l01121"></a>01121   <a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a> = nRows;
<a name="l01122"></a>01122   <a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a> = nCols;
<a name="l01123"></a>01123   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = dwStyle;
<a name="l01124"></a>01124   <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">checkStyle</a>();
<a name="l01125"></a>01125 }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 <span class="comment">// Create a view within a splitter window</span>
<a name="l01128"></a><a class="code" href="class_t_visual_object.html#0dfb1473c8cfe7bb894db95b94d13791">01128</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(DWORD dwId, <span class="keywordtype">int</span> nRow, <span class="keywordtype">int</span> nCol, CCreateContext *pContext, 
<a name="l01129"></a>01129                        CRuntimeClass *pClass, CSize size, DWORD dwStyle)
<a name="l01130"></a>01130 {
<a name="l01131"></a>01131   ASSERT(pContext);
<a name="l01132"></a>01132   ASSERT(pClass);
<a name="l01133"></a>01133   ASSERT(pClass-&gt;IsDerivedFrom(RUNTIME_CLASS(CView)) ||
<a name="l01134"></a>01134          pClass-&gt;IsDerivedFrom(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)));
<a name="l01135"></a>01135 
<a name="l01136"></a>01136   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01137"></a>01137   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = dwId;
<a name="l01138"></a>01138   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0796b76767b122c434a62a7a1c03372a4">OT_SPLITTERVIEW</a>;
<a name="l01139"></a>01139   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = pContext;
<a name="l01140"></a>01140   <a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> = pClass;
<a name="l01141"></a>01141   <a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a> = nRow;
<a name="l01142"></a>01142   <a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a> = nCol;
<a name="l01143"></a>01143   <a class="code" href="class_t_visual_object.html#ad30f5616f35bb83dbd5d8bada89a8ce">m_Size</a> = size;
<a name="l01144"></a>01144   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = dwStyle;
<a name="l01145"></a>01145   <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">checkStyle</a>();
<a name="l01146"></a>01146 }
<a name="l01147"></a>01147 
<a name="l01148"></a>01148 <span class="comment">// Create a splitter within a splitter window</span>
<a name="l01149"></a><a class="code" href="class_t_visual_object.html#6808b2b8820d8cb59b296a9265b7fc8d">01149</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(DWORD dwId, <span class="keywordtype">int</span> nRow, <span class="keywordtype">int</span> nCol, <span class="keywordtype">int</span> nRows, <span class="keywordtype">int</span> nCols, 
<a name="l01150"></a>01150                        CCreateContext *pContext, DWORD dwStyle)
<a name="l01151"></a>01151 {
<a name="l01152"></a>01152   ASSERT(pContext);
<a name="l01153"></a>01153   ASSERT(nRows);
<a name="l01154"></a>01154   ASSERT(nCols);
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01157"></a>01157   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = dwId;
<a name="l01158"></a>01158   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0e0ddc9e4c6b217d7e843123b962457ee">OT_SPLITTERSPLITTER</a>;
<a name="l01159"></a>01159   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = pContext;
<a name="l01160"></a>01160   <a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a> = nRow;
<a name="l01161"></a>01161   <a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a> = nCol;
<a name="l01162"></a>01162   <a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a> = nRows;
<a name="l01163"></a>01163   <a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a> = nCols;
<a name="l01164"></a>01164   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = dwStyle;
<a name="l01165"></a>01165   <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">checkStyle</a>();
<a name="l01166"></a>01166 }
<a name="l01167"></a>01167 
<a name="l01168"></a><a class="code" href="class_t_visual_object.html#072eadf6bf5ead8c7f8f03d71566ee98">01168</a> <a class="code" href="class_t_visual_object.html#e4b641eccf36d6101eb0f65c7c89ef85">TVisualObject::TVisualObject</a>(<span class="keyword">const</span> <a class="code" href="class_t_visual_object.html">TVisualObject</a>&amp; obj)
<a name="l01169"></a>01169 {
<a name="l01170"></a>01170   <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">zeroAll</a>();
<a name="l01171"></a>01171   *<span class="keyword">this</span> = obj;
<a name="l01172"></a>01172 }
<a name="l01173"></a>01173 
<a name="l01174"></a><a class="code" href="class_t_visual_object.html#533f85fd39513166139ce61b55caddb6">01174</a> <a class="code" href="class_t_visual_object.html#533f85fd39513166139ce61b55caddb6">TVisualObject::~TVisualObject</a>()
<a name="l01175"></a>01175 {
<a name="l01176"></a>01176   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a>) {
<a name="l01177"></a>01177     ::DestroyIcon(<a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a>);
<a name="l01178"></a>01178     <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> = NULL;
<a name="l01179"></a>01179   }
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01182"></a><a class="code" href="class_t_visual_object.html#0fb81702b69880ed341b277fcf593120">01182</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a>&amp; <a class="code" href="class_t_visual_object.html#0fb81702b69880ed341b277fcf593120">TVisualObject::operator=</a>(<span class="keyword">const</span> <a class="code" href="class_t_visual_object.html">TVisualObject</a>&amp; obj)
<a name="l01183"></a>01183 {
<a name="l01184"></a>01184   <span class="comment">// No need to copy m_ObjectList since it is populated after</span>
<a name="l01185"></a>01185   <span class="comment">// this code is executed in STL container</span>
<a name="l01186"></a>01186   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = obj.<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a>;
<a name="l01187"></a>01187   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = obj.<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>;
<a name="l01188"></a>01188   <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = obj.<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01189"></a>01189   <a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = obj.<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l01190"></a>01190   <a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a> = obj.<a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a>;
<a name="l01191"></a>01191   <a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a> = obj.<a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a>;
<a name="l01192"></a>01192   <a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a> = obj.<a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a>;
<a name="l01193"></a>01193   <a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a> = obj.<a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a>;
<a name="l01194"></a>01194   <a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a> = obj.<a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a>;
<a name="l01195"></a>01195   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = obj.<a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a>;
<a name="l01196"></a>01196   <a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> = obj.<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a>;
<a name="l01197"></a>01197   <a class="code" href="class_t_visual_object.html#ad30f5616f35bb83dbd5d8bada89a8ce">m_Size</a> = obj.<a class="code" href="class_t_visual_object.html#ad30f5616f35bb83dbd5d8bada89a8ce">m_Size</a>;
<a name="l01198"></a>01198   <a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a> = obj.<a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a>;
<a name="l01199"></a>01199   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = obj.<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a>;
<a name="l01200"></a>01200   <a class="code" href="class_t_visual_object.html#4437308961634bca0bf1b178503251e1">m_cHotKey</a> = obj.<a class="code" href="class_t_visual_object.html#4437308961634bca0bf1b178503251e1">m_cHotKey</a>;
<a name="l01201"></a>01201   <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> = obj.<a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a>;
<a name="l01202"></a>01202   <a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a> = obj.<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>;
<a name="l01203"></a>01203   <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a> = obj.<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>;
<a name="l01204"></a>01204   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l01205"></a>01205 }
<a name="l01206"></a>01206 
<a name="l01207"></a><a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">01207</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_object.html#1ee1c26ad94dd6603db7a2455cd78ff3">TVisualObject::zeroAll</a>(<span class="keywordtype">void</span>)
<a name="l01208"></a>01208 {
<a name="l01209"></a>01209   <span class="comment">// No need to zero m_ObjectList since it is already empty</span>
<a name="l01210"></a>01210   <a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> = <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0a2d43297b313ac5a94b781698b6fc96e">OT_UNKNOWN</a>;
<a name="l01211"></a>01211   <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a> = 0;
<a name="l01212"></a>01212   <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = NULL;
<a name="l01213"></a>01213   <a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = NULL;
<a name="l01214"></a>01214   <a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a> = _T(<span class="stringliteral">""</span>);
<a name="l01215"></a>01215   <a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a> = 0;
<a name="l01216"></a>01216   <a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a> = 0;
<a name="l01217"></a>01217   <a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a> = 0;
<a name="l01218"></a>01218   <a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a> = 0;
<a name="l01219"></a>01219   <a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a> = NULL;
<a name="l01220"></a>01220   <a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> = NULL;
<a name="l01221"></a>01221   <a class="code" href="class_t_visual_object.html#ad30f5616f35bb83dbd5d8bada89a8ce">m_Size</a> = CSize(0,0);
<a name="l01222"></a>01222   <a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a> = TRUE;
<a name="l01223"></a>01223   <a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> = 0;
<a name="l01224"></a>01224   <a class="code" href="class_t_visual_object.html#4437308961634bca0bf1b178503251e1">m_cHotKey</a> = 0;
<a name="l01225"></a>01225   <a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a> = NULL;
<a name="l01226"></a>01226   <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a> = NULL;
<a name="l01227"></a>01227   <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> = NULL;
<a name="l01228"></a>01228 }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230 <span class="comment">// Check if style is valid</span>
<a name="l01231"></a><a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">01231</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_object.html#17aa148e872d7b7ba05c290272b6b896">TVisualObject::checkStyle</a>(<span class="keywordtype">void</span>)
<a name="l01232"></a>01232 {
<a name="l01233"></a>01233   <span class="keywordflow">if</span> ((<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b362606218a3476360ef542b6d45205ff5ab8">TOS_TABTOP</a>) || (<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b3626390bf2effb57cf0fa395f9022877018b">TOS_TABBOTTOM</a>)) {
<a name="l01234"></a>01234     ASSERT(<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a>);
<a name="l01235"></a>01235     <span class="comment">// Tab position valid only for tab window derived classes</span>
<a name="l01236"></a>01236     ASSERT(m_pRuntimeClass-&gt;IsDerivedFrom(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)));
<a name="l01237"></a>01237   }
<a name="l01238"></a>01238   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b36260cd34a63b3315b6cb44b5f1096d3032a">TOS_SELECTED</a>) {
<a name="l01239"></a>01239     <span class="comment">// Selected valid only for tab panes that are not splitters and tabs</span>
<a name="l01240"></a>01240     <span class="comment">// In this case, use TVisualFramework::SetActivePane() to set the active pane</span>
<a name="l01241"></a>01241     <span class="comment">// once the framework is created</span>
<a name="l01242"></a>01242     <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a> == NULL) {
<a name="l01243"></a>01243       <span class="comment">// Splitters canot be dynamically create (m_pRuntimeClass is NULL)</span>
<a name="l01244"></a>01244       ASSERT((<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">OT_SPLITTER</a>) &amp;&amp; (<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0796b76767b122c434a62a7a1c03372a4">OT_SPLITTERVIEW</a>));
<a name="l01245"></a>01245     } <span class="keywordflow">else</span> {
<a name="l01246"></a>01246       ASSERT(!<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a>-&gt;IsDerivedFrom(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)));
<a name="l01247"></a>01247     }
<a name="l01248"></a>01248   }
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 <span class="comment">// Delete the window pointer and optionally destroy the window</span>
<a name="l01252"></a><a class="code" href="class_t_visual_object.html#aab2198ed77f3d9d6a290785462dc762">01252</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_object.html#aab2198ed77f3d9d6a290785462dc762">TVisualObject::Destroy</a>(BOOL bDestroyWindow)
<a name="l01253"></a>01253 {
<a name="l01254"></a>01254   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>) {
<a name="l01255"></a>01255     <span class="keywordflow">if</span> (bDestroyWindow)
<a name="l01256"></a>01256       <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;DestroyWindow();
<a name="l01257"></a>01257     <span class="keyword">delete</span> <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01258"></a>01258     <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = NULL;
<a name="l01259"></a>01259   }
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262 <span class="comment">// If this object is a tab window or splitter window that it </span>
<a name="l01263"></a>01263 <span class="comment">// cannot be focused</span>
<a name="l01264"></a><a class="code" href="class_t_visual_object.html#8351c2168325c65d3c239e8caf6fdfce">01264</a> BOOL <a class="code" href="class_t_visual_object.html#8351c2168325c65d3c239e8caf6fdfce">TVisualObject::CanFocus</a>(<span class="keywordtype">void</span>)
<a name="l01265"></a>01265 {
<a name="l01266"></a>01266   ASSERT(<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01267"></a>01267 
<a name="l01268"></a>01268   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)) ||
<a name="l01269"></a>01269       <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l01270"></a>01270   {
<a name="l01271"></a>01271     <span class="keywordflow">return</span> FALSE;
<a name="l01272"></a>01272   }
<a name="l01273"></a>01273   <span class="keywordflow">return</span> TRUE;
<a name="l01274"></a>01274 }
<a name="l01275"></a>01275 
<a name="l01276"></a>01276 <span class="comment">// Set hot key for this tab object</span>
<a name="l01277"></a><a class="code" href="class_t_visual_object.html#0a4763f612ef737181e16cb4ccab5c52">01277</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_object.html#0a4763f612ef737181e16cb4ccab5c52">TVisualObject::SetHotKey</a>(CHAR cHotKey)
<a name="l01278"></a>01278 {
<a name="l01279"></a>01279   <a class="code" href="class_t_visual_object.html#4437308961634bca0bf1b178503251e1">m_cHotKey</a> = cHotKey;
<a name="l01280"></a>01280 }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282 <span class="comment">// Optional: Set description </span>
<a name="l01283"></a><a class="code" href="class_t_visual_object.html#8b4276471c2338e12e77f8a1cf89cf64">01283</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_object.html#8b4276471c2338e12e77f8a1cf89cf64">TVisualObject::SetDescription</a>(LPCTSTR szDesc)
<a name="l01284"></a>01284 {
<a name="l01285"></a>01285   <a class="code" href="class_t_visual_object.html#03654bd8bf3323471bda9dba027992eb">m_strDescription</a> = szDesc;
<a name="l01286"></a>01286 }
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 <span class="comment">// Optional: Set icon for tab and load it from the resource</span>
<a name="l01289"></a><a class="code" href="class_t_visual_object.html#e256a257e517e85e400f52ef134c970e">01289</a> BOOL <a class="code" href="class_t_visual_object.html#e256a257e517e85e400f52ef134c970e">TVisualObject::SetIcon</a>(UINT nIconId)
<a name="l01290"></a>01290 {
<a name="l01291"></a>01291   <span class="comment">// Cannot specify icon if already specified</span>
<a name="l01292"></a>01292   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a>)
<a name="l01293"></a>01293     <span class="keywordflow">return</span> FALSE;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295   <span class="comment">// Load icon if possible</span>
<a name="l01296"></a>01296   <span class="keywordflow">if</span> (nIconId == 0) {
<a name="l01297"></a>01297     <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> = NULL;
<a name="l01298"></a>01298   } <span class="keywordflow">else</span> {
<a name="l01299"></a>01299     <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> = (HICON)::LoadImage(::AfxGetResourceHandle(), 
<a name="l01300"></a>01300                         MAKEINTRESOURCE(nIconId), 
<a name="l01301"></a>01301                         IMAGE_ICON, 16, 16, LR_DEFAULTCOLOR);
<a name="l01302"></a>01302     <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a> == NULL)
<a name="l01303"></a>01303       <span class="keywordflow">return</span> FALSE;
<a name="l01304"></a>01304   }
<a name="l01305"></a>01305   <span class="keywordflow">return</span> TRUE;
<a name="l01306"></a>01306 }
<a name="l01307"></a>01307 
<a name="l01308"></a>01308 <span class="comment">// Optional: Return icon handle for tab</span>
<a name="l01309"></a><a class="code" href="class_t_visual_object.html#8442bfd4a76a4f8a255c769d3fa4c486">01309</a> HICON <a class="code" href="class_t_visual_object.html#8442bfd4a76a4f8a255c769d3fa4c486">TVisualObject::GetIcon</a>(<span class="keywordtype">void</span>)
<a name="l01310"></a>01310 {
<a name="l01311"></a>01311   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#f115daaea864c128a34b99c2fcb2350f">m_hIcon</a>;
<a name="l01312"></a>01312 }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314 <span class="comment">// Set this object as active pane</span>
<a name="l01315"></a><a class="code" href="class_t_visual_object.html#9c529cda82b65dbf13b12a847da51088">01315</a> BOOL <a class="code" href="class_t_visual_object.html#9c529cda82b65dbf13b12a847da51088">TVisualObject::SetActivePane</a>(<span class="keywordtype">void</span>)
<a name="l01316"></a>01316 {
<a name="l01317"></a>01317   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01318"></a>01318   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#e778a7e8dada71ce8c9b239baf381dfd">SetActivePane</a>(<span class="keyword">this</span>);
<a name="l01319"></a>01319 }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321 <span class="comment">// Set this tab to be active tab (not the active pane)</span>
<a name="l01322"></a><a class="code" href="class_t_visual_object.html#eac7085de66a47c76c61ea45dc9d12fb">01322</a> BOOL <a class="code" href="class_t_visual_object.html#eac7085de66a47c76c61ea45dc9d12fb">TVisualObject::SetActiveTab</a>(<span class="keywordtype">void</span>)
<a name="l01323"></a>01323 {
<a name="l01324"></a>01324   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01325"></a>01325   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#3ff7c9243bd1b09c78a3bbeba7455231">SetActiveTab</a>(<span class="keyword">this</span>);
<a name="l01326"></a>01326 }
<a name="l01327"></a>01327 
<a name="l01328"></a>01328 <span class="comment">// Enable/disable this object</span>
<a name="l01329"></a><a class="code" href="class_t_visual_object.html#1da0549a96b04da2e73c4a1c40bf7583">01329</a> BOOL <a class="code" href="class_t_visual_object.html#1da0549a96b04da2e73c4a1c40bf7583">TVisualObject::Enable</a>(BOOL bEnable)
<a name="l01330"></a>01330 {
<a name="l01331"></a>01331   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01332"></a>01332   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#03a1a2c44f50daa057f33d67954e3db1">Enable</a>(<span class="keyword">this</span>,bEnable);
<a name="l01333"></a>01333 }
<a name="l01334"></a>01334 
<a name="l01335"></a>01335 <span class="comment">// Enable/disable tab</span>
<a name="l01336"></a><a class="code" href="class_t_visual_object.html#be0eef589b92cb0e9488ae492e968a56">01336</a> BOOL <a class="code" href="class_t_visual_object.html#be0eef589b92cb0e9488ae492e968a56">TVisualObject::EnableTab</a>(BOOL bEnable)
<a name="l01337"></a>01337 {
<a name="l01338"></a>01338   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01339"></a>01339   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#da54e0f554bb09e2d3905085a2068699">EnableTab</a>(<span class="keyword">this</span>,bEnable);
<a name="l01340"></a>01340 }
<a name="l01341"></a>01341 
<a name="l01342"></a>01342 <span class="comment">// SHow/hide this object</span>
<a name="l01343"></a><a class="code" href="class_t_visual_object.html#2ff68b7e34712faf858ee46ccd06425f">01343</a> BOOL <a class="code" href="class_t_visual_object.html#2ff68b7e34712faf858ee46ccd06425f">TVisualObject::ShowTab</a>(BOOL bShow)
<a name="l01344"></a>01344 {
<a name="l01345"></a>01345   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01346"></a>01346   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#92693b4183bff8d20e22463d480916c2">ShowTab</a>(<span class="keyword">this</span>,bShow);
<a name="l01347"></a>01347 }
<a name="l01348"></a>01348 
<a name="l01349"></a>01349 <span class="comment">// Is this object enabled</span>
<a name="l01350"></a><a class="code" href="class_t_visual_object.html#697475b0d0eeaa05df14491e582a72ff">01350</a> BOOL <a class="code" href="class_t_visual_object.html#697475b0d0eeaa05df14491e582a72ff">TVisualObject::IsEnabled</a>(BOOL&amp; bEnabled)
<a name="l01351"></a>01351 {
<a name="l01352"></a>01352   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01353"></a>01353   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#8cf1b77174808d956e4f3c2bc8499bf1">IsEnabled</a>(<span class="keyword">this</span>,bEnabled);
<a name="l01354"></a>01354 }
<a name="l01355"></a>01355 
<a name="l01356"></a>01356 <span class="comment">// Is this object enabled</span>
<a name="l01357"></a><a class="code" href="class_t_visual_object.html#a6c53c6474b6e4f47b1afcda390f8402">01357</a> BOOL <a class="code" href="class_t_visual_object.html#a6c53c6474b6e4f47b1afcda390f8402">TVisualObject::IsTabEnabled</a>(BOOL&amp; bEnabled)
<a name="l01358"></a>01358 {
<a name="l01359"></a>01359   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01360"></a>01360   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#46485cad5eff23cfe16ad409b635b03c">IsTabEnabled</a>(<span class="keyword">this</span>,bEnabled);
<a name="l01361"></a>01361 }
<a name="l01362"></a>01362 
<a name="l01363"></a>01363 <span class="comment">// Is this object visible</span>
<a name="l01364"></a><a class="code" href="class_t_visual_object.html#7b998d91d264dddcafe336d946e47a86">01364</a> BOOL <a class="code" href="class_t_visual_object.html#7b998d91d264dddcafe336d946e47a86">TVisualObject::IsTabVisible</a>(BOOL&amp; bVisible)
<a name="l01365"></a>01365 {
<a name="l01366"></a>01366   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01367"></a>01367   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#c8aeec4c277b66eb754a71767eb20c26">IsTabVisible</a>(<span class="keyword">this</span>,bVisible);
<a name="l01368"></a>01368 }
<a name="l01369"></a>01369 
<a name="l01370"></a>01370 <span class="comment">// Returns TRUE if this object is a tab within a tab window</span>
<a name="l01371"></a><a class="code" href="class_t_visual_object.html#1759360cd3722345ad415511b89f6f28">01371</a> BOOL <a class="code" href="class_t_visual_object.html#1759360cd3722345ad415511b89f6f28">TVisualObject::IsTabPane</a>(<span class="keywordtype">void</span>)
<a name="l01372"></a>01372 {
<a name="l01373"></a>01373   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01374"></a>01374   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#ec62a4cbc7d5738135fbcd377e3fb7ce">IsTabPane</a>(<span class="keyword">this</span>);
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377 <span class="comment">// Returns TRUE if this object is a tab window</span>
<a name="l01378"></a><a class="code" href="class_t_visual_object.html#b4e87bcb17243c8d71314beea70742a7">01378</a> BOOL <a class="code" href="class_t_visual_object.html#b4e87bcb17243c8d71314beea70742a7">TVisualObject::IsTabWindow</a>(<span class="keywordtype">void</span>)
<a name="l01379"></a>01379 {
<a name="l01380"></a>01380   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01381"></a>01381   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#4370c35bc49c7d9b6c0d70e4b4fed332">IsTabWindow</a>(<span class="keyword">this</span>);
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 <span class="comment">// Returns TRUE if this object is a pane within a splitter window</span>
<a name="l01385"></a><a class="code" href="class_t_visual_object.html#1db00659f0af96ce265ed2553aa5cb44">01385</a> BOOL <a class="code" href="class_t_visual_object.html#1db00659f0af96ce265ed2553aa5cb44">TVisualObject::IsSplitterPane</a>(<span class="keywordtype">void</span>)
<a name="l01386"></a>01386 {
<a name="l01387"></a>01387   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01388"></a>01388   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#9ed28fe77b5e2ed2d3304abc6cdf8ac5">IsSplitterPane</a>(<span class="keyword">this</span>);
<a name="l01389"></a>01389 }
<a name="l01390"></a>01390 
<a name="l01391"></a>01391 <span class="comment">// Returns TRUE if this object is a splitter window</span>
<a name="l01392"></a><a class="code" href="class_t_visual_object.html#641e76877f95247bdf29f96204e174cd">01392</a> BOOL <a class="code" href="class_t_visual_object.html#641e76877f95247bdf29f96204e174cd">TVisualObject::IsSplitterWindow</a>(<span class="keywordtype">void</span>)
<a name="l01393"></a>01393 {
<a name="l01394"></a>01394   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01395"></a>01395   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#c661f1ff700c722cce3d97cc957db8dc">IsSplitterWindow</a>(<span class="keyword">this</span>);
<a name="l01396"></a>01396 }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398 <span class="comment">// Returns TRUE if this object is derived from CView </span>
<a name="l01399"></a><a class="code" href="class_t_visual_object.html#374cd8f0cb0051c7ae2d75c907cfaec2">01399</a> BOOL <a class="code" href="class_t_visual_object.html#374cd8f0cb0051c7ae2d75c907cfaec2">TVisualObject::IsView</a>(<span class="keywordtype">void</span>)
<a name="l01400"></a>01400 {
<a name="l01401"></a>01401   ASSERT(<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>);
<a name="l01402"></a>01402   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>-&gt;<a class="code" href="class_t_visual_framework.html#7e8b381139c2cd36eafd0e1f9d129aa3">IsView</a>(<span class="keyword">this</span>);
<a name="l01403"></a>01403 }
<a name="l01404"></a>01404 
<a name="l01405"></a>01405 <span class="comment">// Get object ID</span>
<a name="l01406"></a>01406 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01407"></a>01407 <span class="preprocessor"></span>DWORD <a class="code" href="class_t_visual_object.html#02e524b58817121a3a4e9eb384be8b3f">TVisualObject::GetID</a>(<span class="keywordtype">void</span>)
<a name="l01408"></a>01408 {
<a name="l01409"></a>01409   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>;
<a name="l01410"></a>01410 }
<a name="l01411"></a>01411 <span class="preprocessor">#endif</span>
<a name="l01412"></a>01412 <span class="preprocessor"></span>
<a name="l01413"></a>01413 <span class="comment">// Get object window</span>
<a name="l01414"></a>01414 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01415"></a>01415 <span class="preprocessor"></span>CWnd *<a class="code" href="class_t_visual_object.html#d9cb9adb141cf6c6c96baac5d406ab30">TVisualObject::GetWnd</a>(<span class="keywordtype">void</span>)
<a name="l01416"></a>01416 {
<a name="l01417"></a>01417   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01418"></a>01418 }
<a name="l01419"></a>01419 <span class="preprocessor">#endif</span>
<a name="l01420"></a>01420 <span class="preprocessor"></span>
<a name="l01421"></a>01421 <span class="comment">// Get safe object window</span>
<a name="l01422"></a>01422 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01423"></a>01423 <span class="preprocessor"></span>CWnd *<a class="code" href="class_t_visual_object.html#6eb8da38493ad61734ec345f0e196a05">TVisualObject::GetSafeWnd</a>(<span class="keywordtype">void</span>)
<a name="l01424"></a>01424 {
<a name="l01425"></a>01425   return ::IsWindow(<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd) ? <a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> : NULL;
<a name="l01426"></a>01426 }
<a name="l01427"></a>01427 <span class="preprocessor">#endif</span>
<a name="l01428"></a>01428 <span class="preprocessor"></span>
<a name="l01429"></a>01429 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01430"></a>01430 <span class="preprocessor"></span>CString <a class="code" href="class_t_visual_object.html#9838269a2d2234b6c60cce1dce413fc6">TVisualObject::GetTitle</a>(<span class="keywordtype">void</span>)
<a name="l01431"></a>01431 {
<a name="l01432"></a>01432   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a>;
<a name="l01433"></a>01433 }
<a name="l01434"></a>01434 <span class="preprocessor">#endif</span>
<a name="l01435"></a>01435 <span class="preprocessor"></span>
<a name="l01436"></a>01436 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01437"></a>01437 <span class="preprocessor"></span>CString <a class="code" href="class_t_visual_object.html#6a2d19a9f4b05d70be2c57fd96e5893d">TVisualObject::GetDescription</a>(<span class="keywordtype">void</span>)
<a name="l01438"></a>01438 {
<a name="l01439"></a>01439   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#03654bd8bf3323471bda9dba027992eb">m_strDescription</a>;
<a name="l01440"></a>01440 }
<a name="l01441"></a>01441 <span class="preprocessor">#endif</span>
<a name="l01442"></a>01442 <span class="preprocessor"></span>
<a name="l01443"></a>01443 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01444"></a>01444 <span class="preprocessor"></span>CWnd *<a class="code" href="class_t_visual_object.html#57065464c29245c6b4ba3d72c75685b7">TVisualObject::GetParentWnd</a>(<span class="keywordtype">void</span>)
<a name="l01445"></a>01445 {
<a name="l01446"></a>01446   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l01447"></a>01447 }
<a name="l01448"></a>01448 <span class="preprocessor">#endif</span>
<a name="l01449"></a>01449 <span class="preprocessor"></span>
<a name="l01450"></a>01450 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01451"></a>01451 <span class="preprocessor"></span><a class="code" href="class_t_visual_framework.html">TVisualFramework</a> *<a class="code" href="class_t_visual_object.html#ee7c67d4fa2410b8083ed3d523c73dd6">TVisualObject::GetFramework</a>(<span class="keywordtype">void</span>)
<a name="l01452"></a>01452 {
<a name="l01453"></a>01453   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a>;
<a name="l01454"></a>01454 }
<a name="l01455"></a>01455 <span class="preprocessor">#endif</span>
<a name="l01456"></a>01456 <span class="preprocessor"></span>
<a name="l01457"></a>01457 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01458"></a>01458 <span class="preprocessor"></span><a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_object.html#981fc16fe5f03294249f23f99a79586a">TVisualObject::GetOwner</a>(<span class="keywordtype">void</span>)
<a name="l01459"></a>01459 {
<a name="l01460"></a>01460   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>;
<a name="l01461"></a>01461 }
<a name="l01462"></a>01462 <span class="preprocessor">#endif</span>
<a name="l01463"></a>01463 <span class="preprocessor"></span>
<a name="l01464"></a>01464 <span class="comment">//=============================================================================</span>
<a name="l01465"></a>01465 <span class="comment">// class TVisualFramework</span>
<a name="l01466"></a>01466 <span class="comment">//</span>
<a name="l01467"></a>01467 <span class="comment">//=============================================================================</span>
<a name="l01468"></a>01468 
<a name="l01469"></a>01469 IMPLEMENT_DYNCREATE(<a class="code" href="class_t_visual_framework.html">TVisualFramework</a>, CCmdTarget)
<a name="l01470"></a>01470 
<a name="l01471"></a>01471 BEGIN_MESSAGE_MAP(<a class="code" href="class_t_visual_framework.html">TVisualFramework</a>, CCmdTarget)
<a name="l01472"></a>01472         <span class="comment">//{{AFX_MSG_MAP(TVisualFramework)</span>
<a name="l01473"></a>01473         <span class="comment">//}}AFX_MSG_MAP</span>
<a name="l01474"></a>01474 END_MESSAGE_MAP()
<a name="l01475"></a>01475 
<a name="l01476"></a><a class="code" href="class_t_visual_framework.html#0b94602d1016c70214d96ed7d70e12b1">01476</a> TVisualFramework::TVisualFramework()
<a name="l01477"></a>01477 {
<a name="l01478"></a>01478   m_pOwner = NULL;
<a name="l01479"></a>01479   m_bEnableCtrlTab = TRUE;
<a name="l01480"></a>01480 }
<a name="l01481"></a>01481 
<a name="l01482"></a><a class="code" href="class_t_visual_framework.html#df05eab0ada3b072e66ee246d0f748c7">01482</a> <a class="code" href="class_t_visual_framework.html#df05eab0ada3b072e66ee246d0f748c7">TVisualFramework::~TVisualFramework</a>()
<a name="l01483"></a>01483 {
<a name="l01484"></a>01484   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.size() &amp;&amp; <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.size()) {
<a name="l01485"></a>01485     TRACE0(_T(<span class="stringliteral">"&gt;&gt;&gt; TVisualFramework::Destroy() called in TVisualFramework destructor\n"</span>));
<a name="l01486"></a>01486     TRACE0(_T(<span class="stringliteral">"&gt;&gt;&gt;   It must be called in CFrameWnd derived class OnDestroy() message handler\n"</span>));
<a name="l01487"></a>01487     <a class="code" href="class_t_visual_framework.html#bfe9385f5a04f4e254e527f6c80a77d3">Destroy</a>();
<a name="l01488"></a>01488   }
<a name="l01489"></a>01489 }
<a name="l01490"></a>01490 
<a name="l01491"></a>01491 <span class="comment">// Find an object in the map with the specified unique id</span>
<a name="l01492"></a><a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">01492</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">TVisualFramework::findObject</a>(DWORD dwId)
<a name="l01493"></a>01493 {
<a name="l01494"></a>01494   TVisualObjectMap::iterator iterator;
<a name="l01495"></a>01495   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); iterator != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); iterator++) {
<a name="l01496"></a>01496     <span class="keywordflow">if</span> (dwId == iterator-&gt;first)
<a name="l01497"></a>01497       <span class="keywordflow">return</span> iterator-&gt;second;
<a name="l01498"></a>01498   }
<a name="l01499"></a>01499   <span class="keywordflow">return</span> NULL;
<a name="l01500"></a>01500 }
<a name="l01501"></a>01501 
<a name="l01502"></a>01502 <span class="comment">// Find an object in the map with the specified window</span>
<a name="l01503"></a><a class="code" href="class_t_visual_framework.html#a15df713e7c7058e99e24766fa02e422">01503</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">TVisualFramework::findObject</a>(CWnd *pWnd)
<a name="l01504"></a>01504 {
<a name="l01505"></a>01505   TVisualObjectMap::iterator iterator;
<a name="l01506"></a>01506   <span class="keywordflow">for</span> (iterator = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); iterator != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); iterator++) {
<a name="l01507"></a>01507     <span class="keywordflow">if</span> (pWnd == iterator-&gt;second-&gt;m_pWnd)
<a name="l01508"></a>01508       <span class="keywordflow">return</span> iterator-&gt;second;
<a name="l01509"></a>01509   }
<a name="l01510"></a>01510   <span class="keywordflow">return</span> NULL;
<a name="l01511"></a>01511 }
<a name="l01512"></a>01512 
<a name="l01513"></a>01513 <span class="comment">// Add object to the container (this is a root level object)</span>
<a name="l01514"></a>01514 <span class="comment">// There is only one root level object (either splitter or tab)</span>
<a name="l01515"></a><a class="code" href="class_t_visual_framework.html#bf042817f6dd86a851710060a347f2af">01515</a> BOOL <a class="code" href="class_t_visual_framework.html#bf042817f6dd86a851710060a347f2af">TVisualFramework::Add</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01516"></a>01516 {
<a name="l01517"></a>01517   ASSERT(pObject);
<a name="l01518"></a>01518   ASSERT(<a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.size() == 0);   <span class="comment">// Only one root level object allowed</span>
<a name="l01519"></a>01519 
<a name="l01520"></a>01520   <span class="comment">// Root level object is either a view, splitter or a tab</span>
<a name="l01521"></a>01521   ASSERT((pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0da9994da85d755d961904ca04879b0c8">TVisualObject::OT_TAB</a>) || 
<a name="l01522"></a>01522          (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd025d946ffdb6faaee03f4546e46b02afd">TVisualObject::OT_VIEW</a>) || 
<a name="l01523"></a>01523          (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">TVisualObject::OT_SPLITTER</a>));
<a name="l01524"></a>01524 
<a name="l01525"></a>01525   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>) == NULL) {
<a name="l01526"></a>01526     <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.insert(<a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.end(), pObject);
<a name="l01527"></a>01527     pObject-&gt;<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a> = <span class="keyword">this</span>;
<a name="l01528"></a>01528     <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>[pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>] = pObject;
<a name="l01529"></a>01529     <span class="keywordflow">return</span> TRUE;
<a name="l01530"></a>01530   }
<a name="l01531"></a>01531   ASSERT(FALSE);    <span class="comment">// Duplicate object Id</span>
<a name="l01532"></a>01532   <span class="keywordflow">return</span> FALSE;
<a name="l01533"></a>01533 }
<a name="l01534"></a>01534 
<a name="l01535"></a>01535 <span class="comment">// Add child object to the specified object</span>
<a name="l01536"></a><a class="code" href="class_t_visual_framework.html#47f3a438941767c87c69ab495c24ba90">01536</a> BOOL <a class="code" href="class_t_visual_framework.html#bf042817f6dd86a851710060a347f2af">TVisualFramework::Add</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pOwner, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01537"></a>01537 {
<a name="l01538"></a>01538   ASSERT(pObject);
<a name="l01539"></a>01539 
<a name="l01540"></a>01540 <span class="preprocessor">  #ifdef _DEBUG</span>
<a name="l01541"></a>01541 <span class="preprocessor"></span>  <span class="comment">// Validate definition</span>
<a name="l01542"></a>01542   <span class="keywordflow">if</span> (pOwner-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0da9994da85d755d961904ca04879b0c8">TVisualObject::OT_TAB</a>) {
<a name="l01543"></a>01543     <span class="keywordflow">if</span> ((pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd086e728851fc537ef1a42ce5cfcedc05c">TVisualObject::OT_TABVIEW</a>) &amp;&amp; 
<a name="l01544"></a>01544         (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">TVisualObject::OT_SPLITTER</a>) &amp;&amp;
<a name="l01545"></a>01545         (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0da9994da85d755d961904ca04879b0c8">TVisualObject::OT_TAB</a>))
<a name="l01546"></a>01546     {
<a name="l01547"></a>01547       ASSERT(FALSE);
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pOwner-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">TVisualObject::OT_SPLITTER</a>) {
<a name="l01550"></a>01550     <span class="keywordflow">if</span> ((pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0796b76767b122c434a62a7a1c03372a4">TVisualObject::OT_SPLITTERVIEW</a>) &amp;&amp; 
<a name="l01551"></a>01551         (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0e0ddc9e4c6b217d7e843123b962457ee">TVisualObject::OT_SPLITTERSPLITTER</a>))
<a name="l01552"></a>01552     {
<a name="l01553"></a>01553       ASSERT(FALSE);
<a name="l01554"></a>01554     }
<a name="l01555"></a>01555   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pOwner-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0e0ddc9e4c6b217d7e843123b962457ee">TVisualObject::OT_SPLITTERSPLITTER</a>) {
<a name="l01556"></a>01556     <span class="keywordflow">if</span> ((pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0796b76767b122c434a62a7a1c03372a4">TVisualObject::OT_SPLITTERVIEW</a>) &amp;&amp; 
<a name="l01557"></a>01557         (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0e0ddc9e4c6b217d7e843123b962457ee">TVisualObject::OT_SPLITTERSPLITTER</a>))
<a name="l01558"></a>01558     {
<a name="l01559"></a>01559       ASSERT(FALSE);
<a name="l01560"></a>01560     }
<a name="l01561"></a>01561   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pOwner-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> == <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd086e728851fc537ef1a42ce5cfcedc05c">TVisualObject::OT_TABVIEW</a>) {
<a name="l01562"></a>01562     <span class="keywordflow">if</span> ((pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a> != <a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">TVisualObject::OT_SPLITTER</a>))
<a name="l01563"></a>01563     {
<a name="l01564"></a>01564       ASSERT(FALSE);
<a name="l01565"></a>01565     }
<a name="l01566"></a>01566   }
<a name="l01567"></a>01567 
<a name="l01568"></a>01568 <span class="preprocessor">  #endif</span>
<a name="l01569"></a>01569 <span class="preprocessor"></span>
<a name="l01570"></a>01570   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>) == NULL) {
<a name="l01571"></a>01571     pOwner-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.insert(pOwner-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(), pObject);
<a name="l01572"></a>01572     pObject-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a> = pOwner;
<a name="l01573"></a>01573     pObject-&gt;<a class="code" href="class_t_visual_object.html#c3f324ec8eab98974f5baa9ccae8ae42">m_pFramework</a> = <span class="keyword">this</span>;
<a name="l01574"></a>01574     <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>[pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>] = pObject;
<a name="l01575"></a>01575     <span class="keywordflow">return</span> TRUE;
<a name="l01576"></a>01576   }
<a name="l01577"></a>01577   ASSERT(FALSE);    <span class="comment">// Duplicate object Id</span>
<a name="l01578"></a>01578   <span class="keywordflow">return</span> FALSE;
<a name="l01579"></a>01579 }
<a name="l01580"></a>01580 
<a name="l01581"></a>01581 <span class="comment">// Create all objects within the framework</span>
<a name="l01582"></a><a class="code" href="class_t_visual_framework.html#642917f1908aa0d0fa6353e4ab71b731">01582</a> BOOL <a class="code" href="class_t_visual_framework.html#642917f1908aa0d0fa6353e4ab71b731">TVisualFramework::Create</a>(CWnd *pWnd)
<a name="l01583"></a>01583 {
<a name="l01584"></a>01584   ASSERT(pWnd);
<a name="l01585"></a>01585   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd)));
<a name="l01586"></a>01586 
<a name="l01587"></a>01587   <span class="comment">// Save owner for later</span>
<a name="l01588"></a>01588   <a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a> = pWnd;
<a name="l01589"></a>01589 
<a name="l01590"></a>01590   <span class="comment">// Disable Ctrl+Tab for MDI applications</span>
<a name="l01591"></a>01591   <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(CMDIChildWnd)))
<a name="l01592"></a>01592     <a class="code" href="class_t_visual_framework.html#ad2a3ff0ff12aab0f97cbae22a6e73c8">m_bEnableCtrlTab</a> = FALSE;
<a name="l01593"></a>01593 
<a name="l01594"></a>01594   <span class="comment">// Walk thru visual object hierarchy and create windows</span>
<a name="l01595"></a>01595   BOOL rc;
<a name="l01596"></a>01596   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject;
<a name="l01597"></a>01597   TVisualObjectList::iterator it;
<a name="l01598"></a>01598   <span class="keywordflow">for</span> (it = <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.begin(); it != <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.end(); it++) {
<a name="l01599"></a>01599     pObject = *it;
<a name="l01600"></a>01600     rc = <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">execCreate</a>(pWnd, pObject);
<a name="l01601"></a>01601     <span class="keywordflow">if</span> (rc == FALSE) {
<a name="l01602"></a>01602       TRACE0(_T(<span class="stringliteral">"Create visual object failed!\n"</span>));
<a name="l01603"></a>01603       <span class="keywordflow">return</span> FALSE;
<a name="l01604"></a>01604     }
<a name="l01605"></a>01605   }
<a name="l01606"></a>01606   
<a name="l01607"></a>01607   <span class="comment">// Walk thru the map and find first object that can be focused</span>
<a name="l01608"></a>01608   <span class="comment">// Then set focus</span>
<a name="l01609"></a>01609   TVisualObjectMap::iterator mapit;
<a name="l01610"></a>01610   <span class="keywordflow">for</span> (mapit = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); mapit != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); mapit ++) {
<a name="l01611"></a>01611     pObject = mapit-&gt;second;
<a name="l01612"></a>01612     if (pObject-&gt;<a class="code" href="class_t_visual_object.html#8351c2168325c65d3c239e8caf6fdfce">CanFocus</a>()) {
<a name="l01613"></a>01613       <a class="code" href="class_t_visual_framework.html#e778a7e8dada71ce8c9b239baf381dfd">SetActivePane</a>(pObject);
<a name="l01614"></a>01614       <span class="keywordflow">break</span>;
<a name="l01615"></a>01615     }
<a name="l01616"></a>01616   }
<a name="l01617"></a>01617 
<a name="l01618"></a>01618   <span class="keywordflow">return</span> TRUE;
<a name="l01619"></a>01619 }
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 <span class="comment">// Destroy all objects in the framework</span>
<a name="l01622"></a><a class="code" href="class_t_visual_framework.html#bfe9385f5a04f4e254e527f6c80a77d3">01622</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_framework.html#bfe9385f5a04f4e254e527f6c80a77d3">TVisualFramework::Destroy</a>(<span class="keywordtype">void</span>)
<a name="l01623"></a>01623 {
<a name="l01624"></a>01624   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626   <span class="comment">// Recursive delete of all objects</span>
<a name="l01627"></a>01627   TVisualObjectList::iterator it;
<a name="l01628"></a>01628   <span class="keywordflow">for</span> (it = <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.begin(); it != <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.end(); it++) {
<a name="l01629"></a>01629     pObject = *it;
<a name="l01630"></a>01630     <a class="code" href="class_t_visual_framework.html#53a26b72b1a33cb7f8df503d952abc2d">execDestroy</a>(pObject);
<a name="l01631"></a>01631   }
<a name="l01632"></a>01632 
<a name="l01633"></a>01633   <span class="comment">// Delete pointers in object map</span>
<a name="l01634"></a>01634   TVisualObjectMap::iterator mapit;
<a name="l01635"></a>01635   <span class="keywordflow">for</span> (mapit = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); mapit != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); mapit++) {
<a name="l01636"></a>01636     pObject = mapit-&gt;second;
<a name="l01637"></a>01637     <span class="keyword">delete</span> pObject;
<a name="l01638"></a>01638   }
<a name="l01639"></a>01639 
<a name="l01640"></a>01640   <span class="comment">// Empty all containers (for check in destructor)</span>
<a name="l01641"></a>01641   <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.clear();
<a name="l01642"></a>01642   <a class="code" href="class_t_visual_framework.html#fe450230cef3ba07723db268aa686fd7">m_ObjectList</a>.clear();
<a name="l01643"></a>01643 }
<a name="l01644"></a>01644 
<a name="l01645"></a>01645 <span class="comment">// Recursive function to delete all object windows. Does not delete views since</span>
<a name="l01646"></a>01646 <span class="comment">// they are destroyed by frame.</span>
<a name="l01647"></a><a class="code" href="class_t_visual_framework.html#53a26b72b1a33cb7f8df503d952abc2d">01647</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_framework.html#53a26b72b1a33cb7f8df503d952abc2d">TVisualFramework::execDestroy</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01648"></a>01648 {
<a name="l01649"></a>01649   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> &amp;&amp; ::IsWindow(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd)) {
<a name="l01650"></a>01650     <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01651"></a>01651       <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObj;
<a name="l01652"></a>01652       TVisualObjectList::iterator it;
<a name="l01653"></a>01653       <span class="keywordflow">for</span> (it = pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.begin(); it != pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(); it++) {
<a name="l01654"></a>01654         pObj = *it;
<a name="l01655"></a>01655         <a class="code" href="class_t_visual_framework.html#53a26b72b1a33cb7f8df503d952abc2d">execDestroy</a>(pObj);
<a name="l01656"></a>01656       }
<a name="l01657"></a>01657       pObject-&gt;<a class="code" href="class_t_visual_object.html#aab2198ed77f3d9d6a290785462dc762">Destroy</a>(TRUE);
<a name="l01658"></a>01658     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd))) {
<a name="l01659"></a>01659       <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObj;
<a name="l01660"></a>01660       TVisualObjectList::iterator it;
<a name="l01661"></a>01661       <span class="keywordflow">for</span> (it = pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.begin(); it != pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(); it++) {
<a name="l01662"></a>01662         pObj = *it;
<a name="l01663"></a>01663         <a class="code" href="class_t_visual_framework.html#53a26b72b1a33cb7f8df503d952abc2d">execDestroy</a>(pObj);
<a name="l01664"></a>01664       }
<a name="l01665"></a>01665       pObject-&gt;<a class="code" href="class_t_visual_object.html#aab2198ed77f3d9d6a290785462dc762">Destroy</a>(TRUE);
<a name="l01666"></a>01666     } 
<a name="l01667"></a>01667   }
<a name="l01668"></a>01668 }
<a name="l01669"></a>01669 
<a name="l01670"></a>01670 <span class="comment">// Create specified object and all its childs</span>
<a name="l01671"></a><a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">01671</a> BOOL <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">TVisualFramework::execCreate</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01672"></a>01672 {
<a name="l01673"></a>01673   ASSERT(pWnd);
<a name="l01674"></a>01674   ASSERT(pObject);
<a name="l01675"></a>01675   
<a name="l01676"></a>01676   BOOL rc = FALSE;
<a name="l01677"></a>01677   <span class="keywordflow">switch</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#c4ab8c16f5cdc3a35b0d5df9081cf43e">m_nObjectType</a>) {
<a name="l01678"></a>01678   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd035fe56c72a8d72229643ed41345cc076">TVisualObject::OT_SPLITTER</a>): 
<a name="l01679"></a>01679     rc = <a class="code" href="class_t_visual_framework.html#521ef772e70a85fb6f11d7cf4edcc624">execCreateSplitter</a>(pWnd,pObject);
<a name="l01680"></a>01680     <span class="keywordflow">break</span>;
<a name="l01681"></a>01681   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0796b76767b122c434a62a7a1c03372a4">TVisualObject::OT_SPLITTERVIEW</a>): 
<a name="l01682"></a>01682     rc = <a class="code" href="class_t_visual_framework.html#449fb61f175f207b4d7a1f0ed803fe13">execCreateSplitterView</a>(pWnd, pObject);
<a name="l01683"></a>01683     <span class="keywordflow">break</span>;
<a name="l01684"></a>01684   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0e0ddc9e4c6b217d7e843123b962457ee">TVisualObject::OT_SPLITTERSPLITTER</a>):
<a name="l01685"></a>01685     rc = <a class="code" href="class_t_visual_framework.html#295165e331ab3155f61f0356020d56cf">execCreateSplitterSplitter</a>(pWnd, pObject);
<a name="l01686"></a>01686     <span class="keywordflow">break</span>;
<a name="l01687"></a>01687   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd0da9994da85d755d961904ca04879b0c8">TVisualObject::OT_TAB</a>):
<a name="l01688"></a>01688     rc = <a class="code" href="class_t_visual_framework.html#6402759ba132e43e6abe63b5d6bca6c2">execCreateTabWnd</a>(pWnd, pObject);
<a name="l01689"></a>01689     <span class="keywordflow">break</span>;
<a name="l01690"></a>01690   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd086e728851fc537ef1a42ce5cfcedc05c">TVisualObject::OT_TABVIEW</a>):
<a name="l01691"></a>01691     rc = <a class="code" href="class_t_visual_framework.html#505b9a529c148ee704aa7187b40be70c">execCreateTabView</a>(pWnd, pObject);
<a name="l01692"></a>01692     <span class="keywordflow">break</span>;
<a name="l01693"></a>01693   <span class="keywordflow">case</span> (<a class="code" href="class_t_visual_object.html#5a23cb84569a63e0bfc0be0e4a126cd025d946ffdb6faaee03f4546e46b02afd">TVisualObject::OT_VIEW</a>):
<a name="l01694"></a>01694     rc = <a class="code" href="class_t_visual_framework.html#e868792e0eeac894eae666c3629a094f">execCreateView</a>(pWnd, pObject);
<a name="l01695"></a>01695     <span class="keywordflow">break</span>;
<a name="l01696"></a>01696   }
<a name="l01697"></a>01697   <span class="keywordflow">return</span> rc;
<a name="l01698"></a>01698 }
<a name="l01699"></a>01699 
<a name="l01700"></a>01700 <span class="comment">// Create a simple view </span>
<a name="l01701"></a><a class="code" href="class_t_visual_framework.html#e868792e0eeac894eae666c3629a094f">01701</a> BOOL <a class="code" href="class_t_visual_framework.html#e868792e0eeac894eae666c3629a094f">TVisualFramework::execCreateView</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01702"></a>01702 {
<a name="l01703"></a>01703   ASSERT(pWnd);
<a name="l01704"></a>01704   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd)));
<a name="l01705"></a>01705   ASSERT(pObject);
<a name="l01706"></a>01706   ASSERT(pObject-&gt;m_pContext);
<a name="l01707"></a>01707   ASSERT(pObject-&gt;m_pRuntimeClass);
<a name="l01708"></a>01708 
<a name="l01709"></a>01709   CFrameWnd *pFrame = (CFrameWnd*)pWnd;
<a name="l01710"></a>01710   pObject-&gt;m_pContext-&gt;m_pNewViewClass = pObject-&gt;m_pRuntimeClass;
<a name="l01711"></a>01711   pObject-&gt;m_pWnd = pFrame-&gt;CreateView(pObject-&gt;m_pContext);
<a name="l01712"></a>01712   ASSERT(pObject-&gt;m_pWnd);
<a name="l01713"></a>01713   ASSERT(::IsWindow(pObject-&gt;m_pWnd-&gt;m_hWnd));
<a name="l01714"></a>01714   
<a name="l01715"></a>01715   pObject-&gt;m_pParent = pFrame;
<a name="l01716"></a>01716   <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01717"></a>01717   
<a name="l01718"></a>01718   <span class="keywordflow">return</span> TRUE;
<a name="l01719"></a>01719 }
<a name="l01720"></a>01720 
<a name="l01721"></a>01721 <span class="comment">// Create a view within a tab window</span>
<a name="l01722"></a><a class="code" href="class_t_visual_framework.html#505b9a529c148ee704aa7187b40be70c">01722</a> BOOL <a class="code" href="class_t_visual_framework.html#505b9a529c148ee704aa7187b40be70c">TVisualFramework::execCreateTabView</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01723"></a>01723 {
<a name="l01724"></a>01724   ASSERT(pWnd);
<a name="l01725"></a>01725   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)));
<a name="l01726"></a>01726   ASSERT(pObject);
<a name="l01727"></a>01727   ASSERT(pObject-&gt;m_pContext);
<a name="l01728"></a>01728   ASSERT(pObject-&gt;m_pRuntimeClass);
<a name="l01729"></a>01729   ASSERT(!pObject-&gt;m_strTitle.IsEmpty());
<a name="l01730"></a>01730 
<a name="l01731"></a>01731   <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pWnd;
<a name="l01732"></a>01732   <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem;
<a name="l01733"></a>01733   pItem = pTab-&gt;CreatePane(pObject-&gt;m_strTitle, pObject-&gt;m_pRuntimeClass, 
<a name="l01734"></a>01734                             pObject-&gt;m_pContext);
<a name="l01735"></a>01735   pItem-&gt;<a class="code" href="class_t_tab_item.html#7c3a7a5f6783b51872e90cfa5174b77e">SetIcon</a>(pObject-&gt;GetIcon());
<a name="l01736"></a>01736   ASSERT(pItem);
<a name="l01737"></a>01737   pObject-&gt;m_pWnd = pItem-&gt;<a class="code" href="class_t_tab_item.html#bf6d6982c6687228e65accd9141c5eb1">GetSafeWnd</a>();
<a name="l01738"></a>01738   ASSERT(pObject-&gt;m_pWnd);
<a name="l01739"></a>01739   ASSERT(::IsWindow(pObject-&gt;m_pWnd-&gt;m_hWnd));
<a name="l01740"></a>01740   pObject-&gt;m_pParent = pTab;
<a name="l01741"></a>01741   <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01742"></a>01742   <span class="keywordflow">return</span> TRUE;
<a name="l01743"></a>01743 }
<a name="l01744"></a>01744 
<a name="l01745"></a>01745 <span class="comment">// Create a splitter window</span>
<a name="l01746"></a><a class="code" href="class_t_visual_framework.html#521ef772e70a85fb6f11d7cf4edcc624">01746</a> BOOL <a class="code" href="class_t_visual_framework.html#521ef772e70a85fb6f11d7cf4edcc624">TVisualFramework::execCreateSplitter</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01747"></a>01747 {
<a name="l01748"></a>01748   ASSERT(pWnd);
<a name="l01749"></a>01749   ASSERT(pObject);
<a name="l01750"></a>01750 
<a name="l01751"></a>01751   <span class="comment">// Cannot use pObject-&gt;m_pRuntimeClass-&gt;CreateObject() since splitters </span>
<a name="l01752"></a>01752   <span class="comment">// do not support dynamic creation</span>
<a name="l01753"></a>01753   pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = <a class="code" href="class_t_visual_framework.html#0143fe084e2ae5fa9b74988cf4a6ca65">CreateSplitter</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>);
<a name="l01754"></a>01754   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01755"></a>01755   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)));
<a name="l01756"></a>01756 
<a name="l01757"></a>01757   <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01758"></a>01758     TTabWnd *pTab = (TTabWnd*)pWnd;
<a name="l01759"></a>01759     <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = pTab-&gt;CreatePane(pObject-&gt;<a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a>, pObject-&gt;<a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a>, 
<a name="l01760"></a>01760                                        pObject-&gt;<a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a>, pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01761"></a>01761     pItem-&gt;<a class="code" href="class_t_tab_item.html#7c3a7a5f6783b51872e90cfa5174b77e">SetIcon</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#8442bfd4a76a4f8a255c769d3fa4c486">GetIcon</a>());
<a name="l01762"></a>01762     ASSERT(::IsWindow(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd));
<a name="l01763"></a>01763     pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = pWnd;
<a name="l01764"></a>01764   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd))) {
<a name="l01765"></a>01765     ((CSplitterWnd*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>)-&gt;CreateStatic(pWnd,pObject-&gt;<a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a>,pObject-&gt;<a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a>);
<a name="l01766"></a>01766     ASSERT(::IsWindow(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd));
<a name="l01767"></a>01767     pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = pWnd;
<a name="l01768"></a>01768   }
<a name="l01769"></a>01769   <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01770"></a>01770   TVisualObjectList::iterator it;
<a name="l01771"></a>01771   <span class="keywordflow">for</span> (it = pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.begin(); it != pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(); it++) {
<a name="l01772"></a>01772     <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">execCreate</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>, *it);
<a name="l01773"></a>01773   }
<a name="l01774"></a>01774   <span class="keywordflow">return</span> TRUE;
<a name="l01775"></a>01775 }
<a name="l01776"></a>01776 
<a name="l01777"></a>01777 <span class="comment">// Create a view within a splitter. Then create all childs of this view.</span>
<a name="l01778"></a><a class="code" href="class_t_visual_framework.html#449fb61f175f207b4d7a1f0ed803fe13">01778</a> BOOL <a class="code" href="class_t_visual_framework.html#449fb61f175f207b4d7a1f0ed803fe13">TVisualFramework::execCreateSplitterView</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01779"></a>01779 {
<a name="l01780"></a>01780   ASSERT(pWnd);
<a name="l01781"></a>01781   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)));
<a name="l01782"></a>01782   ASSERT(pObject);
<a name="l01783"></a>01783   
<a name="l01784"></a>01784   CSplitterWnd *pSplitter = (CSplitterWnd*)pWnd;
<a name="l01785"></a>01785   pSplitter-&gt;CreateView(pObject-&gt;m_nRowIndex, pObject-&gt;m_nColIndex, 
<a name="l01786"></a>01786                         pObject-&gt;m_pRuntimeClass, pObject-&gt;m_Size, 
<a name="l01787"></a>01787                         pObject-&gt;m_pContext);
<a name="l01788"></a>01788   pObject-&gt;m_pWnd = pSplitter-&gt;GetPane(pObject-&gt;m_nRowIndex, pObject-&gt;m_nColIndex);
<a name="l01789"></a>01789   ASSERT(pObject-&gt;m_pWnd);
<a name="l01790"></a>01790   ASSERT(::IsWindow(pObject-&gt;m_pWnd-&gt;m_hWnd));
<a name="l01791"></a>01791   pObject-&gt;m_pParent = pSplitter;
<a name="l01792"></a>01792   <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01793"></a>01793   TVisualObjectList::iterator it;
<a name="l01794"></a>01794   <span class="keywordflow">for</span> (it = pObject-&gt;m_ObjectList.begin(); it != pObject-&gt;m_ObjectList.end(); it++) {
<a name="l01795"></a>01795     <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">execCreate</a>(pObject-&gt;m_pWnd, *it);
<a name="l01796"></a>01796   }
<a name="l01797"></a>01797   <span class="keywordflow">return</span> TRUE;
<a name="l01798"></a>01798 }
<a name="l01799"></a>01799 
<a name="l01800"></a>01800 <span class="comment">// Create a nested splitter window</span>
<a name="l01801"></a><a class="code" href="class_t_visual_framework.html#295165e331ab3155f61f0356020d56cf">01801</a> BOOL <a class="code" href="class_t_visual_framework.html#295165e331ab3155f61f0356020d56cf">TVisualFramework::execCreateSplitterSplitter</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01802"></a>01802 {
<a name="l01803"></a>01803   ASSERT(pWnd);
<a name="l01804"></a>01804   ASSERT(pWnd-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)));
<a name="l01805"></a>01805   
<a name="l01806"></a>01806   CSplitterWnd *pParent = (CSplitterWnd*)pWnd;
<a name="l01807"></a>01807   <span class="comment">// Cannot use pObject-&gt;m_pRuntimeClass-&gt;CreateObject() since splitters </span>
<a name="l01808"></a>01808   <span class="comment">// do not support dynamic creation</span>
<a name="l01809"></a>01809   pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = <a class="code" href="class_t_visual_framework.html#0143fe084e2ae5fa9b74988cf4a6ca65">CreateSplitter</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>);
<a name="l01810"></a>01810   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01811"></a>01811   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)));
<a name="l01812"></a>01812   CSplitterWnd *pSplitter = (CSplitterWnd*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01813"></a>01813   pSplitter-&gt;CreateStatic(pParent, pObject-&gt;<a class="code" href="class_t_visual_object.html#2b5356d1f848471ad1db272472ea7198">m_nRows</a>, pObject-&gt;<a class="code" href="class_t_visual_object.html#bcb5c48fbb8f83b3665bd65d20ef33f4">m_nCols</a>, 
<a name="l01814"></a>01814                           WS_CHILD|WS_VISIBLE|WS_BORDER, 
<a name="l01815"></a>01815                           pParent-&gt;IdFromRowCol(pObject-&gt;<a class="code" href="class_t_visual_object.html#813116511db43eeaffc60a0e394c6f81">m_nRowIndex</a>,pObject-&gt;<a class="code" href="class_t_visual_object.html#d503285326bbfefe3dfe904481db9488">m_nColIndex</a>));
<a name="l01816"></a>01816   ASSERT(::IsWindow(pSplitter-&gt;m_hWnd));
<a name="l01817"></a>01817   pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = pParent;
<a name="l01818"></a>01818   TVisualObjectList::iterator it;
<a name="l01819"></a>01819   <span class="keywordflow">for</span> (it = pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.begin(); it != pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(); it++) {
<a name="l01820"></a>01820     <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">execCreate</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>, *it);
<a name="l01821"></a>01821   }
<a name="l01822"></a>01822   <span class="keywordflow">return</span> TRUE;
<a name="l01823"></a>01823 }
<a name="l01824"></a>01824 
<a name="l01825"></a>01825 <span class="comment">// Create a tab window and all its childs (tabs)</span>
<a name="l01826"></a><a class="code" href="class_t_visual_framework.html#6402759ba132e43e6abe63b5d6bca6c2">01826</a> BOOL <a class="code" href="class_t_visual_framework.html#6402759ba132e43e6abe63b5d6bca6c2">TVisualFramework::execCreateTabWnd</a>(CWnd *pWnd, <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01827"></a>01827 {
<a name="l01828"></a>01828   ASSERT(pWnd);
<a name="l01829"></a>01829   ASSERT(pObject);
<a name="l01830"></a>01830   
<a name="l01831"></a>01831   <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01832"></a>01832     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pWnd;
<a name="l01833"></a>01833     <a class="code" href="class_t_tab_item.html">TTabItem</a> *pItem = pTab-&gt;CreatePane(pObject-&gt;<a class="code" href="class_t_visual_object.html#8f74dbad35c7100bc86a2ab7b2a031be">m_strTitle</a>, pObject-&gt;<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a>,
<a name="l01834"></a>01834                                        pObject-&gt;<a class="code" href="class_t_visual_object.html#0136a921d484dc2cc4176dda0c13fc49">m_pContext</a>);
<a name="l01835"></a>01835     pItem-&gt;<a class="code" href="class_t_tab_item.html#7c3a7a5f6783b51872e90cfa5174b77e">SetIcon</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#8442bfd4a76a4f8a255c769d3fa4c486">GetIcon</a>());
<a name="l01836"></a>01836     ASSERT(pItem);
<a name="l01837"></a>01837     pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = pItem-&gt;<a class="code" href="class_t_tab_item.html#bf6d6982c6687228e65accd9141c5eb1">GetSafeWnd</a>();
<a name="l01838"></a>01838     ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01839"></a>01839     ASSERT(::IsWindow(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd));
<a name="l01840"></a>01840     pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = pWnd;
<a name="l01841"></a>01841     <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01842"></a>01842   } <span class="keywordflow">else</span> {
<a name="l01843"></a>01843     CRect rect;
<a name="l01844"></a>01844     pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> = (CWnd*)pObject-&gt;<a class="code" href="class_t_visual_object.html#c3e5bbfd36633f393228489202d1de7c">m_pRuntimeClass</a>-&gt;CreateObject();
<a name="l01845"></a>01845     ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01846"></a>01846     pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a> = pWnd;
<a name="l01847"></a>01847     pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;Create(NULL,_T(<span class="stringliteral">""</span>),WS_VISIBLE|WS_CHILD,
<a name="l01848"></a>01848                                 rect,pWnd,<a class="code" href="_visual_fx_8cpp.html#28a35b3f6cb3902698fdbbb9742e1a98">TABWND_DEFAULT_ID</a>);
<a name="l01849"></a>01849     ASSERT(::IsWindow(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;m_hWnd));
<a name="l01850"></a>01850     <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">setTabWndProperties</a>(pObject);
<a name="l01851"></a>01851   }
<a name="l01852"></a>01852   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObj;
<a name="l01853"></a>01853   TVisualObjectList::iterator it;
<a name="l01854"></a>01854   <span class="keywordflow">for</span> (it = pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.begin(); it != pObject-&gt;<a class="code" href="class_t_visual_object.html#9f9db429ba2b8c1ec9ccb84a29abff24">m_ObjectList</a>.end(); it++) {
<a name="l01855"></a>01855     pObj = *it;
<a name="l01856"></a>01856     <a class="code" href="class_t_visual_framework.html#9d3edbc786b9727986f3040a5e6ee0fa">execCreate</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>, pObj);
<a name="l01857"></a>01857   }
<a name="l01858"></a>01858   <span class="keywordflow">return</span> TRUE;
<a name="l01859"></a>01859 }
<a name="l01860"></a>01860 
<a name="l01861"></a>01861 <span class="comment">// Set properties of tab window</span>
<a name="l01862"></a><a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">01862</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_framework.html#49d0db55f099ede51492fe2a7341cc28">TVisualFramework::setTabWndProperties</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01863"></a>01863 {
<a name="l01864"></a>01864   ASSERT(pObject);
<a name="l01865"></a>01865   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a> != NULL);
<a name="l01866"></a>01866 
<a name="l01867"></a>01867   <span class="comment">// If this is a tab window then set the position of tabs</span>
<a name="l01868"></a>01868   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01869"></a>01869     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01870"></a>01870     <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b362606218a3476360ef542b6d45205ff5ab8">TVisualObject::TOS_TABTOP</a>)
<a name="l01871"></a>01871       pTab-&gt;SetTabPos(<a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83efa8c6bd40a156cfb75de384943e5c07">TTabWnd::TP_TOP</a>);
<a name="l01872"></a>01872     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b3626390bf2effb57cf0fa395f9022877018b">TVisualObject::TOS_TABBOTTOM</a>)
<a name="l01873"></a>01873       pTab-&gt;SetTabPos(<a class="code" href="class_t_tab_wnd.html#b6ee2b2047d9ea3ef0800b9c7bc43b83e21f7b31949be4bc064831ff9bcf8d1d">TTabWnd::TP_BOTTOM</a>);
<a name="l01874"></a>01874   }
<a name="l01875"></a>01875   
<a name="l01876"></a>01876   <span class="comment">// If this is a pane within a tab then check if this pane</span>
<a name="l01877"></a>01877   <span class="comment">// should be a selected pane</span>
<a name="l01878"></a>01878   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l01879"></a>01879   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l01880"></a>01880     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l01881"></a>01881     <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e5501116fc80f913328c5e5dc706be4c">m_dwStyle</a> &amp; <a class="code" href="class_t_visual_object.html#51f2edc12e0d1767097f1215ad1b36260cd34a63b3315b6cb44b5f1096d3032a">TVisualObject::TOS_SELECTED</a>) {
<a name="l01882"></a>01882       <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01883"></a>01883       pTab-&gt;SetActivePane(nIndex);
<a name="l01884"></a>01884     }
<a name="l01885"></a>01885   }
<a name="l01886"></a>01886 }
<a name="l01887"></a>01887 
<a name="l01888"></a>01888 <span class="comment">// Get owner pointer (CFrameWnd derived class)</span>
<a name="l01889"></a><a class="code" href="class_t_visual_framework.html#4cdd4c9c9d0c51d3bbca67be91738a74">01889</a> CWnd *<a class="code" href="class_t_visual_framework.html#4cdd4c9c9d0c51d3bbca67be91738a74">TVisualFramework::GetWnd</a>(<span class="keywordtype">void</span>)
<a name="l01890"></a>01890 {
<a name="l01891"></a>01891   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a>;
<a name="l01892"></a>01892 }
<a name="l01893"></a>01893 
<a name="l01894"></a>01894 <span class="comment">// Get safe owner pointer (CFrameWnd derived class)</span>
<a name="l01895"></a><a class="code" href="class_t_visual_framework.html#70530e86a6370820e1ec9d26dc8f4bf3">01895</a> CWnd *<a class="code" href="class_t_visual_framework.html#70530e86a6370820e1ec9d26dc8f4bf3">TVisualFramework::GetSafeWnd</a>(<span class="keywordtype">void</span>)
<a name="l01896"></a>01896 {
<a name="l01897"></a>01897   <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a> &amp;&amp; ::IsWindow(<a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a>-&gt;m_hWnd))
<a name="l01898"></a>01898     <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a>;
<a name="l01899"></a>01899   <span class="keywordflow">return</span> NULL;
<a name="l01900"></a>01900 }
<a name="l01901"></a>01901 
<a name="l01902"></a>01902 <span class="comment">// Get window associated with the visual object specified with its id</span>
<a name="l01903"></a>01903 <span class="comment">// Can be any object (view, splitter or tab window)</span>
<a name="l01904"></a><a class="code" href="class_t_visual_framework.html#8f85f61c1a2d734ce293c73b09388a4e">01904</a> CWnd *<a class="code" href="class_t_visual_framework.html#8f85f61c1a2d734ce293c73b09388a4e">TVisualFramework::GetObject</a>(DWORD dwId)
<a name="l01905"></a>01905 {
<a name="l01906"></a>01906   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject = <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(dwId);
<a name="l01907"></a>01907   <span class="keywordflow">if</span> (pObject == NULL)
<a name="l01908"></a>01908     <span class="keywordflow">return</span> NULL;
<a name="l01909"></a>01909   <span class="keywordflow">return</span> pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01910"></a>01910 }
<a name="l01911"></a>01911 
<a name="l01912"></a>01912 <span class="comment">// Get ID associated with the visual object specified with its window pointer</span>
<a name="l01913"></a>01913 <span class="comment">// Can be any object (view, splitter or tab window)</span>
<a name="l01914"></a><a class="code" href="class_t_visual_framework.html#022e7982e4c24c00854d809b3a0f9405">01914</a> DWORD <a class="code" href="class_t_visual_framework.html#8f85f61c1a2d734ce293c73b09388a4e">TVisualFramework::GetObject</a>(CWnd *pWnd)
<a name="l01915"></a>01915 {
<a name="l01916"></a>01916   ASSERT(pWnd);
<a name="l01917"></a>01917   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject = <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pWnd);
<a name="l01918"></a>01918   <span class="keywordflow">if</span> (pObject == NULL)
<a name="l01919"></a>01919     <span class="keywordflow">return</span> NULL;
<a name="l01920"></a>01920   <span class="keywordflow">return</span> pObject-&gt;<a class="code" href="class_t_visual_object.html#dbc49e114766214e3e87fa0f6886a752">m_dwId</a>;
<a name="l01921"></a>01921 }
<a name="l01922"></a>01922 
<a name="l01923"></a>01923 <span class="comment">// Return a visual object with the specified id</span>
<a name="l01924"></a><a class="code" href="class_t_visual_framework.html#f6f1206216b13dc0b5624588c37ff644">01924</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#f6f1206216b13dc0b5624588c37ff644">TVisualFramework::Get</a>(DWORD dwId)
<a name="l01925"></a>01925 {
<a name="l01926"></a>01926   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(dwId);
<a name="l01927"></a>01927 }
<a name="l01928"></a>01928 
<a name="l01929"></a>01929 <span class="comment">// Return a visual object with the specified window</span>
<a name="l01930"></a><a class="code" href="class_t_visual_framework.html#62d2b707443e06b2b21f6eb086123e4e">01930</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#f6f1206216b13dc0b5624588c37ff644">TVisualFramework::Get</a>(CWnd *pWnd)
<a name="l01931"></a>01931 {
<a name="l01932"></a>01932   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pWnd);
<a name="l01933"></a>01933 }
<a name="l01934"></a>01934 
<a name="l01935"></a>01935 <span class="comment">// Returns an object that represents the currently active tab within the</span>
<a name="l01936"></a>01936 <span class="comment">// supplied tab window object. This may not be the active pane</span>
<a name="l01937"></a><a class="code" href="class_t_visual_framework.html#59bb3ce97747972e33e47b0073ae680b">01937</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#59bb3ce97747972e33e47b0073ae680b">TVisualFramework::GetActiveTab</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01938"></a>01938 {
<a name="l01939"></a>01939   ASSERT(pObject);
<a name="l01940"></a>01940   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01941"></a>01941 
<a name="l01942"></a>01942   <span class="keywordflow">if</span> (!pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l01943"></a>01943     <span class="keywordflow">return</span> NULL;
<a name="l01944"></a>01944 
<a name="l01945"></a>01945   <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l01946"></a>01946   <span class="keywordtype">int</span> nIndex = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">GetTabIndex</a>();
<a name="l01947"></a>01947   CWnd *pWnd = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#6830af4f41f92b986b9b8bc9cc616637">GetTabWnd</a>(nIndex);
<a name="l01948"></a>01948   ASSERT(pWnd);
<a name="l01949"></a>01949   
<a name="l01950"></a>01950   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#f6f1206216b13dc0b5624588c37ff644">Get</a>(pWnd);
<a name="l01951"></a>01951 }
<a name="l01952"></a>01952 
<a name="l01953"></a>01953 <span class="comment">// Set the active tab of the parent tab window. This will not activate the</span>
<a name="l01954"></a>01954 <span class="comment">// pane associated with the active tab.</span>
<a name="l01955"></a><a class="code" href="class_t_visual_framework.html#3ff7c9243bd1b09c78a3bbeba7455231">01955</a> BOOL <a class="code" href="class_t_visual_framework.html#3ff7c9243bd1b09c78a3bbeba7455231">TVisualFramework::SetActiveTab</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l01956"></a>01956 {
<a name="l01957"></a>01957   ASSERT(pObject);
<a name="l01958"></a>01958   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01959"></a>01959   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l01960"></a>01960 
<a name="l01961"></a>01961   <span class="keywordflow">if</span> (!pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l01962"></a>01962     <span class="keywordflow">return</span> FALSE;
<a name="l01963"></a>01963 
<a name="l01964"></a>01964   <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l01965"></a>01965   <span class="keywordtype">int</span> nIndex = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">GetTabIndex</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01966"></a>01966   <span class="keywordflow">return</span> pTab-&gt;<a class="code" href="class_t_tab_wnd.html#ba2d267f278af2761d4ea75c57790048">SetActivePane</a>(nIndex,FALSE);
<a name="l01967"></a>01967 }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 <span class="comment">// Returns TRUE if object is a tab within a tab window</span>
<a name="l01970"></a><a class="code" href="class_t_visual_framework.html#ec62a4cbc7d5738135fbcd377e3fb7ce">01970</a> BOOL <a class="code" href="class_t_visual_framework.html#ec62a4cbc7d5738135fbcd377e3fb7ce">TVisualFramework::IsTabPane</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a>* pObject)
<a name="l01971"></a>01971 {
<a name="l01972"></a>01972   ASSERT(pObject);
<a name="l01973"></a>01973   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01974"></a>01974   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l01975"></a>01975 
<a name="l01976"></a>01976   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l01977"></a>01977     <span class="keywordflow">return</span> TRUE;
<a name="l01978"></a>01978   <span class="keywordflow">return</span> FALSE;
<a name="l01979"></a>01979 }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981 <span class="comment">// Returns TRUE if object is a tab window</span>
<a name="l01982"></a><a class="code" href="class_t_visual_framework.html#4370c35bc49c7d9b6c0d70e4b4fed332">01982</a> BOOL <a class="code" href="class_t_visual_framework.html#4370c35bc49c7d9b6c0d70e4b4fed332">TVisualFramework::IsTabWindow</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a>* pObject)
<a name="l01983"></a>01983 {
<a name="l01984"></a>01984   ASSERT(pObject);
<a name="l01985"></a>01985   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01986"></a>01986 
<a name="l01987"></a>01987   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l01988"></a>01988     <span class="keywordflow">return</span> TRUE;
<a name="l01989"></a>01989   <span class="keywordflow">return</span> FALSE;
<a name="l01990"></a>01990 }
<a name="l01991"></a>01991 
<a name="l01992"></a>01992 <span class="comment">// Returns TRUE if object is a pane within a splitter window</span>
<a name="l01993"></a><a class="code" href="class_t_visual_framework.html#9ed28fe77b5e2ed2d3304abc6cdf8ac5">01993</a> BOOL <a class="code" href="class_t_visual_framework.html#9ed28fe77b5e2ed2d3304abc6cdf8ac5">TVisualFramework::IsSplitterPane</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a>* pObject)
<a name="l01994"></a>01994 {
<a name="l01995"></a>01995   ASSERT(pObject);
<a name="l01996"></a>01996   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l01997"></a>01997   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l01998"></a>01998 
<a name="l01999"></a>01999   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)))
<a name="l02000"></a>02000     <span class="keywordflow">return</span> TRUE;
<a name="l02001"></a>02001   <span class="keywordflow">return</span> FALSE;
<a name="l02002"></a>02002 }
<a name="l02003"></a>02003 
<a name="l02004"></a>02004 <span class="comment">// Returns TRUE if object is a pane within a splitter window</span>
<a name="l02005"></a><a class="code" href="class_t_visual_framework.html#c661f1ff700c722cce3d97cc957db8dc">02005</a> BOOL <a class="code" href="class_t_visual_framework.html#c661f1ff700c722cce3d97cc957db8dc">TVisualFramework::IsSplitterWindow</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a>* pObject)
<a name="l02006"></a>02006 {
<a name="l02007"></a>02007   ASSERT(pObject);
<a name="l02008"></a>02008   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02009"></a>02009 
<a name="l02010"></a>02010   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CSplitterWnd)))
<a name="l02011"></a>02011     <span class="keywordflow">return</span> TRUE;
<a name="l02012"></a>02012   <span class="keywordflow">return</span> FALSE;
<a name="l02013"></a>02013 }
<a name="l02014"></a>02014 
<a name="l02015"></a>02015 <span class="comment">// Returns TRUE if object is derived from CView</span>
<a name="l02016"></a><a class="code" href="class_t_visual_framework.html#7e8b381139c2cd36eafd0e1f9d129aa3">02016</a> BOOL <a class="code" href="class_t_visual_framework.html#7e8b381139c2cd36eafd0e1f9d129aa3">TVisualFramework::IsView</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l02017"></a>02017 {
<a name="l02018"></a>02018   ASSERT(pObject);
<a name="l02019"></a>02019   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02020"></a>02020 
<a name="l02021"></a>02021   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CView)))
<a name="l02022"></a>02022     <span class="keywordflow">return</span> TRUE;
<a name="l02023"></a>02023   <span class="keywordflow">return</span> FALSE;
<a name="l02024"></a>02024 }
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 <span class="comment">// Get the count of visual objects</span>
<a name="l02027"></a><a class="code" href="class_t_visual_framework.html#b40a1c910ccae581ee1d792c36faf2dc">02027</a> <span class="keywordtype">int</span> <a class="code" href="class_t_visual_framework.html#b40a1c910ccae581ee1d792c36faf2dc">TVisualFramework::GetCount</a>(<span class="keywordtype">void</span>)
<a name="l02028"></a>02028 {
<a name="l02029"></a>02029   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.size();
<a name="l02030"></a>02030 }
<a name="l02031"></a>02031 
<a name="l02032"></a>02032 <span class="comment">// Set font for complete framework</span>
<a name="l02033"></a><a class="code" href="class_t_visual_framework.html#d09fcc832f77c818d94032484424f773">02033</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_framework.html#d09fcc832f77c818d94032484424f773">TVisualFramework::SetFont</a>(CFont *pFont)
<a name="l02034"></a>02034 {
<a name="l02035"></a>02035   ASSERT(pFont);
<a name="l02036"></a>02036   
<a name="l02037"></a>02037   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject;
<a name="l02038"></a>02038   TVisualObjectMap::iterator mapit;
<a name="l02039"></a>02039   <span class="keywordflow">for</span> (mapit = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); mapit != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); mapit ++) {
<a name="l02040"></a>02040     pObject = mapit-&gt;second;
<a name="l02041"></a>02041     if (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02042"></a>02042       ((<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>)-&gt;SetFont(pFont);
<a name="l02043"></a>02043     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_visual_form_view.html">TVisualFormView</a>))) {
<a name="l02044"></a>02044       ((<a class="code" href="class_t_visual_form_view.html">TVisualFormView</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>)-&gt;SetFont(pFont);
<a name="l02045"></a>02045     } <span class="keywordflow">else</span> {
<a name="l02046"></a>02046       pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;SetFont(pFont);
<a name="l02047"></a>02047     }
<a name="l02048"></a>02048   }
<a name="l02049"></a>02049 }
<a name="l02050"></a>02050 
<a name="l02051"></a>02051 <span class="comment">// Enable/disable CtrlTab for tab window</span>
<a name="l02052"></a><a class="code" href="class_t_visual_framework.html#d9274008269b4933ffb0ed2fabd44a06">02052</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_framework.html#d9274008269b4933ffb0ed2fabd44a06">TVisualFramework::EnableCtrlTab</a>(BOOL bEnable)
<a name="l02053"></a>02053 {
<a name="l02054"></a>02054   <span class="comment">// If framework is used in an MDI application, then Ctrl+Tab is used to switch</span>
<a name="l02055"></a>02055   <span class="comment">// among open windows. If it is enabled, Ctrl+Tab will then switch among </span>
<a name="l02056"></a>02056   <span class="comment">// tab panes within the MDI child frame window (this disables default Ctrl+Tab</span>
<a name="l02057"></a>02057   <span class="comment">// for MDI windows).</span>
<a name="l02058"></a>02058   <span class="comment">// Ctrl+Tab works only if CWinApp derived class overloads PreTranslateMessage</span>
<a name="l02059"></a>02059   <span class="comment">// and calles ProcessMessage() of the active TVisualFramework object</span>
<a name="l02060"></a>02060   <a class="code" href="class_t_visual_framework.html#ad2a3ff0ff12aab0f97cbae22a6e73c8">m_bEnableCtrlTab</a> = bEnable;
<a name="l02061"></a>02061 }
<a name="l02062"></a>02062 
<a name="l02063"></a>02063 <span class="comment">// Since CSplitterWnd does not support dynamic creation, this is a chance for</span>
<a name="l02064"></a>02064 <span class="comment">// derived class to supply CSplitterWnd derived class instead of CSplitterWnd</span>
<a name="l02065"></a><a class="code" href="class_t_visual_framework.html#0143fe084e2ae5fa9b74988cf4a6ca65">02065</a> CSplitterWnd *<a class="code" href="class_t_visual_framework.html#0143fe084e2ae5fa9b74988cf4a6ca65">TVisualFramework::CreateSplitter</a>(DWORD dwId)
<a name="l02066"></a>02066 {
<a name="l02067"></a>02067   <span class="keywordflow">return</span> <span class="keyword">new</span> CSplitterWnd;
<a name="l02068"></a>02068 }
<a name="l02069"></a>02069 
<a name="l02070"></a>02070 <span class="comment">// Set focus to visual object </span>
<a name="l02071"></a><a class="code" href="class_t_visual_framework.html#e778a7e8dada71ce8c9b239baf381dfd">02071</a> BOOL <a class="code" href="class_t_visual_framework.html#e778a7e8dada71ce8c9b239baf381dfd">TVisualFramework::SetActivePane</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject)
<a name="l02072"></a>02072 {
<a name="l02073"></a>02073   ASSERT(pObject);
<a name="l02074"></a>02074 
<a name="l02075"></a>02075   <span class="comment">// Cannot set focus to splitter or tab window</span>
<a name="l02076"></a>02076   <span class="keywordflow">if</span> (!pObject-&gt;<a class="code" href="class_t_visual_object.html#8351c2168325c65d3c239e8caf6fdfce">CanFocus</a>())
<a name="l02077"></a>02077     <span class="keywordflow">return</span> FALSE;
<a name="l02078"></a>02078 
<a name="l02079"></a>02079   <span class="comment">// Cannot set focus to disabled window</span>
<a name="l02080"></a>02080   BOOL bEnabled;
<a name="l02081"></a>02081   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#697475b0d0eeaa05df14491e582a72ff">IsEnabled</a>(bEnabled) &amp;&amp; !bEnabled)
<a name="l02082"></a>02082     <span class="keywordflow">return</span> FALSE;
<a name="l02083"></a>02083 
<a name="l02084"></a>02084   <span class="comment">// Build a list that walks thru the object hierarchy from specified </span>
<a name="l02085"></a>02085   <span class="comment">// object to the root</span>
<a name="l02086"></a>02086   <a class="code" href="_visual_fx_8h.html#a7fc5ecd94679ed6b1ece3ee2e89ac4e">TVisualObjectList</a> list;
<a name="l02087"></a>02087   <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObj = pObject;
<a name="l02088"></a>02088   <span class="keywordflow">while</span> (pObj) {
<a name="l02089"></a>02089     list.insert(list.end(),pObj);
<a name="l02090"></a>02090     pObj = pObj-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>;
<a name="l02091"></a>02091   }
<a name="l02092"></a>02092   
<a name="l02093"></a>02093   <span class="comment">// Reverse the list so that we can walk from root to the desired object</span>
<a name="l02094"></a>02094   list.reverse();
<a name="l02095"></a>02095   
<a name="l02096"></a>02096   <span class="comment">// Now, walk thru the list and set focus as desired</span>
<a name="l02097"></a>02097   TVisualObjectList::iterator it;
<a name="l02098"></a>02098   <span class="keywordflow">for</span> (it = list.begin(); it != list.end(); it ++) {
<a name="l02099"></a>02099     pObj = *it;
<a name="l02100"></a>02100     <span class="keywordflow">if</span> (pObj-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a> &amp;&amp; pObj-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02101"></a>02101       <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObj-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l02102"></a>02102       <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObj-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02103"></a>02103       <span class="keywordflow">if</span> (!pTab-&gt;SetActivePane(nIndex)) 
<a name="l02104"></a>02104         <span class="keywordflow">return</span> FALSE;
<a name="l02105"></a>02105     }
<a name="l02106"></a>02106   }
<a name="l02107"></a>02107 
<a name="l02108"></a>02108   <span class="comment">// Update framework owner</span>
<a name="l02109"></a>02109   CFrameWnd *pFrame = (CFrameWnd*)<a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a>;
<a name="l02110"></a>02110   pFrame-&gt;SetActiveView((CView*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02111"></a>02111 
<a name="l02112"></a>02112   <span class="keywordflow">return</span> TRUE;
<a name="l02113"></a>02113 }
<a name="l02114"></a>02114 
<a name="l02115"></a>02115 <span class="comment">// Return a pointer to visual object that represents the currently active pane</span>
<a name="l02116"></a><a class="code" href="class_t_visual_framework.html#6470ee02059137fd2ac39cc4b667b77d">02116</a> <a class="code" href="class_t_visual_object.html">TVisualObject</a> *<a class="code" href="class_t_visual_framework.html#6470ee02059137fd2ac39cc4b667b77d">TVisualFramework::GetActivePane</a>(<span class="keywordtype">void</span>)
<a name="l02117"></a>02117 {
<a name="l02118"></a>02118   CFrameWnd *pFrame = (CFrameWnd*)<a class="code" href="class_t_visual_framework.html#ce50b9127613b7337dc4a35cb6bb44c3">m_pOwner</a>;
<a name="l02119"></a>02119   ASSERT(pFrame);
<a name="l02120"></a>02120   CView *pView = pFrame-&gt;GetActiveView();
<a name="l02121"></a>02121   ASSERT(pView);
<a name="l02122"></a>02122   <span class="keywordflow">return</span> <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pView);
<a name="l02123"></a>02123 }
<a name="l02124"></a>02124 
<a name="l02125"></a>02125 <span class="comment">// Enable/disable a view. Returns TRUE if sucessful</span>
<a name="l02126"></a><a class="code" href="class_t_visual_framework.html#03a1a2c44f50daa057f33d67954e3db1">02126</a> BOOL <a class="code" href="class_t_visual_framework.html#03a1a2c44f50daa057f33d67954e3db1">TVisualFramework::Enable</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL bEnable)
<a name="l02127"></a>02127 {
<a name="l02128"></a>02128   ASSERT(pObject);
<a name="l02129"></a>02129   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02130"></a>02130 
<a name="l02131"></a>02131   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(CView))) {
<a name="l02132"></a>02132     pObject-&gt;<a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a> = bEnable;
<a name="l02133"></a>02133     pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;EnableWindow(bEnable);
<a name="l02134"></a>02134     <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02135"></a>02135       <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l02136"></a>02136       <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02137"></a>02137       pTab-&gt;Enable(nIndex, bEnable);
<a name="l02138"></a>02138     }
<a name="l02139"></a>02139     <span class="keywordflow">return</span> TRUE;
<a name="l02140"></a>02140   }
<a name="l02141"></a>02141   <span class="keywordflow">return</span> FALSE;
<a name="l02142"></a>02142 }
<a name="l02143"></a>02143 
<a name="l02144"></a>02144 <span class="comment">// Enable/disable a tab</span>
<a name="l02145"></a><a class="code" href="class_t_visual_framework.html#da54e0f554bb09e2d3905085a2068699">02145</a> BOOL <a class="code" href="class_t_visual_framework.html#da54e0f554bb09e2d3905085a2068699">TVisualFramework::EnableTab</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL bEnable)
<a name="l02146"></a>02146 {
<a name="l02147"></a>02147   ASSERT(pObject);
<a name="l02148"></a>02148   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02149"></a>02149   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l02150"></a>02150 
<a name="l02151"></a>02151   <span class="comment">// Check if parent is a tab window</span>
<a name="l02152"></a>02152   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02153"></a>02153     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l02154"></a>02154     <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02155"></a>02155     <span class="keywordflow">if</span> (nIndex == pTab-&gt;GetTabIndex())
<a name="l02156"></a>02156       <span class="keywordflow">return</span> FALSE;
<a name="l02157"></a>02157     pTab-&gt;EnableTab(nIndex, bEnable);
<a name="l02158"></a>02158     pObject-&gt;<a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a> = bEnable;
<a name="l02159"></a>02159     <span class="keywordflow">return</span> TRUE;
<a name="l02160"></a>02160   }
<a name="l02161"></a>02161   <span class="keywordflow">return</span> FALSE;
<a name="l02162"></a>02162 }
<a name="l02163"></a>02163 
<a name="l02164"></a>02164 <span class="comment">// Show/hide a tab</span>
<a name="l02165"></a><a class="code" href="class_t_visual_framework.html#92693b4183bff8d20e22463d480916c2">02165</a> BOOL <a class="code" href="class_t_visual_framework.html#92693b4183bff8d20e22463d480916c2">TVisualFramework::ShowTab</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL bShow)
<a name="l02166"></a>02166 {
<a name="l02167"></a>02167   ASSERT(pObject);
<a name="l02168"></a>02168   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02169"></a>02169   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l02170"></a>02170 
<a name="l02171"></a>02171   <span class="keywordflow">if</span> (!pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l02172"></a>02172     <span class="keywordflow">return</span> FALSE;
<a name="l02173"></a>02173 
<a name="l02174"></a>02174   <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l02175"></a>02175   <span class="keywordtype">int</span> nIndex = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">GetTabIndex</a>(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02176"></a>02176   <span class="keywordflow">if</span> (nIndex == pTab-&gt;<a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">GetTabIndex</a>())
<a name="l02177"></a>02177     <span class="keywordflow">return</span> FALSE;
<a name="l02178"></a>02178 
<a name="l02179"></a>02179   pTab-&gt;<a class="code" href="class_t_tab_wnd.html#f1988ca189d57fcdbc4db80047e558a5">ShowTab</a>(nIndex, bShow);
<a name="l02180"></a>02180   <span class="keywordflow">return</span> TRUE;
<a name="l02181"></a>02181 }
<a name="l02182"></a>02182 
<a name="l02183"></a>02183 <span class="comment">// Is object enabled. Returns FALSE if this is not a valid call for the supplied</span>
<a name="l02184"></a>02184 <span class="comment">// object. If return code is TRUE, check bEnabled</span>
<a name="l02185"></a><a class="code" href="class_t_visual_framework.html#8cf1b77174808d956e4f3c2bc8499bf1">02185</a> BOOL <a class="code" href="class_t_visual_framework.html#8cf1b77174808d956e4f3c2bc8499bf1">TVisualFramework::IsEnabled</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL&amp; bEnabled)
<a name="l02186"></a>02186 {
<a name="l02187"></a>02187   ASSERT(pObject);
<a name="l02188"></a>02188   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02189"></a>02189 
<a name="l02190"></a>02190   bEnabled = pObject-&gt;<a class="code" href="class_t_visual_object.html#7c6da527d825d6975ac3600f68a61915">m_bEnabled</a>;
<a name="l02191"></a>02191   <span class="keywordflow">return</span> TRUE;
<a name="l02192"></a>02192   <span class="comment">/*</span>
<a name="l02193"></a>02193 <span class="comment">  if (pObject-&gt;m_pWnd-&gt;IsKindOf(RUNTIME_CLASS(CView))) {</span>
<a name="l02194"></a>02194 <span class="comment">    bEnabled = pObject-&gt;m_pWnd-&gt;IsWindowEnabled();</span>
<a name="l02195"></a>02195 <span class="comment">    return TRUE;</span>
<a name="l02196"></a>02196 <span class="comment">  }</span>
<a name="l02197"></a>02197 <span class="comment">  return FALSE;</span>
<a name="l02198"></a>02198 <span class="comment">  */</span>
<a name="l02199"></a>02199 }
<a name="l02200"></a>02200 
<a name="l02201"></a>02201 <span class="comment">// Is tab enabled. Returns FALSE if this is not a valid call for the supplied</span>
<a name="l02202"></a>02202 <span class="comment">// object. If return code is TRUE, check bEnabled</span>
<a name="l02203"></a><a class="code" href="class_t_visual_framework.html#46485cad5eff23cfe16ad409b635b03c">02203</a> BOOL <a class="code" href="class_t_visual_framework.html#46485cad5eff23cfe16ad409b635b03c">TVisualFramework::IsTabEnabled</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL&amp; bEnabled)
<a name="l02204"></a>02204 {
<a name="l02205"></a>02205   ASSERT(pObject);
<a name="l02206"></a>02206   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02207"></a>02207   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l02208"></a>02208 
<a name="l02209"></a>02209   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02210"></a>02210     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l02211"></a>02211     <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02212"></a>02212     bEnabled = pTab-&gt;IsTabEnabled(nIndex);
<a name="l02213"></a>02213     <span class="keywordflow">return</span> TRUE;
<a name="l02214"></a>02214   }
<a name="l02215"></a>02215   <span class="keywordflow">return</span> FALSE;
<a name="l02216"></a>02216 }
<a name="l02217"></a>02217 
<a name="l02218"></a>02218 <span class="comment">// Is tab visible. Returns FALSE if this is not a valid call for the supplied</span>
<a name="l02219"></a>02219 <span class="comment">// object. If return code is TRUE then check bVisible.</span>
<a name="l02220"></a><a class="code" href="class_t_visual_framework.html#c8aeec4c277b66eb754a71767eb20c26">02220</a> BOOL <a class="code" href="class_t_visual_framework.html#c8aeec4c277b66eb754a71767eb20c26">TVisualFramework::IsTabVisible</a>(<a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject, BOOL&amp; bVisible)
<a name="l02221"></a>02221 {
<a name="l02222"></a>02222   ASSERT(pObject);
<a name="l02223"></a>02223   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02224"></a>02224   ASSERT(pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>);
<a name="l02225"></a>02225 
<a name="l02226"></a>02226   <span class="keywordflow">if</span> (pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>))) {
<a name="l02227"></a>02227     <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#90f14e957a3c9622c49c8b3e17aaa6d9">m_pParent</a>;
<a name="l02228"></a>02228     <span class="keywordtype">int</span> nIndex = pTab-&gt;GetTabIndex(pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>);
<a name="l02229"></a>02229     bVisible = pTab-&gt;IsTabVisible(nIndex);
<a name="l02230"></a>02230     <span class="keywordflow">return</span> TRUE;
<a name="l02231"></a>02231   }
<a name="l02232"></a>02232   <span class="keywordflow">return</span> FALSE;
<a name="l02233"></a>02233 }
<a name="l02234"></a>02234 
<a name="l02235"></a>02235 <span class="comment">// This should be called from CWinApp derived PreTranslateMessage to handle</span>
<a name="l02236"></a>02236 <span class="comment">// any framework related messages</span>
<a name="l02237"></a><a class="code" href="class_t_visual_framework.html#16e52201ae775874e0fd4abd71c76adb">02237</a> BOOL <a class="code" href="class_t_visual_framework.html#16e52201ae775874e0fd4abd71c76adb">TVisualFramework::ProcessMessage</a>(MSG *pMsg)
<a name="l02238"></a>02238 {
<a name="l02239"></a>02239   ASSERT(pMsg);
<a name="l02240"></a>02240   <span class="keywordflow">if</span> (pMsg-&gt;message == WM_KEYDOWN) {
<a name="l02241"></a>02241     <span class="comment">// Handle Ctrl+Tab for tab windows</span>
<a name="l02242"></a>02242     <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#ad2a3ff0ff12aab0f97cbae22a6e73c8">m_bEnableCtrlTab</a>) {
<a name="l02243"></a>02243       <span class="keywordflow">if</span> ((pMsg-&gt;wParam == VK_TAB) &amp;&amp; (::GetAsyncKeyState(VK_CONTROL) != 0)) {
<a name="l02244"></a>02244         CWnd *pWnd = CWnd::FromHandle(pMsg-&gt;hwnd);
<a name="l02245"></a>02245         ASSERT(pWnd);
<a name="l02246"></a>02246         <span class="keywordflow">if</span> (pWnd-&gt;IsKindOf(RUNTIME_CLASS(CFrameWnd)))
<a name="l02247"></a>02247           <span class="keywordflow">return</span> FALSE;
<a name="l02248"></a>02248         <span class="comment">// If we are in form view then pWnd is a control</span>
<a name="l02249"></a>02249         <span class="keywordflow">while</span> (pWnd &amp;&amp; !pWnd-&gt;IsKindOf(RUNTIME_CLASS(CView)))
<a name="l02250"></a>02250           pWnd = pWnd-&gt;GetParent();
<a name="l02251"></a>02251         <span class="comment">// Find object for this window</span>
<a name="l02252"></a>02252         ASSERT(pWnd);
<a name="l02253"></a>02253         <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject = <a class="code" href="class_t_visual_framework.html#b51722c00b0b2e0f8772af9ecc4d2767">findObject</a>(pWnd);
<a name="l02254"></a>02254         ASSERT(pObject != NULL);
<a name="l02255"></a>02255         <span class="keywordflow">while</span> (pObject &amp;&amp; !pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>-&gt;IsKindOf(RUNTIME_CLASS(<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>)))
<a name="l02256"></a>02256           pObject = pObject-&gt;<a class="code" href="class_t_visual_object.html#91e3099812cab2d25988727d26d000a6">m_pOwner</a>;
<a name="l02257"></a>02257         if (pObject) {
<a name="l02258"></a>02258           <a class="code" href="class_t_tab_wnd.html">TTabWnd</a> *pTab = (<a class="code" href="class_t_tab_wnd.html">TTabWnd</a>*)pObject-&gt;<a class="code" href="class_t_visual_object.html#e214df702a01af4ee4635ec11f9247c9">m_pWnd</a>;
<a name="l02259"></a>02259           BOOL bShift = (::GetAsyncKeyState(VK_SHIFT) != 0);
<a name="l02260"></a>02260           <span class="keywordtype">int</span> nIndex = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#70ff8bf26eda68a9b6ef25f1a3a47ea7">GetTabIndex</a>();
<a name="l02261"></a>02261           <span class="keywordtype">int</span> nNdx = nIndex;
<a name="l02262"></a>02262           <span class="comment">// Switch to new pane (skip invisible and disabled)</span>
<a name="l02263"></a>02263           <span class="keywordflow">do</span> {
<a name="l02264"></a>02264             <span class="keywordflow">if</span> (bShift) {
<a name="l02265"></a>02265               <span class="comment">// Does not work</span>
<a name="l02266"></a>02266               nNdx--;
<a name="l02267"></a>02267               <span class="keywordflow">if</span> (nNdx &lt; 0)
<a name="l02268"></a>02268                 nNdx = pTab-&gt;<a class="code" href="class_t_tab_wnd.html#a76c6ab8bb1e9550c9dea89decf4b1eb">GetTabCount</a>()-1;
<a name="l02269"></a>02269             } <span class="keywordflow">else</span> {
<a name="l02270"></a>02270               nNdx ++;
<a name="l02271"></a>02271               <span class="keywordflow">if</span> (nNdx == pTab-&gt;<a class="code" href="class_t_tab_wnd.html#a76c6ab8bb1e9550c9dea89decf4b1eb">GetTabCount</a>())
<a name="l02272"></a>02272                 nNdx = 0;
<a name="l02273"></a>02273             }
<a name="l02274"></a>02274           } <span class="keywordflow">while</span> (!pTab-&gt;<a class="code" href="class_t_tab_wnd.html#ba2d267f278af2761d4ea75c57790048">SetActivePane</a>(nNdx) &amp;&amp; (nNdx != nIndex));
<a name="l02275"></a>02275           <span class="keywordflow">return</span> TRUE;
<a name="l02276"></a>02276         }
<a name="l02277"></a>02277       }
<a name="l02278"></a>02278     }
<a name="l02279"></a>02279   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pMsg-&gt;message == WM_SYSKEYDOWN) {
<a name="l02280"></a>02280     <span class="comment">// Handle hot keys for views (if defined)</span>
<a name="l02281"></a>02281     <a class="code" href="class_t_visual_object.html">TVisualObject</a> *pObject;
<a name="l02282"></a>02282     TVisualObjectMap::iterator mapit;
<a name="l02283"></a>02283     <span class="keywordflow">for</span> (mapit = <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.begin(); mapit != <a class="code" href="class_t_visual_framework.html#73c46f7b818f15d92c6db247b245ff8d">m_ObjectMap</a>.end(); mapit ++) {
<a name="l02284"></a>02284       pObject = mapit-&gt;second;
<a name="l02285"></a>02285       if (pObject-&gt;<a class="code" href="class_t_visual_object.html#4437308961634bca0bf1b178503251e1">m_cHotKey</a> == pMsg-&gt;wParam) {
<a name="l02286"></a>02286         <span class="keywordflow">if</span> (<a class="code" href="class_t_visual_framework.html#e778a7e8dada71ce8c9b239baf381dfd">SetActivePane</a>(pObject))
<a name="l02287"></a>02287           <span class="keywordflow">return</span> TRUE;
<a name="l02288"></a>02288       }
<a name="l02289"></a>02289     }
<a name="l02290"></a>02290   }
<a name="l02291"></a>02291 
<a name="l02292"></a>02292   <span class="keywordflow">return</span> FALSE;
<a name="l02293"></a>02293 }
<a name="l02294"></a>02294 
<a name="l02295"></a><a class="code" href="class_t_visual_framework.html#85350590872bef0ba44cdcd290a02f86">02295</a> BOOL <a class="code" href="class_t_visual_framework.html#85350590872bef0ba44cdcd290a02f86">TVisualFramework::OnCmdMsg</a>(UINT nID, <span class="keywordtype">int</span> nCode, <span class="keywordtype">void</span>* pExtra, 
<a name="l02296"></a>02296                              AFX_CMDHANDLERINFO* pHandlerInfo) 
<a name="l02297"></a>02297 {
<a name="l02298"></a>02298         <span class="comment">// TODO: Add your specialized code here and/or call the base class</span>
<a name="l02299"></a>02299         
<a name="l02300"></a>02300         <span class="keywordflow">return</span> CCmdTarget::OnCmdMsg(nID, nCode, pExtra, pHandlerInfo);
<a name="l02301"></a>02301 }
<a name="l02302"></a>02302 
<a name="l02303"></a>02303 <span class="comment">//=============================================================================</span>
<a name="l02304"></a>02304 <span class="comment">// class TVisualFormView</span>
<a name="l02305"></a>02305 <span class="comment">//</span>
<a name="l02306"></a>02306 <span class="comment">// This class implements the code to set the font for all child controls.</span>
<a name="l02307"></a>02307 <span class="comment">// If it belongs to the visual framework (as a pane) then setting the font</span>
<a name="l02308"></a>02308 <span class="comment">// for the framework's panes will automatically set the font for all child</span>
<a name="l02309"></a>02309 <span class="comment">// controls in the form view.</span>
<a name="l02310"></a>02310 <span class="comment">//=============================================================================</span>
<a name="l02311"></a>02311 
<a name="l02312"></a>02312 <span class="keyword">static</span> BOOL __stdcall <a class="code" href="_visual_fx_8cpp.html#61458645118f8ab7801048cb63231b78">setChildFont</a>(HWND hwnd, LPARAM lparam);
<a name="l02313"></a>02313 <span class="keyword">static</span> BOOL __stdcall <a class="code" href="_visual_fx_8cpp.html#5290f6e235c05abf51496af6ba97c589">setChildEnabled</a>(HWND hwnd, LPARAM lparam);
<a name="l02314"></a>02314 
<a name="l02315"></a>02315 IMPLEMENT_DYNAMIC(<a class="code" href="class_t_visual_form_view.html">TVisualFormView</a>, CFormView)
<a name="l02316"></a>02316 
<a name="l02317"></a>02317 BEGIN_MESSAGE_MAP(<a class="code" href="class_t_visual_form_view.html">TVisualFormView</a>, CFormView)
<a name="l02318"></a>02318         <span class="comment">//{{AFX_MSG_MAP(TVisualFormView)</span>
<a name="l02319"></a>02319         ON_WM_ENABLE()
<a name="l02320"></a>02320         <span class="comment">//}}AFX_MSG_MAP</span>
<a name="l02321"></a>02321 END_MESSAGE_MAP()
<a name="l02322"></a>02322 
<a name="l02323"></a><a class="code" href="class_t_visual_form_view.html#eb49c4de2f3f44affd8823d2440ab38e">02323</a> TVisualFormView::TVisualFormView(LPCTSTR lpszTemplateName)
<a name="l02324"></a>02324         : CFormView(lpszTemplateName)
<a name="l02325"></a>02325 {
<a name="l02326"></a>02326 }
<a name="l02327"></a>02327 
<a name="l02328"></a><a class="code" href="class_t_visual_form_view.html#61f488cb83451083cecb217d69f02687">02328</a> <a class="code" href="class_t_visual_form_view.html#eb49c4de2f3f44affd8823d2440ab38e">TVisualFormView::TVisualFormView</a>(UINT nIDTemplate)
<a name="l02329"></a>02329         : CFormView(nIDTemplate)
<a name="l02330"></a>02330 {
<a name="l02331"></a>02331 }
<a name="l02332"></a>02332 
<a name="l02333"></a><a class="code" href="class_t_visual_form_view.html#aaa059636a4135bb0d36023385c3b4a0">02333</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_form_view.html#aaa059636a4135bb0d36023385c3b4a0">TVisualFormView::SetFont</a>(CFont *pFont)
<a name="l02334"></a>02334 {
<a name="l02335"></a>02335   ASSERT(pFont);
<a name="l02336"></a>02336   ::EnumChildWindows(m_hWnd,<a class="code" href="_visual_fx_8cpp.html#61458645118f8ab7801048cb63231b78"> ::setChildFont</a>, (LPARAM)pFont);
<a name="l02337"></a>02337 }
<a name="l02338"></a>02338 
<a name="l02339"></a><a class="code" href="class_t_visual_form_view.html#6254bd31026d448c134ca9b7f6fa1357">02339</a> <span class="keywordtype">void</span> <a class="code" href="class_t_visual_form_view.html#6254bd31026d448c134ca9b7f6fa1357">TVisualFormView::OnEnable</a>(BOOL bEnable) 
<a name="l02340"></a>02340 {
<a name="l02341"></a>02341         CFormView::OnEnable(bEnable);
<a name="l02342"></a>02342   ::EnumChildWindows(m_hWnd,<a class="code" href="_visual_fx_8cpp.html#5290f6e235c05abf51496af6ba97c589"> ::setChildEnabled</a>, (LPARAM)bEnable);
<a name="l02343"></a>02343 }
<a name="l02344"></a>02344 
<a name="l02345"></a>02345 <span class="comment">// lParam is a pointer to CFont object</span>
<a name="l02346"></a><a class="code" href="_visual_fx_8cpp.html#61458645118f8ab7801048cb63231b78">02346</a> BOOL __stdcall <a class="code" href="_visual_fx_8cpp.html#61458645118f8ab7801048cb63231b78">setChildFont</a>(HWND hwnd, LPARAM lparam)
<a name="l02347"></a>02347 {
<a name="l02348"></a>02348   CFont *pFont = (CFont*)lparam;
<a name="l02349"></a>02349   ASSERT(pFont);
<a name="l02350"></a>02350   CWnd *pWnd = CWnd::FromHandle(hwnd);
<a name="l02351"></a>02351   ASSERT(pWnd);
<a name="l02352"></a>02352   pWnd-&gt;SetFont(pFont);
<a name="l02353"></a>02353   <span class="keywordflow">return</span> TRUE;
<a name="l02354"></a>02354 }
<a name="l02355"></a>02355 
<a name="l02356"></a>02356 <span class="comment">// lParam is a BOOL</span>
<a name="l02357"></a><a class="code" href="_visual_fx_8cpp.html#5290f6e235c05abf51496af6ba97c589">02357</a> BOOL __stdcall <a class="code" href="_visual_fx_8cpp.html#5290f6e235c05abf51496af6ba97c589">setChildEnabled</a>(HWND hwnd, LPARAM lparam)
<a name="l02358"></a>02358 {
<a name="l02359"></a>02359   BOOL bEnabled = (BOOL)lparam;
<a name="l02360"></a>02360   CWnd *pWnd = CWnd::FromHandle(hwnd);
<a name="l02361"></a>02361   ASSERT(pWnd);
<a name="l02362"></a>02362   pWnd-&gt;EnableWindow(bEnabled);
<a name="l02363"></a>02363   <span class="keywordflow">return</span> TRUE;
<a name="l02364"></a>02364 }
<a name="l02365"></a>02365 
<a name="l02366"></a>02366 <span class="comment">/*#############################################################################</span>
<a name="l02367"></a>02367 <span class="comment"># End of file VISUALFX.CPP</span>
<a name="l02368"></a>02368 <span class="comment">#############################################################################*/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Apr 24 22:32:51 2007 for New Vision by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
